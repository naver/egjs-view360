/*!
 * Copyright (c) 2017 NAVER Corp.
 * @egjs/view360 project is licensed under the MIT license
 * 
 * @egjs/view360 JavaScript library
 * 
 * 
 * @version 2.0.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@egjs/component"),require("@egjs/axes")):"function"==typeof define&&define.amd?define("view360",["@egjs/component","@egjs/axes"],t):"object"==typeof exports?exports.view360=t(require("@egjs/component"),require("@egjs/axes")):(e.eg=e.eg||{},e.eg.view360=t(e.eg.Component,e.eg.Axes))}(this,function(e,t){return function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=41)}([function(t,n){t.exports=e},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function quatToVec3(e){var t=a["default"].fromValues(0,0,1);return a["default"].transformQuat(t,t,e),t}function getRotationDelta(e,t,n){var r=a["default"].fromValues(p[n].targetAxis[0],p[n].targetAxis[1],p[n].targetAxis[2]),o=p[n].meshPoint,s=l["default"].clone(e),u=l["default"].clone(t);l["default"].normalize(s,s),l["default"].normalize(u,u);var c=a["default"].fromValues(0,0,1),h=a["default"].fromValues(0,0,1);a["default"].transformQuat(c,c,s),a["default"].transformQuat(h,h,u),a["default"].transformQuat(r,r,u);var f=a["default"].dot(r,a["default"].cross(a["default"].create(),c,h)),d=f>0?1:-1,_=a["default"].fromValues(o[0],o[1],o[2]),m=void 0;m=n!==p.YAW_DELTA_BY_YAW?a["default"].fromValues(0,d,0):a["default"].fromValues(d,0,0),a["default"].transformQuat(_,_,u),a["default"].transformQuat(m,m,u);var g=_,w=m,v=a["default"].create();a["default"].cross(v,g,w),a["default"].normalize(v,v);var y=v[0],b=v[1],R=v[2];h=a["default"].fromValues(o[0],o[1],o[2]),a["default"].transformQuat(h,h,u),c=a["default"].fromValues(o[0],o[1],o[2]),a["default"].transformQuat(c,c,s);var E=Math.abs(c[0]*y+c[1]*b+c[2]*R),T=a["default"].create();a["default"].subtract(T,c,a["default"].scale(a["default"].create(),v,E));var x=(T[0]*h[0]+T[1]*h[1]+T[2]*h[2])/(a["default"].length(T)*a["default"].length(h));x>1&&(x=1);var P=Math.acos(x),C=a["default"].cross(a["default"].create(),h,T);E=y*C[0]+b*C[1]+R*C[2];var I=void 0;I=n!==p.YAW_DELTA_BY_YAW?E>0?1:-1:E<0?1:-1;var S=P*I*d;return i["default"].toDegree(S)}t.__esModule=!0,t.ROTATE_CONSTANT=t.vec3=t.vec2=t.quat=t.mat4=t.glMatrix=t.util=undefined;var r=n(2),i=_interopRequireDefault(r),o=n(34),a=_interopRequireDefault(o),s=n(33),u=_interopRequireDefault(s),c=n(32),l=_interopRequireDefault(c),h=n(31),f=_interopRequireDefault(h),d={};d.isPowerOfTwo=function(e){return"number"!=typeof e?"Not a number":e&&0==(e&e-1)},d.extractYawFromQuat=function(e){var t=quatToVec3(e);return 1*Math.atan2(t[0],t[2])},d.extractPitchFromQuat=function(e){var t=quatToVec3(e);return-1*Math.atan2(t[1],Math.sqrt(Math.pow(t[0],2)+Math.pow(t[2],2)))},d.getQuaternionWithYawPitch=function(e,t){var n=l["default"].create();return l["default"].rotateY(n,n,i["default"].toRadian(e)),l["default"].rotateX(n,n,i["default"].toRadian(t)),n},d.quatToYawPitch=function(e){return{yaw:i["default"].toDegree(d.extractYawFromQuat(e)),pitch:i["default"].toDegree(d.extractPitchFromQuat(e))}},d.yawPitchToPoint=function(e,t){return[Math.tan(e)/Math.cos(t),Math.tan(t)]};var p={PITCH_DELTA:1,YAW_DELTA_BY_ROLL:2,YAW_DELTA_BY_YAW:3};p[p.PITCH_DELTA]={targetAxis:[0,1,0],meshPoint:[0,0,1]},p[p.YAW_DELTA_BY_ROLL]={targetAxis:[0,1,0],meshPoint:[1,0,0]},p[p.YAW_DELTA_BY_YAW]={targetAxis:[1,0,0],meshPoint:[0,0,1]},d.getRotationDelta=getRotationDelta,t.util=d,t.glMatrix=i["default"],t.mat4=f["default"],t.quat=l["default"],t.vec2=u["default"],t.vec3=a["default"],t.ROTATE_CONSTANT=p},function(e,t,n){"use strict";var r={};r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;var i=Math.PI/180;r.toRadian=function(e){return e*i},r.toDegree=function(e){return e/i},r.EPSILON=1e-4,e.exports=r},function(e,t,n){"use strict";t.__esModule=!0;var r="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")();r.Float32Array="undefined"!=typeof r.Float32Array?r.Float32Array:r.Array,t.window=r;t.document=r.document,t.Float32Array=r.Float32Array,t.getComputedStyle=r.getComputedStyle,t.SUPPORT_TOUCH="ontouchstart"in r,t.SUPPORT_DEVICEMOTION="ondevicemotion"in r},function(e,t,n){"use strict";t.__esModule=!0;var r=[.2,.2],i={LEFT_ARROW:37,A:65,UP_ARROW:38,W:87,RIGHT_ARROW:39,D:68,DOWN_ARROW:40,S:83};t.CONTROL_MODE_VR=1,t.CONTROL_MODE_YAWPITCH=2,t.TOUCH_DIRECTION_NONE=1,t.TOUCH_DIRECTION_YAW=2,t.TOUCH_DIRECTION_PITCH=4,t.TOUCH_DIRECTION_ALL=6,t.MC_DECELERATION=.0014,t.MC_MAXIMUM_DURATION=1e3,t.MC_BIND_SCALE=r,t.MIN_FIELD_OF_VIEW=20,t.MAX_FIELD_OF_VIEW=110,t.PAN_SCALE=320,t.YAW_DELTA_MAX=45,t.DELTA_THRESHOLD=.0375,t.YAW_RANGE_HALF=180,t.PITCH_RANGE_HALF=90,t.PINCH_EVENTS="pinchstart pinchmove pinchend",t.KEYMAP=i},function(e,t,n){"use strict";function toAxis(e,t){return t.reduce(function(t,n,r){return e[r]&&(t[e[r]]=n),t},{})}t.__esModule=!0;var r={};r.toAxis=toAxis,t["default"]=r,t.toAxis=toAxis},function(e,t,n){(function(t,r){!function(t,n){e.exports=n()}(0,function(){"use strict";function objectOrFunction(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function isFunction(e){return"function"==typeof e}function setScheduler(e){s=e}function setAsap(e){u=e}function useVertxTimer(){return void 0!==a?function(){a(flush)}:useSetTimeout()}function useSetTimeout(){var e=setTimeout;return function(){return e(flush,1)}}function flush(){for(var e=0;e<o;e+=2){(0,p[e])(p[e+1]),p[e]=undefined,p[e+1]=undefined}o=0}function then(e,t){var n=arguments,r=this,i=new this.constructor(noop);i[m]===undefined&&makePromise(i);var o=r._state;return o?function(){var e=n[o-1];u(function(){return invokeCallback(o,i,e,r._result)})}():subscribe(r,i,e,t),i}function resolve$1(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(noop);return resolve(n,e),n}function noop(){}function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function getThen(e){try{return e.then}catch(t){return y.error=t,y}}function tryThen(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function handleForeignThenable(e,t,n){u(function(e){var r=!1,i=tryThen(n,t,function(n){r||(r=!0,t!==n?resolve(e,n):fulfill(e,n))},function(t){r||(r=!0,reject(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,reject(e,i))},e)}function handleOwnThenable(e,t){t._state===w?fulfill(e,t._result):t._state===v?reject(e,t._result):subscribe(t,undefined,function(t){return resolve(e,t)},function(t){return reject(e,t)})}function handleMaybeThenable(e,t,n){t.constructor===e.constructor&&n===then&&t.constructor.resolve===resolve$1?handleOwnThenable(e,t):n===y?(reject(e,y.error),y.error=null):n===undefined?fulfill(e,t):isFunction(n)?handleForeignThenable(e,t,n):fulfill(e,t)}function resolve(e,t){e===t?reject(e,selfFulfillment()):objectOrFunction(t)?handleMaybeThenable(e,t,getThen(t)):fulfill(e,t)}function publishRejection(e){e._onerror&&e._onerror(e._result),publish(e)}function fulfill(e,t){e._state===g&&(e._result=t,e._state=w,0!==e._subscribers.length&&u(publish,e))}function reject(e,t){e._state===g&&(e._state=v,e._result=t,u(publishRejection,e))}function subscribe(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+w]=n,i[o+v]=r,0===o&&e._state&&u(publish,e)}function publish(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=undefined,i=undefined,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?invokeCallback(n,r,i,o):i(o);e._subscribers.length=0}}function ErrorObject(){this.error=null}function tryCatch(e,t){try{return e(t)}catch(n){return b.error=n,b}}function invokeCallback(e,t,n,r){var i=isFunction(n),o=undefined,a=undefined,s=undefined,u=undefined;if(i){if(o=tryCatch(n,r),o===b?(u=!0,a=o.error,o.error=null):s=!0,t===o)return void reject(t,cannotReturnOwn())}else o=r,s=!0;t._state!==g||(i&&s?resolve(t,o):u?reject(t,a):e===w?fulfill(t,o):e===v&&reject(t,o))}function initializePromise(e,t){try{t(function(t){resolve(e,t)},function(t){reject(e,t)})}catch(n){reject(e,n)}}function nextId(){return R++}function makePromise(e){e[m]=R++,e._state=undefined,e._result=undefined,e._subscribers=[]}function Enumerator$1(e,t){this._instanceConstructor=e,this.promise=new e(noop),this.promise[m]||makePromise(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,validationError())}function validationError(){return new Error("Array Methods must be provided an Array")}function all$1(e){return new Enumerator$1(this,e).promise}function race$1(e){var t=this;return new t(i(e)?function(n,r){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function reject$1(e){var t=this,n=new t(noop);return reject(n,e),n}function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Promise$2(e){this[m]=nextId(),this._result=this._state=undefined,this._subscribers=[],noop!==e&&("function"!=typeof e&&needsResolver(),this instanceof Promise$2?initializePromise(this,e):needsNew())}function polyfill$1(){var e=undefined;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(i){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(i){}if("[object Promise]"===n&&!t.cast)return}e.Promise=Promise$2}var e=undefined;e=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var i=e,o=0,a=undefined,s=undefined,u=function(e,t){p[o]=e,p[o+1]=t,2===(o+=2)&&(s?s(flush):_())},c="undefined"!=typeof window?window:undefined,l=c||{},h=l.MutationObserver||l.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,p=new Array(1e3),_=undefined;_=f?function(){return function(){return t.nextTick(flush)}}():h?function(){var e=0,t=new h(flush),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():d?function(){var e=new MessageChannel;return e.port1.onmessage=flush,function(){return e.port2.postMessage(0)}}():c===undefined?function(){try{var e=n(40);return a=e.runOnLoop||e.runOnContext,useVertxTimer()}catch(t){return useSetTimeout()}}():useSetTimeout();var m=Math.random().toString(36).substring(16),g=void 0,w=1,v=2,y=new ErrorObject,b=new ErrorObject,R=0;return Enumerator$1.prototype._enumerate=function(e){for(var t=0;this._state===g&&t<e.length;t++)this._eachEntry(e[t],t)},Enumerator$1.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===resolve$1){var i=getThen(e);if(i===then&&e._state!==g)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===Promise$2){var o=new n(noop);handleMaybeThenable(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},Enumerator$1.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===g&&(this._remaining--,e===v?reject(r,n):this._result[t]=n),0===this._remaining&&fulfill(r,this._result)},Enumerator$1.prototype._willSettleAt=function(e,t){var n=this;subscribe(e,undefined,function(e){return n._settledAt(w,t,e)},function(e){return n._settledAt(v,t,e)})},Promise$2.all=all$1,Promise$2.race=race$1,Promise$2.resolve=resolve$1,Promise$2.reject=reject$1,Promise$2._setScheduler=setScheduler,Promise$2._setAsap=setAsap,Promise$2._asap=u,Promise$2.prototype={constructor:Promise$2,then:then,"catch":function(e){return this.then(null,e)}},Promise$2.polyfill=polyfill$1,Promise$2.Promise=Promise$2,Promise$2})}).call(t,n(35),n(36))},function(e,t){var n=window.MathUtil||{};n.degToRad=Math.PI/180,n.radToDeg=180/Math.PI,n.Vector2=function(e,t){this.x=e||0,this.y=t||0},n.Vector2.prototype={constructor:n.Vector2,set:function(e,t){return this.x=e,this.y=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},n.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},n.Vector3.prototype={constructor:n.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,c=s*n+a*t-i*r,l=s*r+i*n-o*t,h=-i*t-o*n-a*r;return this.x=u*s+h*-i+c*-a-l*-o,this.y=c*s+h*-o+l*-i-u*-a,this.z=l*s+h*-a+u*-o-c*-i,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}},n.Quaternion=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=r!==undefined?r:1},n.Quaternion.prototype={constructor:n.Quaternion,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,n){var r=Math.cos(e/2),i=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),s=Math.sin(t/2),u=Math.sin(n/2);return this.x=a*i*o+r*s*u,this.y=r*s*o-a*i*u,this.z=r*i*u+a*s*o,this.w=r*i*o-a*s*u,this},setFromEulerYXZ:function(e,t,n){var r=Math.cos(e/2),i=Math.cos(t/2),o=Math.cos(n/2),a=Math.sin(e/2),s=Math.sin(t/2),u=Math.sin(n/2);return this.x=a*i*o+r*s*u,this.y=r*s*o-a*i*u,this.z=r*i*u-a*s*o,this.w=r*i*o+a*s*u,this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(n),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,r=e.y,i=e.z,o=e.w,a=t.x,s=t.y,u=t.z,c=t.w;return this.x=n*c+o*a+r*u-i*s,this.y=r*c+o*s+i*a-n*u,this.z=i*c+o*u+n*s-r*a,this.w=o*c-n*a-r*s-i*u,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this.x,r=this.y,i=this.z,o=this.w,a=o*e.w+n*e.x+r*e.y+i*e.z;if(a<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,a=-a):this.copy(e),a>=1)return this.w=o,this.x=n,this.y=r,this.z=i,this;var s=Math.acos(a),u=Math.sqrt(1-a*a);if(Math.abs(u)<.001)return this.w=.5*(o+this.w),this.x=.5*(n+this.x),this.y=.5*(r+this.y),this.z=.5*(i+this.z),this;var c=Math.sin((1-t)*s)/u,l=Math.sin(t*s)/u;return this.w=o*c+this.w*l,this.x=n*c+this.x*l,this.y=r*c+this.y*l,this.z=i*c+this.z*l,this},setFromUnitVectors:function(){var e,t;return function(r,i){return e===undefined&&(e=new n.Vector3),t=r.dot(i)+1,t<1e-6?(t=0,Math.abs(r.x)>Math.abs(r.z)?e.set(-r.y,r.x,0):e.set(0,-r.z,r.y)):e.crossVectors(r,i),this.x=e.x,this.y=e.y,this.z=e.z,this.w=t,this.normalize(),this}}()},e.exports=n},function(e,t){var n=window.Util||{};n.MIN_TIMESTEP=.001,n.MAX_TIMESTEP=1,n.base64=function(e,t){return"data:"+e+";base64,"+t},n.clamp=function(e,t,n){return Math.min(Math.max(t,e),n)},n.lerp=function(e,t,n){return e+(t-e)*n},n.race=function(e){return Promise.race?Promise.race(e):new Promise(function(t,n){for(var r=0;r<e.length;r++)e[r].then(t,n)})},n.isIOS=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}(),n.isWebViewAndroid=function(){var e=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return e}}(),n.isSafari=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return e}}(),n.isFirefoxAndroid=function(){var e=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return e}}(),n.isR7=function(){var e=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return e}}(),n.isLandscapeMode=function(){var e=90==window.orientation||-90==window.orientation;return n.isR7()?!e:e},n.isTimestampDeltaValid=function(e){return!isNaN(e)&&(!(e<=n.MIN_TIMESTEP)&&!(e>n.MAX_TIMESTEP))},n.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},n.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},n.requestFullscreen=function(e){if(n.isWebViewAndroid())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0},n.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},n.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},n.linkProgram=function(e,t,n,r){var i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,t),e.compileShader(i);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var a=e.createProgram();e.attachShader(a,i),e.attachShader(a,o);for(var s in r)e.bindAttribLocation(a,r[s],s);return e.linkProgram(a),e.deleteShader(i),e.deleteShader(o),a},n.getProgramUniforms=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i="",o=0;o<r;o++){i=e.getActiveUniform(t,o).name.replace("[0]",""),n[i]=e.getUniformLocation(t,i)}return n},n.orthoMatrix=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e},n.copyArray=function(e,t){for(var n=0,r=e.length;n<r;n++)t[n]=e[n]},n.isMobile=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},n.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n.safariCssSizeWorkaround=function(e){if(n.isIOS()){var t=e.style.width,r=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(r)+"px",setTimeout(function(){e.style.width=t,e.style.height=r},100)}window.Util=n,window.canvas=e},n.isDebug=function(){return n.getQueryParameter("debug")},n.getQueryParameter=function(e){var e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},n.frameDataFromPose=function(){function mat4_perspectiveFromFieldOfView(n,r,i,o){var a=Math.tan(r?r.upDegrees*e:t),s=Math.tan(r?r.downDegrees*e:t),u=Math.tan(r?r.leftDegrees*e:t),c=Math.tan(r?r.rightDegrees*e:t),l=2/(u+c),h=2/(a+s);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=-(u-c)*l*.5,n[9]=(a-s)*h*.5,n[10]=o/(i-o),n[11]=-1,n[12]=0,n[13]=0,n[14]=o*i/(i-o),n[15]=0,n}function mat4_fromRotationTranslation(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,h=r*u,f=r*c,d=i*u,p=i*c,_=o*c,m=a*s,g=a*u,w=a*c;return e[0]=1-(d+_),e[1]=h+w,e[2]=f-g,e[3]=0,e[4]=h-w,e[5]=1-(l+_),e[6]=p+m,e[7]=0,e[8]=f+g,e[9]=p-m,e[10]=1-(l+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function mat4_translate(e,t,n){var r,i,o,a,s,u,c,l,h,f,d,p,_=n[0],m=n[1],g=n[2];return t===e?(e[12]=t[0]*_+t[4]*m+t[8]*g+t[12],e[13]=t[1]*_+t[5]*m+t[9]*g+t[13],e[14]=t[2]*_+t[6]*m+t[10]*g+t[14],e[15]=t[3]*_+t[7]*m+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=r*_+s*m+h*g+t[12],e[13]=i*_+u*m+f*g+t[13],e[14]=o*_+c*m+d*g+t[14],e[15]=a*_+l*m+p*g+t[15]),e}function mat4_invert(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],d=t[11],p=t[12],_=t[13],m=t[14],g=t[15],w=n*s-r*a,v=n*u-i*a,y=n*c-o*a,b=r*u-i*s,R=r*c-o*s,E=i*c-o*u,T=l*_-h*p,x=l*m-f*p,P=l*g-d*p,C=h*m-f*_,I=h*g-d*_,S=f*g-d*m,A=w*S-v*I+y*C+b*P-R*x+E*T;return A?(A=1/A,e[0]=(s*S-u*I+c*C)*A,e[1]=(i*I-r*S-o*C)*A,e[2]=(_*E-m*R+g*b)*A,e[3]=(f*R-h*E-d*b)*A,e[4]=(u*P-a*S-c*x)*A,e[5]=(n*S-i*P+o*x)*A,e[6]=(m*y-p*E-g*v)*A,e[7]=(l*E-f*y+d*v)*A,e[8]=(a*I-s*P+c*T)*A,e[9]=(r*P-n*I-o*T)*A,e[10]=(p*R-_*y+g*w)*A,e[11]=(h*y-l*R-d*w)*A,e[12]=(s*x-a*C-u*T)*A,e[13]=(n*C-r*x+i*T)*A,e[14]=(_*v-p*b-m*w)*A,e[15]=(l*b-h*v+f*w)*A,e):null}function updateEyeMatrices(e,t,i,o,a){mat4_perspectiveFromFieldOfView(e,o?o.fieldOfView:null,a.depthNear,a.depthFar),mat4_fromRotationTranslation(t,i.orientation||n,i.position||r),o&&mat4_translate(t,t,o.offset),mat4_invert(t,t)}var e=Math.PI/180,t=.25*Math.PI,n=new Float32Array([0,0,0,1]),r=new Float32Array([0,0,0]);return function(e,t,n){return!(!e||!t)&&(e.pose=t,e.timestamp=t.timestamp,updateEyeMatrices(e.leftProjectionMatrix,e.leftViewMatrix,t,n.getEyeParameters("left"),n),updateEyeMatrices(e.rightProjectionMatrix,e.rightViewMatrix,t,n.getEyeParameters("right"),n),!0)}}(),n.isInsideCrossDomainIFrame=function(){var e=window.self!==window.top,t=n.getDomainFromUrl(document.referrer),r=n.getDomainFromUrl(window.location.href);return e&&t!==r},n.getDomainFromUrl=function(e){var t;return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0]},e.exports=n},function(e,n){e.exports=t},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=function(e){function SpriteImage(t,n){_classCallCheck(this,SpriteImage);var r=_possibleConstructorReturn(this,e.call(this)),i=n||{};return r._el=t,r._rowCount=i.rowCount||1,r._colCount=i.colCount||1,r._totalCount=r._rowCount*r._colCount,r._width=i.width||"auto",r._height=i.height||"auto",r._autoHeight=null!=i.autoHeight?i.autoHeight:"true",r._colRow=[0,0],i.colRow?r._colRow=i.colRow:i.frameIndex&&r.setFrameIndex(i.frameIndex),r._el.style.width=SpriteImage._getSizeString(r._width),r._el.style.height=SpriteImage._getSizeString(r._height),i.imageUrl?(r._image=new Image,r._image.onload=function(){r._bg=SpriteImage._createBgDiv(r._image,r._rowCount,r._colCount,r._autoHeight),r._el.appendChild(r._bg),r.setColRow(r._colRow[0],r._colRow[1]),r.trigger("load",{target:r._el,bgElement:r._bg}),r._autoPlayReservedInfo&&(r.play(r._autoPlayReservedInfo),r._autoPlayReservedInfo=null)},r._image.onerror=function(e){r.trigger("imageError",{imageUrl:i.imageUrl})},r._image.src=i.imageUrl,r):(setTimeout(function(){r.trigger("imageError",{imageUrl:i.imageUrl})},0),_possibleConstructorReturn(r))}return _inherits(SpriteImage,e),SpriteImage._createBgDiv=function(e,t,n,r){var i=document.createElement("div");i.style.backgroundImage="url("+e.src+")",i.style.backgroundSize=100*n+"% "+100*t+"%";var o=e.width/n,a=e.height/t;if(r){var s=a/o;i.style.paddingBottom=100*s+"%"}else i.style.height="100%";return i},SpriteImage.prototype.setFrameIndex=function(e){var t=this.toColRow(e);this.setColRow(t[0],t[1])},SpriteImage.prototype.getFrameIndex=function(){return this._colRow[1]*this._colCount+this._colRow[0]},SpriteImage.prototype.setColRow=function(e,t){t>this._rowCount-1||e>this._colCount-1||(this._bg&&(this._bg.style.backgroundPosition=100*-e+"% "+100*-t+"%"),this._colRow=[e,t])},SpriteImage.prototype.getColRow=function(){return this._colRow},SpriteImage._getSizeString=function(e){return"number"==typeof e?e+"px":e},SpriteImage.prototype.stop=function(){this._autoPlayTimer&&(clearInterval(this._autoPlayTimer),this._autoPlayTimer=null)},SpriteImage.prototype.play=function(){var e=this,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{interval:1e3/this._totalCount,playCount:0},n=t.interval,r=t.playCount;if(!this._bg)return void(this._autoPlayReservedInfo={interval:n,playCount:r});this._autoPlayTimer&&(clearInterval(this._autoPlayTimer),this._autoPlayTimer=null);var i=this.getFrameIndex(),o=0,a=0;this._autoPlayTimer=setInterval(function(){i%=e._totalCount;var t=e.toColRow(i);e.setColRow(t[0],t[1]),i++,++a===e._totalCount&&(a=0,o++),r>0&&o===r&&clearInterval(e._autoPlayTimer)},n)},SpriteImage.prototype.toColRow=function(e){var t=this._colCount,n=this._rowCount;return e<0?[0,0]:e>=this._totalCount?[t-1,n-1]:[e%t,Math.floor(e/t)]},SpriteImage}(i["default"]);t["default"]=o},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=n(13),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o={0:"NO_ERROR",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",37442:"CONTEXT_LOST_WEBGL"},a=function(){function WebGLUtils(){_classCallCheck(this,WebGLUtils)}return WebGLUtils.createShader=function(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(e.deleteShader(r),null)},WebGLUtils.createProgram=function(e,t,n){var r=e.createProgram();return e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)?r:(e.deleteProgram(r),null)},WebGLUtils.initBuffer=function(e,t,n,r){var i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,e.STATIC_DRAW),i&&(i.itemSize=r,i.numItems=n.length/r),i},WebGLUtils.bindBufferToAttribute=function(e,t,n){null!==t&&null!==n&&(e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(n,t.itemSize,e.FLOAT,!1,0,0))},WebGLUtils.getWebglContext=function(e){function onWebglcontextcreationerror(e){return e.statusMessage}var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=null;e.addEventListener("webglcontextcreationerror",onWebglcontextcreationerror);for(var r=0;r<t.length;r++){try{n=e.getContext(t[r],{preserveDrawingBuffer:!1})}catch(i){}if(n)break}return e.removeEventListener("webglcontextcreationerror",onWebglcontextcreationerror),n},WebGLUtils.createTexture=function(e,t){var n=e.createTexture();return e.bindTexture(t,n),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(t,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(t,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(t,null),n},WebGLUtils.isWebGLAvailable=function(){var e=document.createElement("canvas"),t=WebGLUtils.getWebglContext(e),n=!!t;if(t){var r=t.getExtension("WEBGL_lose_context");r&&r.loseContext()}return n},WebGLUtils.isStableWebGL=function(){var e=!0,t=(0,i["default"])();return"android"===t.os.name&&parseFloat(t.os.version)<=4.3?e=!1:"android"===t.os.name&&4.4===parseFloat(t.os.version)?"chrome"!==t.browser.name&&(e=!1):"ios"===t.os.name&&parseInt(t.os.version,10)<=7&&(e=!1),e},WebGLUtils.getErrorNameFromWebGLErrorCode=function(e){return e in o?o[e]:"UNKNOWN_ERROR"},WebGLUtils}();t["default"]=a},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function Renderer(){_classCallCheck(this,Renderer)};t["default"]=r},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){"use strict";var r=n(1),i=function(e){return e&&e.__esModule?e:{"default":e}}(r);e.exports=i["default"]},function(e,t,n){"use strict";function agent(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:r.navigator.userAgent;o["default"].setUa(e);var t={os:o["default"].getOs(),browser:o["default"].getBrowser(),isMobile:o["default"].getIsMobile()};return t.browser.name=t.browser.name.toLowerCase(),t.os.name=t.os.name.toLowerCase(),t.os.version=t.os.version.toLowerCase(),"ios"===t.os.name&&t.browser.webview&&(t.browser.version="-1"),t}t.__esModule=!0;var r=n(2),i=n(3),o=function(e){return e&&e.__esModule?e:{"default":e}}(i);agent.VERSION="2.1.2",t["default"]=agent,e.exports=t["default"]},function(e,t,n){"use strict";t.__esModule=!0;var r="undefined"!=typeof window&&window||{};t.RegExp=r.RegExp,t.navigator=r.navigator},function(e,t,n){"use strict";function setUa(e){o=e}function isMatched(e,t){return t&&t.test?!!t.test(e):e.indexOf(t)>-1}function getIdentityStringFromArray(e,t){var n=e.filter(function(e){return isMatched(o,e.criteria)})[0];return n&&n.identity||t.name}function getRule(e,t){return e.filter(function(e){var n=e.criteria,r=new RegExp(e.identity,"i").test(t);return!!(n?r&&isMatched(o,n):r)})[0]}function getBrowserName(){return getIdentityStringFromArray(i["default"].browser,i["default"].defaultString.browser)}function getBrowserRule(e){var t=getRule(i["default"].browser,e);return t||(t={criteria:e,versionSearch:e,identity:e}),t}function extractBrowserVersion(e,t){var n=i["default"].defaultString.browser.version,r=new RegExp("("+e+")","i").exec(t);if(!r)return n;var o=r.index,a=r[0];if(o>-1){var s=o+a.length+1;n=t.substring(s).split(" ")[0].replace(/_/g,".").replace(/;|\)/g,"")}return n}function getBrowserVersion(e){return e?extractBrowserVersion(getBrowserRule(e).versionSearch||e,o):undefined}function isWebview(){var e=i["default"].webview,t=void 0;return e.filter(function(e){return isMatched(o,e.criteria)}).some(function(e){return t=extractBrowserVersion(e.browserVersionSearch,o),!(!isMatched(o,e.webviewToken)&&!isMatched(t,e.webviewBrowserVersion))})}function getOSRule(e){return getRule(i["default"].os,e)}function getOsName(){return getIdentityStringFromArray(i["default"].os,i["default"].defaultString.os)}function getOsVersion(e){var t=getOSRule(e)||{},n=i["default"].defaultString.os.version,r=void 0;if(!e)return undefined;if(t.versionAlias)return t.versionAlias;var a=t.versionSearch||e,s=new RegExp("("+a+")\\s([\\d_\\.]+|\\d_0)","i");return s.exec(o)&&(r=s.exec(o)[2].replace(/_/g,".").replace(/;|\)/g,"")),r||n}function getOs(){var e=getOsName();return{name:e,version:getOsVersion(e)}}function getBrowser(){var e=getBrowserName();return{name:e,version:getBrowserVersion(e),webview:isWebview()}}function getIsMobile(){return-1!==o.indexOf("Mobi")}t.__esModule=!0;var r=n(4),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=void 0;t["default"]={getOs:getOs,getBrowser:getBrowser,getIsMobile:getIsMobile,setUa:setUa},e.exports=t["default"]},function(e,t,n){"use strict";t.__esModule=!0;var r={browser:[{criteria:"PhantomJS",identity:"PhantomJS"},{criteria:/Whale/,identity:"Whale",versionSearch:"Whale"},{criteria:/Edge/,identity:"Edge",versionSearch:"Edge"},{criteria:/MSIE|Trident|Windows Phone/,identity:"IE",versionSearch:"IEMobile|MSIE|rv"},{criteria:/MiuiBrowser/,identity:"MIUI Browser",versionSearch:"MiuiBrowser"},{criteria:/SamsungBrowser/,identity:"Samsung Internet",versionSearch:"SamsungBrowser"},{criteria:/SAMSUNG /,identity:"Samsung Internet",versionSearch:"Version"},{criteria:/Chrome|CriOS/,identity:"Chrome"},{criteria:/Android/,identity:"Android Browser",versionSearch:"Version"},{criteria:/iPhone|iPad/,identity:"Safari",versionSearch:"Version"},{criteria:"Apple",identity:"Safari",versionSearch:"Version"},{criteria:"Firefox",identity:"Firefox"}],os:[{criteria:/Windows Phone/,identity:"Windows Phone",versionSearch:"Windows Phone"},{criteria:"Windows 2000",identity:"Window",versionAlias:"5.0"},{criteria:/Windows NT/,identity:"Window",versionSearch:"Windows NT"},{criteria:/iPhone|iPad/,identity:"iOS",versionSearch:"iPhone OS|CPU OS"},{criteria:"Mac",versionSearch:"OS X",identity:"MAC"},{criteria:/Android/,identity:"Android"},{criteria:/Tizen/,identity:"Tizen"},{criteria:/Web0S/,identity:"WebOS"}],webview:[{criteria:/iPhone|iPad/,browserVersionSearch:"Version",webviewBrowserVersion:/-1/},{criteria:/iPhone|iPad|Android/,webviewToken:/NAVER|DAUM|; wv/}],defaultString:{browser:{version:"-1",name:"unknown"},os:{version:"-1",name:"unknown"}}};t["default"]=r,e.exports=t["default"]}])})},function(e,t,n){"use strict";t.__esModule=!0,t.YawPitchControl=undefined;var r=n(25),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=n(4);i["default"].CONTROL_MODE_VR=o.CONTROL_MODE_VR,i["default"].CONTROL_MODE_YAWPITCH=o.CONTROL_MODE_YAWPITCH,i["default"].TOUCH_DIRECTION_ALL=o.TOUCH_DIRECTION_ALL,i["default"].TOUCH_DIRECTION_YAW=o.TOUCH_DIRECTION_YAW,i["default"].TOUCH_DIRECTION_PITCH=o.TOUCH_DIRECTION_PITCH,i["default"].TOUCH_DIRECTION_NONE=o.TOUCH_DIRECTION_NONE,t.YawPitchControl=i["default"]},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=n(14),a=n(21),s=n(24),u=n(1),c="undefined"==typeof Promise?n(6).Promise:Promise,l=function(e){function PanoViewer(t,n){_classCallCheck(this,PanoViewer);var r=_possibleConstructorReturn(this,e.call(this));if(n.checkSupport&&!n.checkSupport()){var i;return setTimeout(function(){r.trigger(s.EVENTS.ERROR,{type:s.ERROR_TYPE.INVALID_DEVICE,message:"invalid device"})},0),i=r,_possibleConstructorReturn(r,i)}if(!a.WebGLUtils.isWebGLAvailable()){var u;return setTimeout(function(){r.trigger(s.EVENTS.ERROR,{type:s.ERROR_TYPE.NO_WEBGL,message:"no webgl support"})},0),u=r,_possibleConstructorReturn(r,u)}r._container=t,r._image=n.image,r._imageType=n.imageType||a.PanoImageRenderer.ImageType.EQUIRECTANGULAR,r._width=n.width||parseInt(window.getComputedStyle(t).width,10),r._height=n.height||parseInt(window.getComputedStyle(t).height,10),r._yaw=n.yaw||0,r._pitch=n.pitch||0,r._fov=n.fov||65,r._aspectRatio=r._width/r._height;var c=n.fovRange||[30,110],l=c[1]-c[0];l<r._fov&&(r._fov=l);var h=Object.assign(n,{element:t,yaw:r._yaw,pitch:r._pitch,fov:r._fov,fovRange:c,aspectRatio:r._aspectRatio});r._isResumed=!1;try{r._initRenderer(r._yaw,r._pitch,r._fov,r._imageType)}catch(d){var f;return setTimeout(function(){r._photoSphereRenderer&&r._photoSphereRenderer.destroy(),r.trigger(s.EVENTS.ERROR,{type:s.ERROR_TYPE.NO_WEBGL,message:"no webgl support"})},0),f=r,_possibleConstructorReturn(r,f)}return r._yawPitchControl=new o.YawPitchControl(h),r._initYawPitchControl(),r}return _inherits(PanoViewer,e),PanoViewer.prototype.getImage=function(){return{image:this._image,imageType:this._imageType}},PanoViewer.prototype.setImage=function(e){var t=this,n=e.image,r=e.imageType;n&&(this._image=n),r&&this._imageType!==r&&(this._imageType=r,this._isResumed&&this._stopRender()),this._photoSphereRenderer&&this._photoSphereRenderer.setImage({image:this._image,imageType:this._imageType}).then(function(e){e&&t._isResumed&&t._photoSphereRenderer.bindTexture().then(function(){t._startRender()})})},PanoViewer.prototype._initRenderer=function(e,t,n,r){this._photoSphereRenderer&&this._photoSphereRenderer.destroy(),this._photoSphereRenderer=new a.PanoImageRenderer(this._image,this._width,this._height,{initialYaw:e,initialPitch:t,fieldOfView:n,imageType:r}),this._bindRendererHandler()},PanoViewer.prototype._bindRendererHandler=function(){var e=this;this._photoSphereRenderer.on(a.PanoImageRenderer.EVENTS.ERROR,function(t){e.trigger(s.EVENTS.ERROR,t)}),this._photoSphereRenderer.on(a.PanoImageRenderer.EVENTS.RENDERING_CONTEXT_LOST,function(t){e.suspend()}),this._photoSphereRenderer.on(a.PanoImageRenderer.EVENTS.RENDERING_CONTEXT_RESTORE,function(t){e.resume()})},PanoViewer.prototype._initYawPitchControl=function(){var e=this;this._yawPitchControl.on(s.EVENTS.ANIMATION_END,function(t){e._triggerEvent(s.EVENTS.ANIMATION_END,t)}),this._yawPitchControl.on("change",function(t){e._yaw=t.yaw,e._pitch=t.pitch,e._fov=t.fov,e._triggerEvent(s.EVENTS.VIEW_CHANGE,t)})},PanoViewer.prototype._triggerEvent=function(e,t){var n=t||{};return this.trigger(e,n)},PanoViewer.prototype.setUseZoom=function(e){"boolean"==typeof e&&this._yawPitchControl.option("useZoom",e)},PanoViewer.prototype.setUseKeyboard=function(e){this._yawPitchControl.option("useKeyboard",e)},PanoViewer.prototype.setFovRange=function(e){this._yawPitchControl.option("fovRange",e)},PanoViewer.prototype.getFovRange=function(){return this._yawPitchControl.option("fovRange")},PanoViewer.prototype.updateViewportDimensions=function(e){this._isResumed&&(this._width=e&&e.width||parseInt(window.getComputedStyle(this._container).width,10),this._height=e&&e.height||parseInt(window.getComputedStyle(this._container).height,10),this._aspectRatio=this._width/this._height,this._photoSphereRenderer.updateViewportDimensions(this._width,this._height),this._yawPitchControl.option("aspectRatio",this._aspectRatio),this.lookAt({},0))},PanoViewer.prototype.getFov=function(){return this._fov},PanoViewer.prototype._getHFov=function(){return u.glMatrix.toDegree(2*Math.atan(this._aspectRatio*Math.tan(u.glMatrix.toRadian(this._fov)/2)))},PanoViewer.prototype.getYaw=function(){return this._yaw},PanoViewer.prototype.getPitch=function(){return this._pitch},PanoViewer.prototype.getYawRange=function(){return this._yawPitchControl.option("yawRange")},PanoViewer.prototype.getPitchRange=function(){return this._yawPitchControl.option("pitchRange")},PanoViewer.prototype.setYawRange=function(e){return this._yawPitchControl.option("yawRange",e)},PanoViewer.prototype.setPitchRange=function(e){return this._yawPitchControl.option("pitchRange",e)},PanoViewer.prototype.setShowPolePoint=function(e){return this._yawPitchControl.option("showPolePoint",e)},PanoViewer.prototype.lookAt=function(e,t){if(this._isResumed){var n=e.yaw!==undefined?e.yaw:this._yaw,r=e.pitch!==undefined?e.pitch:this._pitch,i=this._yawPitchControl.option("pitchRange"),o=i[1]-i[0],a=e.fov!==undefined?e.fov:this._fov;o<a&&(a=o),this._yawPitchControl.lookAt({yaw:n,pitch:r,fov:a},t),0===t&&this._photoSphereRenderer.render(n,r,a)}},PanoViewer.prototype.resume=function(){var e=this;!this._isResumed&&this._yawPitchControl&&(this._photoSphereRenderer||this._initRenderer(this._yaw,this._pitch,this._fov,this._imageType),setTimeout(function(){!e._isResumed&&e._photoSphereRenderer&&e._photoSphereRenderer.bindTexture().then(function(){return e._resume()})["catch"](function(){e._triggerEvent(s.EVENTS.ERROR,{type:s.ERROR_TYPE.FAIL_BIND_TEXTURE,message:"failed to bind texture"})})},0))},PanoViewer.prototype._resume=function(){this._photoSphereRenderer.attachTo(this._container),this._yawPitchControl.enable(),this.updateViewportDimensions(),this._isResumed=!0,this._triggerEvent(s.EVENTS.RESUME),this._startRender()},PanoViewer.prototype._startRender=function(){this._renderLoop=this._renderLoop.bind(this),this._rafId=window.requestAnimationFrame(this._renderLoop)},PanoViewer.prototype._renderLoop=function(){this._photoSphereRenderer&&this._photoSphereRenderer.isImageLoaded()&&this._photoSphereRenderer.render(this._yaw,this._pitch,this._fov),this._rafId=window.requestAnimationFrame(this._renderLoop)},PanoViewer.prototype._stopRender=function(){this._rafId&&(window.cancelAnimationFrame(this._rafId),delete this._rafId)},PanoViewer.prototype.suspend=function(){this._photoSphereRenderer&&(this._photoSphereRenderer.cancelLoadImage(),this._photoSphereRenderer.destroy(),this._photoSphereRenderer=null),this._isResumed&&(this._yawPitchControl.disable(),this._stopRender(),this._isResumed=!1),this._triggerEvent(s.EVENTS.SUSPEND)},PanoViewer.prototype.isResumed=function(){return this._isResumed},PanoViewer.prototype.destroy=function(){this.suspend(),this._yawPitchControl&&(this._yawPitchControl.destroy(),this._yawPitchControl=null),this._photoSphereRenderer&&(this._photoSphereRenderer.destroy(),this._photoSphereRenderer=null),this._isResumed=!1},PanoViewer.isWebGLAvailable=function(){return a.WebGLUtils.isWebGLAvailable()},PanoViewer.isStableWebGL=function(){return a.WebGLUtils.isStableWebGL()},PanoViewer.isGyroSensorAvailable=function(e){if("DeviceMotionEvent"in window==!1||!window.DeviceMotionEvent)return void(e&&e(!1));var t=void 0;c.race([function(){return new c(function(e,n){t=function(t){var n=null!==t.rotationRate.alpha;e(n)},window.addEventListener("devicemotion",t)})}(),function(){return new c(function(e,t){setTimeout(function(){return e(!1)},1e3)})}()]).then(function(n){window.removeEventListener("devicemotion",t),e&&e(n),PanoViewer.isGyroSensorAvailable=function(e){return e&&e(n),n}})},PanoViewer}(i["default"]);t["default"]=l,l.ERROR_TYPE=s.ERROR_TYPE,l.EVENTS=s.EVENTS,l.ImageType=a.PanoImageRenderer.ImageType},function(e,t,n){"use strict";t.__esModule=!0,t.PanoViewer=undefined;var r=n(15),i=function(e){return e&&e.__esModule?e:{"default":e}}(r);t.PanoViewer=i["default"]},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=_interopRequireDefault(r),o=n(9),a=_interopRequireDefault(o),s=n(10),u=_interopRequireDefault(s),c=function(e){function SpinViewer(t,n){_classCallCheck(this,SpinViewer);var r=_possibleConstructorReturn(this,e.call(this));r._el=t;var i=n||{},o=i.colCount||1,s=i.rowCount||1;return r._scale=i.scale||1,r._frameCount=o*s,r._sprites=new u["default"](t,i).on({load:function(e){r.trigger("load",e)},imageError:function(e){r.trigger("imageError",{imageUrl:e.imageUrl})}}),r._panInput=new a["default"].PanInput(r._el,{scale:[r._scale,r._scale]}),r._axes=new a["default"]({angle:{range:[0,359],circular:!0}}).on({change:function(e){var t=Math.floor(e.pos.angle/(360/r._frameCount)),n=r._frameCount-t-1;r._sprites.setFrameIndex(n),r.trigger("change",{frameIndex:n,colRow:r._sprites.getColRow(),angle:e.pos.angle})}}),r._axes.connect("angle",r._panInput),r}return _inherits(SpinViewer,e),SpinViewer.prototype.setScale=function(e){return this._panInput.options.scale=[e,e],this},SpinViewer.prototype.spinBy=function(e){var t=e.angle,n=t===undefined?0:t,r=e.duration,i=r===undefined?400:r;return this._axes.setBy({angle:n},i),this},SpinViewer}(i["default"]);t["default"]=c},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0,t.SpriteImage=t.SpinViewer=undefined;var r=n(17),i=_interopRequireDefault(r),o=n(10),a=_interopRequireDefault(o);t.SpinViewer=i["default"],t.SpriteImage=a["default"],i["default"].VERSION="2.0.0"},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="undefined"==typeof Promise?n(6).Promise:Promise,o=function(){function ImageLoader(e){_classCallCheck(this,ImageLoader),this.image=null,e&&this.setImage(e)}return ImageLoader.prototype.get=function(){var e=this;return new i(function(t,n){e.image?e.image.complete?t(e.image):(ImageLoader._once(e.image,"load",function(){t(e.image)}),ImageLoader._once(e.image,"error",function(){n("failed to load images.")})):n("image is not defiend")})},ImageLoader.prototype.setImage=function(e){return"string"==typeof e?(this.image=new Image,this.image.src=e):"object"===(void 0===e?"undefined":r(e))&&(this.image=e),this.get()},ImageLoader._once=function(e,t,n){e.addEventListener(t,function fn(r){e.removeEventListener(t,fn),n(r)})},ImageLoader.prototype.isImageLoaded=function(){return!!this.image&&(!!this.image.src&&!!this.image.complete)},ImageLoader.prototype.cancelLoadImage=function(){this.image&&!this.isImageLoaded()&&(this.image.src="")},ImageLoader.prototype.loadImage=function(){this._imageURL&&!this.isImageLoaded()&&(this.image.setAttribute("crossorigin","anonymous"),this.image.src=this._imageURL)},ImageLoader.prototype.destroy=function(){this.image=null},ImageLoader}();t["default"]=o},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=_interopRequireDefault(r),o=n(19),a=_interopRequireDefault(o),s=n(11),u=_interopRequireDefault(s),c=n(22),l=_interopRequireDefault(c),h=n(23),f=_interopRequireDefault(h),d=n(1),p="undefined"==typeof Promise?n(6).Promise:Promise,_={EQUIRECTANGULAR:"equirectangular",VERTICAL_CUBESTRIP:"vertical_cubestrip"},m=window.devicePixelRatio||1;m>2&&(m=2);var g={BIND_TEXTURE:"bindTexture",IMAGE_LOADED:"imageLoaded",ERROR:"error",RENDERING_CONTEXT_LOST:"renderingContextLost",RENDERING_CONTEXT_RESTORE:"renderingContextRestore"},w={INVALID_DEVICE:10,NO_WEBGL:11,FAIL_IMAGE_LOAD:12},v=function(e){function PanoImageRenderer(t,n,r,i){_classCallCheck(this,PanoImageRenderer);var o=_possibleConstructorReturn(this,e.call(this));return o.sphericalConfig=i,o.fieldOfView=i.fieldOfView,o.width=n,o.height=r,o._lastQuaternion=null,o._lastYaw=null,o._lastPitch=null,o._lastFieldOfView=null,o.pMatrix=d.mat4.create(),o.mvMatrix=d.mat4.create(),d.mat4.perspective(o.pMatrix,d.glMatrix.toRadian(o.fieldOfView),n/r,.1,100),o.textureCoordBuffer=null,o.vertexBuffer=null,o.indexBuffer=null,o.canvas=o._initCanvas(n,r),o._image=null,o._imageLoader=new a["default"],o._onImageLoad=o._onImageLoad.bind(o),o._onImageError=o._onImageError.bind(o),o.setImage({image:t,imageType:i.imageType}),o}return _inherits(PanoImageRenderer,e),PanoImageRenderer.prototype.setImage=function(e){var t=e.image,n=e.imageType;return this._setImageType(n),this._imageLoader.setImage(t).then(this._onImageLoad)["catch"](this._onImageError)},PanoImageRenderer.prototype._setImageType=function(e){e&&this._imageType!==e&&(this._imageType=e,this._isCubeStrip=e===_.VERTICAL_CUBESTRIP||e===_.CUBEMAP,this._renderer=this._isCubeStrip?l["default"]:f["default"],this._initWebGL())},PanoImageRenderer.prototype._initCanvas=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.style.bottom=0,n.style.left=0,n.style.right=0,n.style.top=0,n.style.margin="auto",n.style.maxHeight="100%",n.style.maxWidth="100%",n.style.outline="none",n.style.position="absolute",this._onWebglcontextlost=this._onWebglcontextlost.bind(this),this._onWebglcontextrestored=this._onWebglcontextrestored.bind(this),n.addEventListener("webglcontextlost",this._onWebglcontextlost),n.addEventListener("webglcontextrestored",this._onWebglcontextrestored),n},PanoImageRenderer.prototype._onImageError=function(e){return this._image=null,this.trigger(g.ERROR,{type:w.FAIL_IMAGE_LOAD,message:"failed to load image"}),!1},PanoImageRenderer.prototype._onImageLoad=function(e){return this._image=e,this.trigger(g.IMAGE_LOADED),!0},PanoImageRenderer.prototype.isImageLoaded=function(){return!!this._image},PanoImageRenderer.prototype.cancelLoadImage=function(){this._imageLoader.cancelLoadImage()},PanoImageRenderer.prototype.bindTexture=function(){var e=this;return new p(function(t,n){if(!e._imageLoader)return void n("ImageLoader is not initialized");e._imageLoader.get().then(function(){return e._bindTexture()},function(){return n("ImageLoader has failed to get image.")}).then(t)})},PanoImageRenderer.prototype.attachTo=function(e){this.detach(),e.appendChild(this.canvas)},PanoImageRenderer.prototype.forceContextLoss=function(){if(this.hasRenderingContext()){var e=this.context.getExtension("WEBGL_lose_context");e&&e.loseContext()}},PanoImageRenderer.prototype.detach=function(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas)},PanoImageRenderer.prototype.isAttached=function(){return this._image&&this.canvas&&this.canvas.parentNode},PanoImageRenderer.prototype.destroy=function(){this._imageLoader.destroy(),this.detach(),this.forceContextLoss(),this.off(),this.canvas.removeEventListener("webglcontextlost",this._onWebglcontextlost),this.canvas.removeEventListener("webglcontextrestored",this._onWebglcontextrestored)},PanoImageRenderer.prototype.hasRenderingContext=function(){return!!this.context&&!(!this.context.getProgramParameter(this.shaderProgram,this.context.LINK_STATUS)&&!this.context.isContextLost())},PanoImageRenderer.prototype._onWebglcontextlost=function(e){e.preventDefault(),this.trigger("renderingContextLost")},PanoImageRenderer.prototype._onWebglcontextrestored=function(e){this._initWebGL(),this.trigger("renderingContextRestore")},PanoImageRenderer.prototype.updateFieldOfView=function(e){this.fieldOfView!==e&&(this.fieldOfView=e,this._updateViewport())},PanoImageRenderer.prototype.updateViewportDimensions=function(e,t){var n=!1;this.width=e,this.height=t;var r=e*m,i=t*m;r!==this.canvas.width&&(this.canvas.width=r,n=!0),i!==this.canvas.height&&(this.canvas.height=i,n=!0),n&&(this._updateViewport(),this._shouldForceDraw=!0)},PanoImageRenderer.prototype._updateViewport=function(){d.mat4.perspective(this.pMatrix,d.glMatrix.toRadian(this.fieldOfView),this.canvas.width/this.canvas.height,.1,100),this.context.viewport(0,0,this.context.drawingBufferWidth,this.context.drawingBufferHeight)},PanoImageRenderer.prototype._initWebGL=function(){try{if(this._initRenderingContext(),this.updateViewportDimensions(this.width,this.height),this.shaderProgram&&this.context.deleteProgram(this.shaderProgram),this.shaderProgram=this._initShaderProgram(this.context),!this.shaderProgram)throw new Error("Failed to intialize shaders: "+u["default"].getErrorNameFromWebGLErrorCode(this.context.getError()))}catch(t){return this.trigger(g.ERROR,{type:w.NO_WEBGL,message:"no webgl support"}),void this.destroy()}this.context.clearColor(0,0,0,0);var e=this._isCubeStrip?this.context.TEXTURE_CUBE_MAP:this.context.TEXTURE_2D;this.texture&&this.context.deleteTexture(this.texture),this.texture=u["default"].createTexture(this.context,e)},PanoImageRenderer.prototype._initRenderingContext=function(){if(!this.hasRenderingContext()){if(!window.WebGLRenderingContext)throw new Error("WebGLRenderingContext not available.");if(this.context=u["default"].getWebglContext(this.canvas),!this.context)throw new Error("Failed to acquire 3D rendering context")}},PanoImageRenderer.prototype._initShaderProgram=function(e){var t=this._renderer.getVertexShaderSource(),n=u["default"].createShader(e,e.VERTEX_SHADER,t);if(!n)return!1;var r=this._renderer.getFragmentShaderSource(),i=u["default"].createShader(e,e.FRAGMENT_SHADER,r);if(!i)return!1;var o=u["default"].createProgram(e,n,i);return o?(e.useProgram(o),o.vertexPositionAttribute=e.getAttribLocation(o,"aVertexPosition"),e.enableVertexAttribArray(o.vertexPositionAttribute),o.pMatrixUniform=e.getUniformLocation(o,"uPMatrix"),o.mvMatrixUniform=e.getUniformLocation(o,"uMVMatrix"),o.samplerUniform=e.getUniformLocation(o,"uSampler"),this._isCubeStrip||(o.textureCoordAttribute=e.getAttribLocation(o,"aTextureCoord"),e.enableVertexAttribArray(o.textureCoordAttribute)),o):null},PanoImageRenderer.prototype._initBuffers=function(){var e=this._renderer.getVertexPositionData(),t=this._renderer.getIndexData(),n=this._renderer.getTextureCoordData(),r=this.context;this.vertexBuffer=u["default"].initBuffer(r,r.ARRAY_BUFFER,new Float32Array(e),3),this.indexBuffer=u["default"].initBuffer(r,r.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),1),null!==n&&(this.textureCoordBuffer=u["default"].initBuffer(r,r.ARRAY_BUFFER,new Float32Array(n),2))},PanoImageRenderer.prototype._bindTexture=function(){this._renderer.bindTexture(this.context,this.texture,this._image),this._shouldForceDraw=!0,this.trigger(g.BIND_TEXTURE)},PanoImageRenderer.prototype.renderWithQuaternion=function(e,t){if(this.hasRenderingContext()&&(this._shouldForceDraw=!0,!(this._lastQuaternion&&d.quat.exactEquals(this._lastQuaternion,e)&&this.fieldOfView&&this.fieldOfView===t&&!1===this._shouldForceDraw))){t!==undefined&&t!==this.fieldOfView&&this.updateFieldOfView(t);var n=void 0;if(this._isCubeStrip)n=e;else{var r=d.quat.rotateY(d.quat.create(),d.quat.create(),d.glMatrix.toRadian(-90));n=d.quat.multiply(d.quat.create(),r,e)}this.mvMatrix=d.mat4.fromQuat(d.mat4.create(),d.quat.conjugate(d.quat.create(),n)),this._draw(),this._lastQuaternion=d.quat.clone(e),this._shouldForceDraw&&(this._shouldForceDraw=!1)}},PanoImageRenderer.prototype.render=function(e,t,n){this.hasRenderingContext()&&(null!==this._lastYaw&&this._lastYaw===e&&null!==this._lastPitch&&this._lastPitch===t&&this.fieldOfView&&this.fieldOfView===n&&!1===this._shouldForceDraw||(n!==undefined&&n!==this.fieldOfView&&this.updateFieldOfView(n),d.mat4.identity(this.mvMatrix),d.mat4.rotateX(this.mvMatrix,this.mvMatrix,-d.glMatrix.toRadian(t)),d.mat4.rotateY(this.mvMatrix,this.mvMatrix,-d.glMatrix.toRadian(e-(this._isCubeStrip?0:90))),this._draw(),this._lastYaw=e,this._lastPitch=t,this._shouldForceDraw&&(this._shouldForceDraw=!1)))},PanoImageRenderer.prototype._draw=function(){var e=this.context;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.activeTexture(e.TEXTURE0),this._isCubeStrip?e.bindTexture(e.TEXTURE_CUBE_MAP,this.texture):e.bindTexture(e.TEXTURE_2D,this.texture),null!==this.vertexBuffer&&null!==this.indexBuffer||this._initBuffers(),e.uniform1i(this.shaderProgram.samplerUniform,0),e.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.pMatrix),e.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.mvMatrix),this.textureCoordBuffer&&u["default"].bindBufferToAttribute(e,this.textureCoordBuffer,this.shaderProgram.textureCoordAttribute),this.vertexBuffer&&u["default"].bindBufferToAttribute(e,this.vertexBuffer,this.shaderProgram.vertexPositionAttribute),this.indexBuffer&&(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.drawElements(e.TRIANGLES,this.indexBuffer.numItems,e.UNSIGNED_SHORT,0)),this._isCubeStrip?e.bindTexture(e.TEXTURE_CUBE_MAP,null):e.bindTexture(e.TEXTURE_2D,null)},PanoImageRenderer}(i["default"]);t["default"]=v,v.EVENTS=g,v.ERROR_TYPE=w,v.ImageType=_},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0,t.WebGLUtils=t.PanoImageRenderer=undefined;var r=n(20),i=_interopRequireDefault(r),o=n(11),a=_interopRequireDefault(o);t.PanoImageRenderer=i["default"],t.WebGLUtils=a["default"]},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(13),i=_interopRequireDefault(r),o=n(12),a=_interopRequireDefault(o),s=n(1),u=function(e){function CubeRenderer(){return _classCallCheck(this,CubeRenderer),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(CubeRenderer,e),CubeRenderer.getVertexPositionData=function(){return CubeRenderer._VERTEX_POSITION_DATA=null!==CubeRenderer._VERTEX_POSITION_DATA?CubeRenderer._VERTEX_POSITION_DATA:[1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1],CubeRenderer._VERTEX_POSITION_DATA},CubeRenderer.getIndexData=function(){if(CubeRenderer._INDEX_DATA)return CubeRenderer._INDEX_DATA;for(var e=[],t=CubeRenderer.getVertexPositionData(),n=0;n<t.length/3;n+=4)e.push(n,n+2,n+1,n,n+3,n+2);return CubeRenderer._INDEX_DATA=e,e},CubeRenderer.getTextureCoordData=function(){return null},CubeRenderer.getVertexShaderSource=function(){return"\n\t\t\tattribute vec3 aVertexPosition;\n\t\t\tuniform mat4 uMVMatrix;\n\t\t\tuniform mat4 uPMatrix;\n\t\t\tvarying highp vec3 vVertexDirectionVector;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t\tvVertexDirectionVector = aVertexPosition;\n\t\t\t}"},CubeRenderer.getFragmentShaderSource=function(){return"\n\t\t\tvarying highp vec3 vVertexDirectionVector;\n\t\t\tuniform samplerCube uSampler;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_FragColor = textureCube(uSampler, vVertexDirectionVector);\n\t\t\t}"},CubeRenderer.bindTexture=function(e,t,n){if(n){var r=(0,i["default"])(),o=n.width,a=CubeRenderer.hasDrawImageBug(r),s=CubeRenderer.getMaxCubeMapTextureSize(e,n,r),u=CubeRenderer.getHightScale(o,r);try{if(e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.bindTexture(e.TEXTURE_CUBE_MAP,t),a){var c=document.createElement("canvas"),l=c.getContext("2d");c.width=3*s,c.height=s;var h=document.createElement("canvas"),f=h.getContext("2d");h.width=s,h.height=s;for(var d=0;d<2;d++){l.save(),l.translate(0,s),l.rotate(-Math.PI/2),l.scale(1/3,3),l.drawImage(n,0,3*o*d*u,n.width,n.height/2*u,0,0,c.width,c.height),l.restore();for(var p=0;p<3;p++){f.save(),f.translate(s,0),f.rotate(Math.PI/2),f.drawImage(c,p*o,0,o,o,0,0,s,s),f.restore();var _=new Uint8Array(f.getImageData(0,0,s,s).data);e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+3*d+p,0,e.RGBA,s,s,0,e.RGBA,e.UNSIGNED_BYTE,_)}}}else{var m=document.createElement("canvas");m.width=s,m.height=s;for(var g=m.getContext("2d"),w=0;w<6;w++){g.drawImage(n,0,w*(o*u),o,o*u,0,0,s,s);var v=new Uint8Array(g.getImageData(0,0,s,s).data);e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+w,0,e.RGBA,s,s,0,e.RGBA,e.UNSIGNED_BYTE,v)}}}catch(y){}e.bindTexture(e.TEXTURE_CUBE_MAP,null)}},CubeRenderer.getMaxCubeMapTextureSize=function(e,t,n){var r=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),i=t.width;if("ie"===n.browser.name&&11===parseInt(n.browser.version,10)&&!s.util.isPowerOfTwo(i))for(var o=1;o<r;o*=2)if(!(o<i)){i=o;break}return"ios"===n.os.name&&9===parseInt(n.os.version,10)&&(i=1024),"ios"===n.os.name&&8===parseInt(n.os.version,10)&&(i=512),Math.min(r,i)},CubeRenderer.getHightScale=function(e,t){var n=1;return"android"===t.os.name&&(parseFloat(t.os.version)<=4.3&&"chrome"===t.browser.name||"5.0.2"===t.os.version&&"sbrowser"===t.browser.name||"5.1.1"===t.os.version&&"sbrowser"===t.browser.name&&-1!==window.navigator.userAgent.indexOf("SM-N920")&&parseFloat(window.navigator.userAgent.split("SamsungBrowser/")[1].split(" ")[0])<4?n=768/e:"5.0"===t.os.version&&"sbrowser"===t.browser.name&&-1!==window.navigator.userAgent.indexOf("SM-G900")&&(n=1344/e)),n},CubeRenderer.hasDrawImageBug=function(e){var t=!1;return("sbrowser"===e.browser.name&&parseFloat(window.navigator.userAgent.split("SamsungBrowser/")[1].split(" ")[0])<5||"ios"===e.os.name&&parseInt(e.os.version,10)<=9)&&(t=!0),t},CubeRenderer}(a["default"]);t["default"]=u,u._VERTEX_POSITION_DATA=null,u._INDEX_DATA=null},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(12),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=function(e){function SphereRenderer(){return _classCallCheck(this,SphereRenderer),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(SphereRenderer,e),SphereRenderer.getVertexPositionData=function(){return null===SphereRenderer._VERTEX_POSITION_DATA&&SphereRenderer._initData(),SphereRenderer._VERTEX_POSITION_DATA},SphereRenderer.getIndexData=function(){return null===SphereRenderer._INDEX_DATA&&SphereRenderer._initData(),SphereRenderer._INDEX_DATA},SphereRenderer.getTextureCoordData=function(){return null===SphereRenderer._TEXTURE_COORD_DATA&&SphereRenderer._initData(),SphereRenderer._TEXTURE_COORD_DATA},SphereRenderer.getVertexShaderSource=function(){return"\n\t\t\tattribute vec3 aVertexPosition;\n\t\t\tattribute vec2 aTextureCoord;\n\t\t\tuniform mat4 uMVMatrix;\n\t\t\tuniform mat4 uPMatrix;\n\t\t\tvarying highp vec2 vTextureCoord;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t\tvTextureCoord = aTextureCoord;\n\t\t\t}"},SphereRenderer.getFragmentShaderSource=function(){return"\n\t\t\tvarying highp vec2 vTextureCoord;\n\t\t\tuniform sampler2D uSampler;\n\t\t\tvoid main(void) {\n\t\t\t\tgl_FragColor = texture2D(\n\t\t\t\t\tuSampler,\n\t\t\t\t\tvec2(vTextureCoord.s, vTextureCoord.t)\n\t\t\t\t);\n\t\t\t}"},SphereRenderer.bindTexture=function(e,t,n){if(n){var r=e.getParameter(e.MAX_TEXTURE_SIZE),i=n.width,o=n.height,a=o/i,s=document.createElement("canvas");a<=1?(s.width=Math.min(i,r),s.height=s.width*a):(s.height=Math.min(o,r),s.width=s.height/a),e.bindTexture(e.TEXTURE_2D,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0);var u=s.getContext("2d");u.drawImage(n,0,0,i,o,0,0,s.width,s.height);var c=new Uint8Array(u.getImageData(0,0,s.width,s.height).data);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,s.width,s.height,0,e.RGBA,e.UNSIGNED_BYTE,c),e.bindTexture(e.TEXTURE_2D,null)}},SphereRenderer._initData=function(){var e=[],t=[],n=[],r=void 0,i=void 0;for(r=0;r<=60;r++){var o=(r/60-.5)*Math.PI,a=Math.sin(o),s=Math.cos(o);for(i=0;i<=60;i++){var u=2*(i/60-.5)*Math.PI,c=Math.sin(u),l=Math.cos(u),h=l*s,f=a,d=c*s,p=i/60,_=r/60;if(e.push(p,_),t.push(2*h,2*f,2*d),60!==i&&60!==r){var m=61*r+i,g=m+60+1;n.push(m,g,m+1,g,g+1,m+1)}}}SphereRenderer._VERTEX_POSITION_DATA=t,SphereRenderer._TEXTURE_COORD_DATA=e,SphereRenderer._INDEX_DATA=n},SphereRenderer}(i["default"]);t["default"]=o,o._VERTEX_POSITION_DATA=null,o._TEXTURE_COORD_DATA=null,o._INDEX_DATA=null},function(e,t,n){"use strict";var r={INVALID_DEVICE:10,NO_WEBGL:11,FAIL_IMAGE_LOAD:12,FAIL_BIND_TEXTURE:13},i={RESUME:"resume",SUSPEND:"suspend",VIEW_CHANGE:"viewChange",ANIMATION_END:"animationEnd",ERROR:"error",INIT:"init"};e.exports={EVENTS:i,ERROR_TYPE:r}},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),i=n(0),o=_interopRequireDefault(i),a=n(9),s=_interopRequireDefault(a),u=n(3),c=n(28),l=_interopRequireDefault(c),h=n(30),f=_interopRequireDefault(h),d=n(29),p=_interopRequireDefault(d),_=n(1),m=n(4),g=function(e){function YawPitchControl(t){_classCallCheck(this,YawPitchControl);var n=_possibleConstructorReturn(this,e.call(this)),r=Object.assign({element:null,yaw:0,pitch:0,fov:65,showPole:!1,useZoom:!0,useKeyboard:!0,touchDirection:m.TOUCH_DIRECTION_ALL,yawRange:[-m.YAW_RANGE_HALF,m.YAW_RANGE_HALF],pitchRange:[-m.PITCH_RANGE_HALF,m.PITCH_RANGE_HALF],fovRange:[30,110],aspectRatio:1},t);return n._element=r.element,n._initialFov=r.fov,n._enabled=!1,n._isAnimating=!1,n._initAxes(r),n.option(r),n}return _inherits(YawPitchControl,e),YawPitchControl.prototype._initAxes=function(e){var t=this,n=YawPitchControl._updateYawRange(e.yawRange,e.fov,e.aspectRatio),r=YawPitchControl._updatePitchRange(e.pitchRange,e.fov,e.showPole),i=n[1]-n[0]<360?[!1,!1]:[!0,!0];this.axesPanInput=new s["default"].PanInput(this._element),this.axesWheelInput=new f["default"](this._element,{scale:4}),this.axesTiltMotionInput=u.SUPPORT_DEVICEMOTION?new p["default"](this._element):null,this.axesPinchInput=u.SUPPORT_TOUCH?new s["default"].PinchInput(this._element,{scale:-1}):null,this.axesMoveKeyInput=new l["default"](this._element,{scale:[-6,6]}),this.axes=new s["default"]({yaw:{range:n,circular:i,bounce:[0,0]},pitch:{range:r,circular:[!1,!1],bounce:[0,0]},fov:{range:e.fovRange,circular:[!1,!1],bounce:[0,0]}},{deceleration:m.MC_DECELERATION,maximumDuration:m.MC_MAXIMUM_DURATION},{yaw:e.yaw,pitch:e.pitch,fov:e.fov}).on({hold:function(e){t.trigger("hold")},change:function(e){0!==e.delta.fov&&(t._setPanScale(e.pos.fov),t._updateControlScale()),t._triggerChange()},release:function(e){0!==e.delta.fov&&(t._setPanScale(e.pos.fov),t._updateControlScale()),t._triggerChange()},animationStart:function(e){},animationEnd:function(e){t.trigger("animationEnd")}})},YawPitchControl.prototype._setPanScale=function(e){if(this._element){var t=parseInt((0,u.getComputedStyle)(this._element).height,10),n=m.MC_BIND_SCALE[0]*e/this._initialFov*m.PAN_SCALE/t;this.axesPanInput.options.scale=[n,n],this.axes.options.deceleration=m.MC_DECELERATION*e/m.MAX_FIELD_OF_VIEW}},YawPitchControl.prototype.option=function(){var e=arguments.length;if(0===e)return this._option();if(1===e&&"string"==typeof(arguments.length<=0?undefined:arguments[0]))return this._option(arguments.length<=0?undefined:arguments[0]);var t=Object.assign({},this.options),n=[];return 1===e?n=Object.keys(arguments.length<=0?undefined:arguments[0]):e>=2&&n.push(arguments.length<=0?undefined:arguments[0]),this._option.apply(this,arguments),this._applyOptions(n,t),this},YawPitchControl.prototype._option=function(e,t){if(arguments.length>=2)return this.options[e]=t,this;if("string"==typeof e)return this.options[e];if(0===arguments.length)return this.options;for(var n in e)this.options[n]=e[n];return this},YawPitchControl.prototype._applyOptions=function(e,t){if(e.some(function(e){return"showPole"===e||"fov"===e||"aspectRatio"===e})&&(this._setYawPitchRange(t),this._updateControlScale()),e.some(function(e){return"yawRange"===e||"pitchRange"===e})&&this._updateControlScale(),e.some(function(e){return"fovRange"===e})){if(!this.axes)return;var n=this.options.fovRange,r=this.axes.get().fov,i=this.axes.get().fov;_.vec2.copy(this.axes.axis.fov.range,n),i<n[0]?i=n[0]:r>n[1]&&(i=n[1]),r!==i&&(this.axes.setTo({fov:i}),this._updateControlScale())}if(e.some(function(e){return"useKeyboard"===e})){var o=this.options.useKeyboard;if(!this.axes)return;o?this.axes.connect(["yaw","pitch"],this.axesMoveKeyInput):this.axes.disconnect(this.axesMoveKeyInput)}if(e.some(function(e){return"useZoom"===e})){var a=this.options.useZoom;if(!this.axes)return;a?(this.axes.connect(["fov"],this.axesWheelInput),this.axesPinchInput&&this.axes.connect(["fov"],this.axesPinchInput)):(this.axes.disconnect(this.axesWheelInput),this.axesPinchInput&&this.axes.disconnect(this.axesPinchInput))}},YawPitchControl.prototype._setYawPitchRange=function(e){var t=e.yawRange,n=e.pitchRange,r=[],i=[],o=this.axes.get().fov,a=YawPitchControl.adjustAspectRatio(this.options.aspectRatio),s=o*a;r=this.option("yawRange"),r[1]-r[0]<s&&this.option("yawRange",t),i=this.option("pitchRange"),i[1]-i[0]<o&&this.option("pitchRange",n)},YawPitchControl.prototype._updateControlScale=function(){var e=this.options,t=this.axes.get().fov,n=YawPitchControl._updatePitchRange(e.pitchRange,t,e.showPole),r=YawPitchControl._updateYawRange(e.yawRange,t,e.aspectRatio),i=this.axes.get(),o=i.yaw,a=i.pitch;return _.vec2.copy(this.axes.axis.yaw.range,r),_.vec2.copy(this.axes.axis.pitch.range,n),this.axes.axis.yaw.circular=r[1]-r[0]<360?[!1,!1]:[!0,!0],o<r[0]?o=r[0]:o>r[1]&&(o=r[1]),a<n[0]?a=n[0]:a>n[1]&&(a=n[1]),this.axes.setTo({yaw:o,pitch:a}),this},YawPitchControl._updatePitchRange=function(e,t,n){var r=e[1]-e[0],i=t/2,o=r<180;return n&&!o?e.map(function(e){return+e.toFixed(5)}):[e[0]+i,e[1]-i].map(function(e){return+e.toFixed(5)})},YawPitchControl._updateYawRange=function(e,t,n){var r=e[1]-e[0];if(r>=360)return e.map(function(e){return+e.toFixed(5)});var i=1,o=YawPitchControl.adjustAspectRatio(n),a=t/2*o;return r>290?i=.794:r>125&&(i=.98),[e[0]*i+a,e[1]*i-a].map(function(e){return+e.toFixed(5)})},YawPitchControl.prototype._triggerChange=function(){var e=this.axes.get(),t=this.options,n={targetElement:t.element};n.yaw=e.yaw,n.pitch=e.pitch,n.fov=e.fov,this.trigger("change",n)},YawPitchControl.adjustAspectRatio=function(e){for(var t=[.52,.54,.563,.57,.584,.59,.609,.67,.702,.72,.76,.78,.82,.92,.97,1,1.07,1.14,1.19,1.25,1.32,1.38,1.4,1.43,1.53,1.62,1.76,1.77,1.86,1.96,2.26,2.3,2.6,3,5,6],n=[.51,.54,.606,.56,.628,.63,.647,.71,.736,.757,.78,.77,.8,.89,.975,1,1.07,1.1,1.15,1.18,1.22,1.27,1.3,1.33,1.39,1.45,1.54,1.55,1.58,1.62,1.72,1.82,1.92,2,2.24,2.3],r=-1,i=0;i<t.length-1;i++)if(t[i]<=e&&t[i+1]>=e){r=i;break}if(-1===r)return t[0]>e?n[0]:n[n[0].length-1];var o=t[r],a=t[r+1],s=n[r],u=n[r+1];return YawPitchControl.lerp(s,u,(e-o)/(a-o))},YawPitchControl.lerp=function(e,t,n){return e+n*(t-e)},YawPitchControl.prototype.enable=function(){return this._enabled?this:(this.axes.connect(["yaw","pitch"],this.axesPanInput),this.axesTiltMotionInput&&this.axes.connect(["yaw","pitch"],this.axesTiltMotionInput),this._applyOptions(Object.keys(this.options),this.options),this._setPanScale(this.getFov()),this._enabled=!0,this)},YawPitchControl.prototype.disable=function(e){return this._enabled?(e||this._resetOrientation(),this.axes.disconnect(),this._enabled=!1,this):this},YawPitchControl.prototype._resetOrientation=function(){var e=this.options;return this.axes.setTo({yaw:e.yaw,pitch:e.pitch,fov:e.fov}),this},YawPitchControl.prototype.lookAt=function(e,t){var n=e.yaw,r=e.pitch,i=e.fov,o=this.axes.get(),a=n===undefined?0:n-o.yaw,s=r===undefined?0:r-o.pitch,u=i===undefined?0:i-o.fov;this.axes.setBy({yaw:a,pitch:s,fov:u},t)},YawPitchControl.prototype.get=function(){return this.axes.get()},YawPitchControl.prototype.getYaw=function(){return this.axes.get().yaw},YawPitchControl.prototype.getPitch=function(){return this.axes.get().pitch},YawPitchControl.prototype.getFov=function(){return this.axes.get().fov},YawPitchControl.prototype.destroy=function(){this.axes&&this.axes.destroy(),this.axisPanInput&&this.axisPanInput.destroy(),this.axesWheelInput&&this.axesWheelInput.destroy(),this.axesTiltMotionInput&&this.axesTiltMotionInput.destroy(),this.axesPinchInput&&this.axesPinchInput.destroy(),this.axesMoveKeyInput&&this.axesMoveKeyInput.destroy()},r(YawPitchControl,null,[{key:"YAW_DELTA_MAX",get:function(){return m.YAW_DELTA_MAX}}]),YawPitchControl}(o["default"]);g.VERSION="2.0.0",t["default"]=g},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=n(1),a=n(3),s=function(e){function DeviceMotion(){_classCallCheck(this,DeviceMotion);var t=_possibleConstructorReturn(this,e.call(this));return t._onDeviceMotion=t._onDeviceMotion.bind(t),t._onDeviceOrientation=t._onDeviceOrientation.bind(t),t.isAndroid=-1!==a.window.navigator.userAgent.indexOf("Android"),t.stillGyroVec=o.vec3.create(),t.rawGyroVec=o.vec3.create(),t.adjustedGyroVec=o.vec3.create(),t._timer=null,t.lastDevicemotionTimestamp=0,t._isEnabled=!1,t.enable(),t}return _inherits(DeviceMotion,e),DeviceMotion.prototype._onDeviceOrientation=function(){var e=this;this._timer&&clearTimeout(this._timer),this._timer=setTimeout(function(){(new Date).getTime()-e.lastDevicemotionTimestamp<200&&o.vec3.copy(e.stillGyroVec,e.rawGyroVec)},200)},DeviceMotion.prototype._onDeviceMotion=function(e){0!==e.interval&&(this.isAndroid&&(o.vec3.set(this.rawGyroVec,e.rotationRate.alpha||0,e.rotationRate.beta||0,e.rotationRate.gamma||0),o.vec3.subtract(this.adjustedGyroVec,this.rawGyroVec,this.stillGyroVec),this.lastDevicemotionTimestamp=(new Date).getTime(),e.adjustedRotationRate={alpha:this.adjustedGyroVec[0],beta:this.adjustedGyroVec[1],gamma:this.adjustedGyroVec[2]}),this.trigger("devicemotion",{inputEvent:e}))},DeviceMotion.prototype.enable=function(){this.isAndroid&&a.window.addEventListener("deviceorientation",this._onDeviceOrientation),a.window.addEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!0},DeviceMotion.prototype.disable=function(){this.isAndroid&&a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!1},DeviceMotion.prototype.isEnabled=function(){return this._isEnabled},DeviceMotion}(i["default"]);t["default"]=s},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=_interopRequireDefault(r),o=n(37),a=_interopRequireDefault(o),s=n(38),u=_interopRequireDefault(s),c=n(7),l=_interopRequireDefault(c),h=n(8),f=_interopRequireDefault(h),d=n(3),p=n(1),_=n(26),m=_interopRequireDefault(_),g=.98,w=.04,v=function(e){function FusionPoseSensor(){_classCallCheck(this,FusionPoseSensor);var t=_possibleConstructorReturn(this,e.call(this));return t.deviceMotion=new m["default"],t.accelerometer=new l["default"].Vector3,t.gyroscope=new l["default"].Vector3,t._onDeviceMotionChange=t._onDeviceMotionChange.bind(t),t._onScreenOrientationChange=t._onScreenOrientationChange.bind(t),t.filter=new a["default"](g),t.posePredictor=new u["default"](w),t.filterToWorldQ=new l["default"].Quaternion,t.isFirefoxAndroid=f["default"].isFirefoxAndroid(),t.isIOS=f["default"].isIOS(),t._isEnabled=!1,t.isIOS?t.filterToWorldQ.setFromAxisAngle(new l["default"].Vector3(1,0,0),Math.PI/2):t.filterToWorldQ.setFromAxisAngle(new l["default"].Vector3(1,0,0),-Math.PI/2),t.inverseWorldToScreenQ=new l["default"].Quaternion,t.worldToScreenQ=new l["default"].Quaternion,t.originalPoseAdjustQ=new l["default"].Quaternion,t.originalPoseAdjustQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),-d.window.orientation*Math.PI/180),t._setScreenTransform(),f["default"].isLandscapeMode()&&t.filterToWorldQ.multiply(t.inverseWorldToScreenQ),t.resetQ=new l["default"].Quaternion,t.deviceMotion.on("devicemotion",t._onDeviceMotionChange),t.enable(),t}return _inherits(FusionPoseSensor,e),FusionPoseSensor.prototype.enable=function(){this.isEnabled()||(this.deviceMotion.enable(),this._isEnabled=!0,d.window.addEventListener("orientationchange",this._onScreenOrientationChange))},FusionPoseSensor.prototype.disable=function(){this.isEnabled()&&(this.deviceMotion.disable(),this._isEnabled=!1,d.window.removeEventListener("orientationchange",this._onScreenOrientationChange))},FusionPoseSensor.prototype.isEnabled=function(){return this._isEnabled},FusionPoseSensor.prototype.destroy=function(){this.disable(),this.deviceMotion=null},FusionPoseSensor.prototype._triggerChange=function(){var e=this.getOrientation();if(!this._prevOrientation)return void(this._prevOrientation=e);p.quat.equals(this._prevOrientation,e)||this.trigger("change",{quaternion:e})},FusionPoseSensor.prototype.getOrientation=function(){var e=this.filter.getOrientation(),t=this._convertFusionToPredicted(e);return t=p.quat.fromValues(t.x,t.y,t.z,t.w),p.quat.normalize(t,t)},FusionPoseSensor.prototype._convertFusionToPredicted=function(e){this.predictedQ=this.posePredictor.getPrediction(e,this.gyroscope,this.previousTimestampS);var t=new l["default"].Quaternion;return t.copy(this.filterToWorldQ),t.multiply(this.resetQ),t.multiply(this.predictedQ),t.multiply(this.worldToScreenQ),t},FusionPoseSensor.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),f["default"].isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},FusionPoseSensor.prototype._onDeviceMotionChange=function(e){var t=e.inputEvent,n=t,r=n.accelerationIncludingGravity,i=n.adjustedRotationRate||n.rotationRate,o=n.timeStamp/1e3;this.isFirefoxAndroid&&(o/=1e3),this.accelerometer.set(-r.x,-r.y,-r.z),this.gyroscope.set(i.alpha,i.beta,i.gamma),(this.isIOS||this.isFirefoxAndroid)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,o),this.filter.addGyroMeasurement(this.gyroscope,o),this._triggerChange(),this.previousTimestampS=o},FusionPoseSensor.prototype._onScreenOrientationChange=function(e){this._setScreenTransform(d.window.orientation)},FusionPoseSensor.prototype._setScreenTransform=function(){switch(this.worldToScreenQ.set(0,0,0,1),d.window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),-.5*Math.PI);break;case-90:this.worldToScreenQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),.5*Math.PI);break;case 180:this.worldToScreenQ.setFromAxisAngle(new l["default"].Vector3(0,0,1),-1*Math.PI)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},FusionPoseSensor}(i["default"]);t["default"]=v},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=n(4),a=n(5),s=function(e){function MoveKeyInput(t,n){_classCallCheck(this,MoveKeyInput);var r=_possibleConstructorReturn(this,e.call(this));return r.element=t,r.options=Object.assign({scale:[1,1],threshold:0},n),r._onKeydown=r._onKeydown.bind(r),r}return _inherits(MoveKeyInput,e),MoveKeyInput.prototype.mapAxes=function(e){this.axes=e},MoveKeyInput.prototype.connect=function(e){return this.observer?this:(this.observer=e,"0"!==this.element.getAttribute("tabindex")&&this.element.setAttribute("tabindex","0"),this._attachEvent(),this)},MoveKeyInput.prototype.disconnect=function(){return this.observer?(this.observer=null,this._dettachEvent(),this):this},MoveKeyInput.prototype.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null},MoveKeyInput.prototype._onKeydown=function(e){var t=!0,n=void 0,r=e;switch(r.keyCode){case o.KEYMAP.LEFT_ARROW:case o.KEYMAP.A:n=[-this.options.scale[0],0];break;case o.KEYMAP.RIGHT_ARROW:case o.KEYMAP.D:n=[this.options.scale[0],0];break;case o.KEYMAP.UP_ARROW:case o.KEYMAP.W:n=[0,this.options.scale[1]];break;case o.KEYMAP.DOWN_ARROW:case o.KEYMAP.S:n=[0,-this.options.scale[1]];break;default:t=!1}t&&(this.observer.change(this,e,(0,a.toAxis)(this.axes,n)),r.preventDefault())},MoveKeyInput.prototype._attachEvent=function(){this.element.addEventListener("keydown",this._onKeydown,!1)},MoveKeyInput.prototype._dettachEvent=function(){this.element.removeEventListener("keydown",this._onKeydown,!1)},MoveKeyInput}(i["default"]);t["default"]=s},function(e,t,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function getDeltaYaw(e,t){var n=u.util.getRotationDelta(e,t,u.ROTATE_CONSTANT.YAW_DELTA_BY_YAW);return u.util.getRotationDelta(e,t,u.ROTATE_CONSTANT.YAW_DELTA_BY_ROLL)*Math.sin(u.util.extractPitchFromQuat(t))+n}function getDeltaPitch(e,t){return u.util.getRotationDelta(e,t,u.ROTATE_CONSTANT.PITCH_DELTA)}t.__esModule=!0;var r=n(0),i=_interopRequireDefault(r),o=n(5),a=n(27),s=_interopRequireDefault(a),u=n(1),c=function(e){function TiltMotionInput(t,n){_classCallCheck(this,TiltMotionInput);var r=_possibleConstructorReturn(this,e.call(this));return r.element=t,r._prevQuaternion=null,r._quaternion=null,r.fusionPoseSensor=null,r.options=Object.assign({scale:1,threshold:0},n),r._onPoseChange=r._onPoseChange.bind(r),r}return _inherits(TiltMotionInput,e),TiltMotionInput.prototype.mapAxes=function(e){this.axes=e},TiltMotionInput.prototype.connect=function(e){return this.observer?this:(this.observer=e,this.fusionPoseSensor=new s["default"],this.fusionPoseSensor.enable(),this._attachEvent(),this)},TiltMotionInput.prototype.disconnect=function(){return this.observer?(this._dettachEvent(),this.fusionPoseSensor.disable(),this.fusionPoseSensor.destroy(),this.fusionPoseSensor=null,this.observer=null,this):this},TiltMotionInput.prototype.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null,this._prevQuaternion=null,this._quaternion=null},TiltMotionInput.prototype._onPoseChange=function(e){if(!this._prevQuaternion)return this._prevQuaternion=u.quat.clone(e.quaternion),void(this._quaternion=u.quat.clone(e.quaternion));u.quat.copy(this._prevQuaternion,this._quaternion),u.quat.copy(this._quaternion,e.quaternion),this.observer.change(this,e,(0,o.toAxis)(this.axes,[getDeltaYaw(this._prevQuaternion,this._quaternion),getDeltaPitch(this._prevQuaternion,this._quaternion)]))},TiltMotionInput.prototype._attachEvent=function(){this.fusionPoseSensor.on("change",this._onPoseChange)},TiltMotionInput.prototype._dettachEvent=function(){this.fusionPoseSensor.off("change",this._onPoseChange)},TiltMotionInput}(i["default"]);t["default"]=c},function(e,t,n){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var r=n(0),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o=n(5),a=function(e){function WheelInput(t,n){_classCallCheck(this,WheelInput);var r=_possibleConstructorReturn(this,e.call(this));return r.element=t,r.options=Object.assign({scale:1,threshold:0},n),r._onWheel=r._onWheel.bind(r),r}return _inherits(WheelInput,e),WheelInput.prototype.mapAxes=function(e){this.axes=e},WheelInput.prototype.connect=function(e){return this.observer?this:(this.observer=e,this._attachEvent(),this)},WheelInput.prototype.disconnect=function(){return this.observer?(this.observer=null,this._dettachEvent(),this):this},WheelInput.prototype.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null},WheelInput.prototype._onWheel=function(e){e.preventDefault(),0!==e.deltaY&&this.observer.change(this,e,(0,o.toAxis)(this.axes,[(e.deltaY<0?-1:1)*this.options.scale]))},WheelInput.prototype._attachEvent=function(){this.element.addEventListener("wheel",this._onWheel,!1)},WheelInput.prototype._dettachEvent=function(){this.element.removeEventListener("wheel",this._onWheel,!1)},WheelInput}(i["default"]);t["default"]=a},function(e,t,n){"use strict";var r=n(2),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o={};o.create=function(){var e=new i["default"].ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+h*r,e[7]=u*i+f*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=h*i-s*r,e[11]=f*i-u*r,e},o.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-h*r,e[3]=u*i-f*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+h*i,e[11]=u*r+f*i,e},o.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,h=r*s,f=i*a,d=i*s,p=i*u,_=o*a,m=o*s,g=o*u;return e[0]=1-h-p,e[1]=l+g,e[2]=f-m,e[3]=0,e[4]=l-g,e[5]=1-c-p,e[6]=d+_,e[7]=0,e[8]=f+m,e[9]=d-_,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},o.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e},e.exports=o},function(e,t,n){"use strict";var r=n(2),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o={};o.create=function(){var e=new i["default"].ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},o.clone=function(e){var t=new i["default"].ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},o.fromValues=function(e,t,n,r){var o=new i["default"].ARRAY_TYPE(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},o.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,e},o.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e},o.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e},o.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},o.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e},o.equals=function(e,t){var n=e[0],r=e[1],o=e[2],a=e[3],s=t[0],u=t[1],c=t[2],l=t[3];return Math.abs(n-s)<=i["default"].EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=i["default"].EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-c)<=i["default"].EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=i["default"].EPSILON*Math.max(1,Math.abs(a),Math.abs(l))},o.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exports=o},function(e,t,n){"use strict";var r=n(2),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o={};o.create=function(){var e=new i["default"].ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},e.exports=o},function(e,t,n){"use strict";var r=n(2),i=function(e){return e&&e.__esModule?e:{"default":e}}(r),o={};o.create=function(){var e=new i["default"].ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},o.fromValues=function(e,t,n){var r=new i["default"].ARRAY_TYPE(3);return r[0]=e,r[1]=t,r[2]=n,r},o.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},o.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},o.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},o.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},o.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,h=c*i+u*r-a*o,f=c*o+a*i-s*r,d=-a*r-s*i-u*o;return e[0]=l*c+d*-a+h*-u-f*-s,e[1]=h*c+d*-s+f*-a-l*-u,e[2]=f*c+d*-u+l*-s-h*-a,e},e.exports=o},function(e,t){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(n===setTimeout)return setTimeout(e,0);if((n===defaultSetTimout||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function runClearTimeout(e){if(r===clearTimeout)return clearTimeout(e);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}function cleanUpNextTick(){s&&o&&(s=!1,o.length?a=o.concat(a):u=-1,a.length&&drainQueue())}function drainQueue(){if(!s){var e=runTimeout(cleanUpNextTick);s=!0;for(var t=a.length;t;){for(o=a,a=[];++u<t;)o&&o[u].run();u=-1,t=a.length}o=null,s=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var n,r,i=e.exports={};!function(){try{n="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){n=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){r=defaultClearTimeout}}();var o,a=[],s=!1,u=-1;i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new Item(e,t)),1!==a.length||s||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=noop,i.addListener=noop,i.once=noop,i.off=noop,i.removeListener=noop,i.removeAllListeners=noop,i.emit=noop,i.prependListener=noop,i.prependOnceListener=noop,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(r){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){function ComplementaryFilter(e){this.kFilter=e,this.currentAccelMeasurement=new r,this.currentGyroMeasurement=new r,this.previousGyroMeasurement=new r,o.isIOS()?this.filterQ=new i.Quaternion(-1,0,0,1):this.filterQ=new i.Quaternion(1,0,0,1),this.previousFilterQ=new i.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new i.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new i.Vector3,this.measuredGravity=new i.Vector3,this.gyroIntegralQ=new i.Quaternion}var r=n(39),i=n(7),o=n(8);ComplementaryFilter.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},ComplementaryFilter.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var n=t-this.previousGyroMeasurement.timestampS;o.isTimestampDeltaValid(n)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},ComplementaryFilter.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new i.Quaternion;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var r=new i.Quaternion;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),r.inverse(),o.isDebug()&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",i.radToDeg*o.getQuaternionAngle(r),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var a=new i.Quaternion;a.copy(this.filterQ),a.multiply(r),this.filterQ.slerp(a,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},ComplementaryFilter.prototype.getOrientation=function(){return this.filterQ},ComplementaryFilter.prototype.accelToQuaternion_=function(e){var t=new i.Vector3;t.copy(e),t.normalize();var n=new i.Quaternion;return n.setFromUnitVectors(new i.Vector3(0,0,-1),t),n.inverse(),n},ComplementaryFilter.prototype.gyroToQuaternionDelta_=function(e,t){var n=new i.Quaternion,r=new i.Vector3;return r.copy(e),r.normalize(),n.setFromAxisAngle(r,e.length()*t),n},e.exports=ComplementaryFilter},function(e,t,n){function PosePredictor(e){this.predictionTimeS=e,this.previousQ=new r.Quaternion,this.previousTimestampS=null,this.deltaQ=new r.Quaternion,this.outQ=new r.Quaternion}var r=n(7),i=n(8);PosePredictor.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=n,e;var o=new r.Vector3;o.copy(t),o.normalize();var a=t.length();if(a<20*r.degToRad)return i.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(r.radToDeg*a).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var s=(this.previousTimestampS,a*this.predictionTimeS);return this.deltaQ.setFromAxisAngle(o,s),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=n,this.outQ},e.exports=PosePredictor},function(e,t){function SensorSample(e,t){this.set(e,t)}SensorSample.prototype.set=function(e,t){this.sample=e,this.timestampS=t},SensorSample.prototype.copy=function(e){this.set(e.sample,e.timestampS)},e.exports=SensorSample},function(e,t){},function(e,t,n){"use strict";t.__esModule=!0,t.VERSION=t.SpriteImage=t.SpinViewer=t.PanoViewer=t.YawPitchControl=undefined;var r=n(14),i=n(16),o=n(18);t.YawPitchControl=r.YawPitchControl,t.PanoViewer=i.PanoViewer,t.SpinViewer=o.SpinViewer,t.SpriteImage=o.SpriteImage,t.VERSION="2.0.0"}])});
//# sourceMappingURL=view360.min.js.map