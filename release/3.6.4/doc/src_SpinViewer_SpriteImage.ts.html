<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: src/SpinViewer/SpriteImage.ts | egjs::view360 - API</title>
    
    <meta name="description" content="A module used to provide coordinate based on yaw/pitch orientation. This module receives user touch action, keyboard, mouse and device orientation(if it exists) as input, then combines them and converts it to yaw/pitch coordinates." />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <link rel="canonical" href="http://naver.github.io/egjs-view360/release/latest/doc/"/>
    
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"eg.view360","disqus":"egjs","googleAnalytics":"UA-70842526-23","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"egjs::view360 - API","description":"A module used to provide coordinate based on yaw/pitch orientation. This module receives user touch action, keyboard, mouse and device orientation(if it exists) as input, then combines them and converts it to yaw/pitch coordinates.","keyword":""},"linenums":true,"link":{"canonical":"http://naver.github.io/egjs-view360/release/latest/doc/"}};
    </script>
    

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', config.googleAnalytics]);
      _gaq.push(['_trackPageview']);
    
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName">
        <a href="//naver.github.io/egjs/"><img style="width:40px; height:20px;" src="img/type_white.svg"/></a>

        <!-- Homepage link (prefer link.home than applicationName) -->
        
        <a href="//naver.github.io/egjs-view360/">view360</a>
        
    </h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
        <li class="item">
            <span class="title">
                <a href="index.html">README</a>
            </span>
        </li>
    
        <!-- Non Grouping Version -->
        
            

<li class="item" data-name="TOUCH_DIRECTION">
    <span class="title">
        <a href="TOUCH_DIRECTION.html">TOUCH_DIRECTION</a>
        
        <span class="static">static</span>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.PanoViewer.STEREO_FORMAT">
    <span class="title">
        <a href="eg.view360.PanoViewer.STEREO_FORMAT.html">eg.view360.PanoViewer.STEREO_FORMAT</a>
        
        <span class="static">static</span>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.PanoViewer.STEREO_FORMAT.LEFT_RIGHT"><a href="eg.view360.PanoViewer.STEREO_FORMAT.html#.LEFT_RIGHT">LEFT_RIGHT</a></li>
    
        <li data-name="eg.view360.PanoViewer.STEREO_FORMAT.NONE"><a href="eg.view360.PanoViewer.STEREO_FORMAT.html#.NONE">NONE</a></li>
    
        <li data-name="eg.view360.PanoViewer.STEREO_FORMAT.TOP_BOTTOM"><a href="eg.view360.PanoViewer.STEREO_FORMAT.html#.TOP_BOTTOM">TOP_BOTTOM</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.PanoViewer.PROJECTION_TYPE">
    <span class="title">
        <a href="eg.view360.PanoViewer.PROJECTION_TYPE.html">eg.view360.PanoViewer.PROJECTION_TYPE</a>
        
        <span class="static">static</span>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.PanoViewer.PROJECTION_TYPE.CUBEMAP"><a href="eg.view360.PanoViewer.PROJECTION_TYPE.html#.CUBEMAP">CUBEMAP</a></li>
    
        <li data-name="eg.view360.PanoViewer.PROJECTION_TYPE.CUBESTRIP"><a href="eg.view360.PanoViewer.PROJECTION_TYPE.html#.CUBESTRIP">CUBESTRIP</a></li>
    
        <li data-name="eg.view360.PanoViewer.PROJECTION_TYPE.EQUIRECTANGULAR"><a href="eg.view360.PanoViewer.PROJECTION_TYPE.html#.EQUIRECTANGULAR">EQUIRECTANGULAR</a></li>
    
        <li data-name="eg.view360.PanoViewer.PROJECTION_TYPE.PANORAMA"><a href="eg.view360.PanoViewer.PROJECTION_TYPE.html#.PANORAMA">PANORAMA</a></li>
    
        <li data-name="eg.view360.PanoViewer.PROJECTION_TYPE.STEREOSCOPIC_EQUI"><a href="eg.view360.PanoViewer.PROJECTION_TYPE.html#.STEREOSCOPIC_EQUI">STEREOSCOPIC_EQUI</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.PanoViewer.GYRO_MODE">
    <span class="title">
        <a href="eg.view360.PanoViewer.GYRO_MODE.html">eg.view360.PanoViewer.GYRO_MODE</a>
        
        <span class="static">static</span>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.PanoViewer.GYRO_MODE.NONE"><a href="eg.view360.PanoViewer.GYRO_MODE.html#.NONE">NONE</a></li>
    
        <li data-name="eg.view360.PanoViewer.GYRO_MODE.VR"><a href="eg.view360.PanoViewer.GYRO_MODE.html#.VR">VR</a></li>
    
        <li data-name="eg.view360.PanoViewer.GYRO_MODE.YAWPITCH"><a href="eg.view360.PanoViewer.GYRO_MODE.html#.YAWPITCH">YAWPITCH</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.PanoViewer.EVENTS">
    <span class="title">
        <a href="eg.view360.PanoViewer.EVENTS.html">eg.view360.PanoViewer.EVENTS</a>
        
        <span class="static">static</span>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.PanoViewer.EVENTS.ANIMATION_END"><a href="eg.view360.PanoViewer.EVENTS.html#.ANIMATION_END">ANIMATION_END</a></li>
    
        <li data-name="eg.view360.PanoViewer.EVENTS.ERROR"><a href="eg.view360.PanoViewer.EVENTS.html#.ERROR">ERROR</a></li>
    
        <li data-name="eg.view360.PanoViewer.EVENTS.READY"><a href="eg.view360.PanoViewer.EVENTS.html#.READY">READY</a></li>
    
        <li data-name="eg.view360.PanoViewer.EVENTS.VIEW_CHANGE"><a href="eg.view360.PanoViewer.EVENTS.html#.VIEW_CHANGE">VIEW_CHANGE</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.PanoViewer.ERROR_TYPE">
    <span class="title">
        <a href="eg.view360.PanoViewer.ERROR_TYPE.html">eg.view360.PanoViewer.ERROR_TYPE</a>
        
        <span class="static">static</span>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.PanoViewer.ERROR_TYPE.FAIL_BIND_TEXTURE"><a href="eg.view360.PanoViewer.ERROR_TYPE.html#.FAIL_BIND_TEXTURE">FAIL_BIND_TEXTURE</a></li>
    
        <li data-name="eg.view360.PanoViewer.ERROR_TYPE.FAIL_IMAGE_LOAD"><a href="eg.view360.PanoViewer.ERROR_TYPE.html#.FAIL_IMAGE_LOAD">FAIL_IMAGE_LOAD</a></li>
    
        <li data-name="eg.view360.PanoViewer.ERROR_TYPE.INVALID_DEVICE"><a href="eg.view360.PanoViewer.ERROR_TYPE.html#.INVALID_DEVICE">INVALID_DEVICE</a></li>
    
        <li data-name="eg.view360.PanoViewer.ERROR_TYPE.INVALID_RESOURCE"><a href="eg.view360.PanoViewer.ERROR_TYPE.html#.INVALID_RESOURCE">INVALID_RESOURCE</a></li>
    
        <li data-name="eg.view360.PanoViewer.ERROR_TYPE.NO_WEBGL"><a href="eg.view360.PanoViewer.ERROR_TYPE.html#.NO_WEBGL">NO_WEBGL</a></li>
    
        <li data-name="eg.view360.PanoViewer.ERROR_TYPE.RENDERING_CONTEXT_LOST"><a href="eg.view360.PanoViewer.ERROR_TYPE.html#.RENDERING_CONTEXT_LOST">RENDERING_CONTEXT_LOST</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.SpriteImage">
    <span class="title">
        <a href="eg.view360.SpriteImage.html">eg.view360.SpriteImage</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.view360.SpriteImage#gelColRow"><a href="eg.view360.SpriteImage.html#gelColRow">gelColRow</a></li>
    
        <li data-name="eg.view360.SpriteImage#getFrameIndex"><a href="eg.view360.SpriteImage.html#getFrameIndex">getFrameIndex</a></li>
    
        <li data-name="eg.view360.SpriteImage#play"><a href="eg.view360.SpriteImage.html#play">play</a></li>
    
        <li data-name="eg.view360.SpriteImage#setColRow"><a href="eg.view360.SpriteImage.html#setColRow">setColRow</a></li>
    
        <li data-name="eg.view360.SpriteImage#setFrameIndex"><a href="eg.view360.SpriteImage.html#setFrameIndex">setFrameIndex</a></li>
    
        <li data-name="eg.view360.SpriteImage#stop"><a href="eg.view360.SpriteImage.html#stop">stop</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.SpinViewer">
    <span class="title">
        <a href="eg.view360.SpinViewer.html">eg.view360.SpinViewer</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.SpinViewer.VERSION"><a href="eg.view360.SpinViewer.html#.VERSION">VERSION</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.view360.SpinViewer#getAngle"><a href="eg.view360.SpinViewer.html#getAngle">getAngle</a></li>
    
        <li data-name="eg.view360.SpinViewer#getScale"><a href="eg.view360.SpinViewer.html#getScale">getScale</a></li>
    
        <li data-name="eg.view360.SpinViewer#setScale"><a href="eg.view360.SpinViewer.html#setScale">setScale</a></li>
    
        <li data-name="eg.view360.SpinViewer#spinBy"><a href="eg.view360.SpinViewer.html#spinBy">spinBy</a></li>
    
        <li data-name="eg.view360.SpinViewer#spinTo"><a href="eg.view360.SpinViewer.html#spinTo">spinTo</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="eg.view360.PanoViewer">
    <span class="title">
        <a href="eg.view360.PanoViewer.html">eg.view360.PanoViewer</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.view360.PanoViewer.VERSION"><a href="eg.view360.PanoViewer.html#.VERSION">VERSION</a></li>
    
        <li data-name="eg.view360.PanoViewer#_yaw"><a href="eg.view360.PanoViewer.html#_yaw">_yaw</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.view360.PanoViewer.isGyroSensorAvailable"><a href="eg.view360.PanoViewer.html#.isGyroSensorAvailable">isGyroSensorAvailable</a></li>
    
        <li data-name="eg.view360.PanoViewer.isSupported"><a href="eg.view360.PanoViewer.html#.isSupported">isSupported</a></li>
    
        <li data-name="eg.view360.PanoViewer.isWebGLAvailable"><a href="eg.view360.PanoViewer.html#.isWebGLAvailable">isWebGLAvailable</a></li>
    
        <li data-name="eg.view360.PanoViewer#destroy"><a href="eg.view360.PanoViewer.html#destroy">destroy</a></li>
    
        <li data-name="eg.view360.PanoViewer#disableSensor"><a href="eg.view360.PanoViewer.html#disableSensor">disableSensor</a></li>
    
        <li data-name="eg.view360.PanoViewer#enableSensor"><a href="eg.view360.PanoViewer.html#enableSensor">enableSensor</a></li>
    
        <li data-name="eg.view360.PanoViewer#enterVR"><a href="eg.view360.PanoViewer.html#enterVR">enterVR</a></li>
    
        <li data-name="eg.view360.PanoViewer#exitVR"><a href="eg.view360.PanoViewer.html#exitVR">exitVR</a></li>
    
        <li data-name="eg.view360.PanoViewer#getFov"><a href="eg.view360.PanoViewer.html#getFov">getFov</a></li>
    
        <li data-name="eg.view360.PanoViewer#getFovRange"><a href="eg.view360.PanoViewer.html#getFovRange">getFovRange</a></li>
    
        <li data-name="eg.view360.PanoViewer#getImage"><a href="eg.view360.PanoViewer.html#getImage">getImage</a></li>
    
        <li data-name="eg.view360.PanoViewer#getPitch"><a href="eg.view360.PanoViewer.html#getPitch">getPitch</a></li>
    
        <li data-name="eg.view360.PanoViewer#getPitchRange"><a href="eg.view360.PanoViewer.html#getPitchRange">getPitchRange</a></li>
    
        <li data-name="eg.view360.PanoViewer#getProjectionType"><a href="eg.view360.PanoViewer.html#getProjectionType">getProjectionType</a></li>
    
        <li data-name="eg.view360.PanoViewer#getTouchDirection"><a href="eg.view360.PanoViewer.html#getTouchDirection">getTouchDirection</a></li>
    
        <li data-name="eg.view360.PanoViewer#getVideo"><a href="eg.view360.PanoViewer.html#getVideo">getVideo</a></li>
    
        <li data-name="eg.view360.PanoViewer#getYaw"><a href="eg.view360.PanoViewer.html#getYaw">getYaw</a></li>
    
        <li data-name="eg.view360.PanoViewer#getYawRange"><a href="eg.view360.PanoViewer.html#getYawRange">getYawRange</a></li>
    
        <li data-name="eg.view360.PanoViewer#keepUpdate"><a href="eg.view360.PanoViewer.html#keepUpdate">keepUpdate</a></li>
    
        <li data-name="eg.view360.PanoViewer#lookAt"><a href="eg.view360.PanoViewer.html#lookAt">lookAt</a></li>
    
        <li data-name="eg.view360.PanoViewer#setFovRange"><a href="eg.view360.PanoViewer.html#setFovRange">setFovRange</a></li>
    
        <li data-name="eg.view360.PanoViewer#setGyroMode"><a href="eg.view360.PanoViewer.html#setGyroMode">setGyroMode</a></li>
    
        <li data-name="eg.view360.PanoViewer#setImage"><a href="eg.view360.PanoViewer.html#setImage">setImage</a></li>
    
        <li data-name="eg.view360.PanoViewer#setPitchRange"><a href="eg.view360.PanoViewer.html#setPitchRange">setPitchRange</a></li>
    
        <li data-name="eg.view360.PanoViewer#setShowPolePoint"><a href="eg.view360.PanoViewer.html#setShowPolePoint">setShowPolePoint</a></li>
    
        <li data-name="eg.view360.PanoViewer#setTouchDirection"><a href="eg.view360.PanoViewer.html#setTouchDirection">setTouchDirection</a></li>
    
        <li data-name="eg.view360.PanoViewer#setUseKeyboard"><a href="eg.view360.PanoViewer.html#setUseKeyboard">setUseKeyboard</a></li>
    
        <li data-name="eg.view360.PanoViewer#setUseZoom"><a href="eg.view360.PanoViewer.html#setUseZoom">setUseZoom</a></li>
    
        <li data-name="eg.view360.PanoViewer#setVideo"><a href="eg.view360.PanoViewer.html#setVideo">setVideo</a></li>
    
        <li data-name="eg.view360.PanoViewer#setYawRange"><a href="eg.view360.PanoViewer.html#setYawRange">setYawRange</a></li>
    
        <li data-name="eg.view360.PanoViewer#updateViewportDimensions"><a href="eg.view360.PanoViewer.html#updateViewportDimensions">updateViewportDimensions</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
            

<li class="item" data-name="Component">
    <span class="title">
        <a href="Component.html">Component</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="Component.VERSION"><a href="Component.html#.VERSION">VERSION</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="Component#hasOn"><a href="Component.html#hasOn">hasOn</a></li>
    
        <li data-name="Component#off"><a href="Component.html#off">off</a></li>
    
        <li data-name="Component#on"><a href="Component.html#on">on</a></li>
    
        <li data-name="Component#once"><a href="Component.html#once">once</a></li>
    
        <li data-name="Component#trigger"><a href="Component.html#trigger">trigger</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    </ul>

    
</li>

        
    
    </ul>
</div>

    <div class="main">
        <h1 class="page-title" data-filename="src_SpinViewer_SpriteImage.ts.html">Source: src/SpinViewer/SpriteImage.ts</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Component, { ComponentEvent } from "@egjs/component";

import { TRANSFORM, SUPPORT_WILLCHANGE } from "../utils/browserFeature";
import { VERSION } from "../version";

import { SpinViewerOptions } from "./SpinViewer";
import { DEFAULT_IMAGE_CLASS, DEFAULT_WRAPPER_CLASS } from "./consts";

export interface SpriteImageEvent {
  /**
   * Events that occur when component loading is complete
   * @ko 컴포넌트 로딩이 완료되면 발생하는 이벤트
   * @name eg.view360.SpriteImage#load
   * @event
   * @param {Object} param The object of data to be sent to an event &lt;ko>이벤트에 전달되는 데이터 객체&lt;/ko>
   * @param {HTMLElement} param.target The target element for which to display the image &lt;ko>이미지를 보여줄 대상 엘리먼트&lt;/ko>
   * @param {HTMLElement} param.bgElement Generated background image element &lt;ko>생성된 background 이미지 엘리먼트&lt;/ko>
   *
   * @example
   *
   * sprites.on({
   *  "load" : function(evt) {
   *    console.log("load event fired - e.target", e.target, "e.bgElement", e.bgElement);
   *  }
   * });
   */
  load: {
    target: HTMLElement;
    bgElement: HTMLDivElement;
  };
  /**
   * An event that occurs when the image index is changed by the user's left / right panning
   * @ko 사용자의 좌우 Panning 에 의해 이미지 인덱스가 변경되었을때 발생하는 이벤트
   * @name eg.view360.SpriteImage#imageError
   * @event
   * @param {Object} param The object of data to be sent to an event &lt;ko>이벤트에 전달되는 데이터 객체&lt;/ko>
   * @param {String} param.imageUrl User-specified image URL &lt;ko>사용자가 지정한 이미지 URL&lt;/ko>
   *
   * @example
   *
   * sprites.on({
   *  "imageError" : function(evt) {
   *    // Error handling
   *    console.log(e.imageUrl);
   *  }
   * });
   */
  imageError: {
    imageUrl?: string;
  };
}

/**
 * @memberof eg.view360
 * @extends eg.Component
 * SpriteImage
 */
class SpriteImage extends Component&lt;SpriteImageEvent> {
  private static _createBgDiv(wrapperInContainer: HTMLDivElement | null, img: HTMLImageElement, rowCount: number, colCount: number, autoHeight: boolean) {
    const el = wrapperInContainer || document.createElement("div");

    el.style.position = "relative";
    el.style.overflow = "hidden";

    img.style.position = "absolute";
    img.style.width = `${colCount * 100}%`;
    img.style.height = `${rowCount * 100}%`;

    /** Prevent image from being dragged on IE10, IE11, Safari especially */
    img.ondragstart = () => (false); // img.style.pointerEvents = "none";
    // Use hardware accelerator if available
    if (SUPPORT_WILLCHANGE) {
      (img.style.willChange = "transform");
    }

    el.appendChild(img);

    const unitWidth = img.naturalWidth / colCount;
    const unitHeight = img.naturalHeight / rowCount;

    if (autoHeight) {
      const r = unitHeight / unitWidth;

      el.style.paddingBottom = `${r * 100}%`;
    } else {
      el.style.height = "100%";
    }

    return el;
  }

  private static _getSizeString(size) {
    if (typeof size === "number") {
      return `${size}px`;
    }

    return size;
  }

  public static VERSION = VERSION;

  private _el: HTMLElement;
  private _rowCount: number;
  private _colCount: number;
  private _totalCount: number;
  private _width: number | string;
  private _height: number | string;
  private _autoHeight: boolean;
  private _colRow: number[];
  private _image: HTMLImageElement;
  private _bg: HTMLDivElement;
  private _autoPlayReservedInfo: { interval: number; playCount: number } | null;
  private _autoPlayTimer: number;

  /**
   * @class eg.view360.SpriteImage
   * @classdesc A module that displays a single or continuous image of any one of the "sprite images". SpinViewer internally uses SpriteImage to show each frame of the sprite image.
   * @ko 스프라이트 이미지 중 임의의 한 프레임을 단발성 혹은 연속적으로 보여주는 컴포넌트입니다. SpinViewer 는 내부적으로 SpriteImage 를 사용하여 스프라이트 이미지의 각 프레임을 보여줍니다.
   * @extends eg.Component
   *
   * @param {HTMLElement} element The element to show the image &lt;ko>이미지를 보여줄 대상 요소&lt;/ko>
   * @param {Object} options The option object&lt;ko>파라미터 객체&lt;/ko>
   * @param {String} options.imageUrl The url of the sprite image &lt;ko>스프라이트 이미지의 url&lt;/ko>
   * @param {Number} [options.rowCount=1] Number of horizontal frames in the sprite image &lt;ko>스프라이트 이미지의 가로 프레임 갯수&lt;/ko>
   * @param {Number} [options.colCount=1] Number of vertical frames in the sprite image &lt;ko>스프라이트 이미지의 세로 프레임 갯수&lt;/ko>
   * @param {Number|String} [options.width="auto"] The width of the target element to show the image &lt;ko>이미지를 보여줄 대상 요소의 너비&lt;/ko>
   * @param {Number|String} [options.height="auto"] The height of the target element to show the image &lt;ko>이미지를 보여줄 대상 요소의 높이&lt;/ko>
   * @param {Boolean} [options.autoHeight=true] Whether to automatically set the height of the image area to match the original image's proportion &lt;ko>원본 이미지 비율에 맞게 이미지 영역의 높이를 자동으로 설정할지 여부&lt;/ko>
   * @param {Number[]} [options.colRow=[0, 0]] The column, row coordinates of the first frame of the sprite image (based on 0 index) &lt;ko> 스프라이트 이미지 중 처음 보여줄 프레임의 (column, row) 좌표 (0 index 기반)&lt;/ko>
   * @param {Number} [options.frameIndex=0] frameIndex specifies the index of the frame to be displayed in the "Sprite image". The frameIndex order is zero-based and indexed in Z form (left-to-right, top-to-bottom, and newline again from left to right).&lt;br>- colRow is equivalent to frameIndex. However, if colRow is specified at the same time, colRow takes precedence.&lt;ko>스프라이트 이미지 중에서 보여질 프레임의 인덱스를 지정합니다. frameIndex 순서는 0부터 시작하며 Z 형태(왼쪽에서 오른쪽, 위에서 아래, 개행 시 다시 왼쪽 부터)로 인덱싱합니다.&lt;br>- colRow 는 frameIndex 와 동일한 기능을 합니다. 단, colRow 가 동시에 지정된 경우 colRow 가 우선합니다.&lt;/ko>
   * @param {Number} [options.scale=1] Spin scale (The larger the spin, the more).&lt;ko>Spin 배율 (클 수록 더 많이 움직임)&lt;/ko>
   *
   * @support {"ie": "9+", "ch" : "latest", "ff" : "latest",  "sf" : "latest", "edge" : "latest", "ios" : "7+", "an" : "2.3+ (except 3.x)"}
   * @example
   *
   * // Initialize SpriteImage
   *
   * var el = document.getElementById("image-div");
   * var sprites = new eg.view360.SpriteImage(el, {
   * 	imageUrl: "/img/bag360.jpg", // required
   * 	rowCount: 24
   * });
   */
  public constructor(element: HTMLElement, options: Partial&lt;SpinViewerOptions> = {}) {
    super();
    const opt = options || {};

    this._el = element;
    this._rowCount = opt.rowCount || 1;
    this._colCount = opt.colCount || 1;
    this._totalCount = this._rowCount * this._colCount; // total frames
    this._width = opt.width || "auto";
    this._height = opt.height || "auto";
    this._autoHeight = opt.autoHeight != null ? opt.autoHeight : true; // If autoHeight is specified, _height will be overwritten.
    this._colRow = [0, 0];

    if (opt.colRow) {
      this._colRow = opt.colRow;
    } else if (opt.frameIndex) {
      this.setFrameIndex(opt.frameIndex);
    }

    this._el.style.width = SpriteImage._getSizeString(this._width);
    this._el.style.height = SpriteImage._getSizeString(this._height);

    const wrapperClass = opt.wrapperClass || DEFAULT_WRAPPER_CLASS;
    const imageClass = opt.imageClass || DEFAULT_IMAGE_CLASS;

    if (!opt.imageUrl) {
      setTimeout(() => {
        this.trigger(new ComponentEvent("imageError", {
          imageUrl: opt.imageUrl
        }));
      }, 0);
      return;
    }

    const imageInContainer = element.querySelector&lt;HTMLImageElement>(`.${imageClass}`);
    const wrapperInContainer = element.querySelector&lt;HTMLDivElement>(`.${wrapperClass}`);

    if (wrapperInContainer &amp;&amp; imageInContainer) {
      // Set it to invisible to prevent wrapper being resized
      imageInContainer.style.display = "none";
    }

    this._image = imageInContainer || new Image();
    /**
     * Event
     */

    const image = this._image;

    image.onload = () => {
      if (wrapperInContainer &amp;&amp; imageInContainer) {
        imageInContainer.style.display = "";
      }

      this._bg = SpriteImage._createBgDiv(
        wrapperInContainer,
        image,
        this._rowCount,
        this._colCount,
        this._autoHeight
      );
      this._el.appendChild(this._bg);
      this.setColRow(this._colRow[0], this._colRow[1]);

      this.trigger(new ComponentEvent("load", {
        target: this._el,
        bgElement: this._bg
      }));

      if (this._autoPlayReservedInfo) {
        this.play(this._autoPlayReservedInfo);
        this._autoPlayReservedInfo = null;
      }
    };

    image.onerror = () => {
      this.trigger(new ComponentEvent("imageError", {
        imageUrl: opt.imageUrl
      }));
    };

    image.src = opt.imageUrl;
  }

  /**
   * Specifies the frameIndex of the frame to be shown in the sprite image.
   * @ko 스프라이트 이미지 중 보여질 프레임의 frameIndex 값을 지정
   * @method eg.view360.SpriteImage#setFrameIndex
   * @param {Number} frameIndex frame index of a frame&lt;ko>프레임의 인덱스&lt;/ko>
   *
   * @example
   *
   * sprites.setFrameIndex(0, 1);// col = 0, row = 1
   */
  public setFrameIndex(index: number) {
    const colRow = this.toColRow(index);

    this.setColRow(colRow[0], colRow[1]);
  }

  /**
   * Returns the frameIndex of the frame to be shown in the sprite image.
   * @ko 스프라이트 이미지 중 보여지는 프레임의 index 값을 반환
   * @method eg.view360.SpriteImage#getFrameIndex
   * @return {Number} frame index &lt;ko>frame 인덱스&lt;/ko>
   *
   * @example
   *
   * var frameIndex = sprites.getFrameIndex(); // eg. frameIndex = 1
   *
   */
  public getFrameIndex() {
    return this._colRow[1] * this._colCount + this._colRow[0];
  }

  /**
   * Specifies the col and row values of the frame to be shown in the sprite image.
   * @ko 스프라이트 이미지 중 보여질 프레임의 col, row 값을 지정
   * @method eg.view360.SpriteImage#setColRow
   * @param {Number} col Column number of a frame&lt;ko>프레임의 행값&lt;/ko>
   * @param {Number} row Row number of a frame&lt;ko>프레임의 열값&lt;/ko>
   *
   * @example
   *
   * sprites.setlColRow(1, 2); // col = 1, row = 2
   */
  public setColRow(col: number, row: number) {
    if (row > this._rowCount - 1 || col > this._colCount - 1) {
      return;
    }

    if (this._image &amp;&amp; TRANSFORM) {
      // NOTE: Currently, do not apply translate3D for using layer hack. Do we need layer hack for old browser?
      this._image.style[TRANSFORM] = `translate(${-(col / this._colCount * 100)}%, ${-(row / this._rowCount * 100)}%)`;
    }

    this._colRow = [col, row];
  }

  /**
   * Returns the col and row values of the frame to be shown in the sprite image.
   * @ko 스프라이트 이미지 중 보여지는 프레임의 col, row 값을환반환
   * @method eg.view360.SpriteImage#gelColRow
   * @return {Number[]} Array containing col, row&lt;ko>col, row 정보를 담는 배열&lt;/ko>
   *
   * @example
   *
   * var colRow = sprites.getlColRow();
   * // colRow = [1, 2] - index of col is 1, index of row is 2
   *
   */
  public getColRow() {
    return this._colRow;
  }

  /**
   * Stop playing
   * @ko play 되고 있던 프레임 재생을 중지합니다.
   * @method eg.view360.SpriteImage#stop
   *
   * @example
   *
   * viewer.stop();
   *
   */
  public stop() {
    if (this._autoPlayTimer) {
      clearInterval(this._autoPlayTimer);
      this._autoPlayTimer = -1;
    }
  }

  /**
   * Switches frames sequentially in the 'interval' starting from the currently displayed frame and plays all frames by 'playCount'.
   * @ko 현재 보여지고 있는 프레임을 시작으로 'interval' 간격으로 순차적으로 프레임을 전환하며 모든 프레임을 'playCount' 만큼 재생한다.
   * @method eg.view360.SpriteImage#play
   * @param {Object} param The parameter object&lt;ko>파라미터 객체&lt;/ko>
   * @param {Number} [param.interval=1000 / totalFrameCount] Interframe Interval - in milliseconds&lt;ko>프레임간 간격 - 밀리세컨드 단위&lt;/ko>
   * @param {Number} [param.playCount=0] PlayCount = 1 in which all frames are reproduced once, and playCount = n in which all frames are repeated n times. playCount = 0 in which all frames are repeated infinitely&lt;ko>모든 프레임을 1회씩 재생한 것이 playCount = 1, 모든 프레임을 n 회 재상한 것이 playCount = n 이 된다. 0 dms 무한반복&lt;/ko>
   *
   * @example
   *
   * viewer.play({angle: 16, playCount: 1});
   *
   */
  public play({ interval, playCount } = { interval: 1000 / this._totalCount, playCount: 0 }) {
    if (!this._bg) {
      this._autoPlayReservedInfo = {interval, playCount};
      return;
    }

    if (this._autoPlayTimer) {
      clearInterval(this._autoPlayTimer);
      this._autoPlayTimer = -1;
    }

    let frameIndex = this.getFrameIndex();
    let count = 0;
    let frameCount = 0; // for checking 1 cycle

    this._autoPlayTimer = window.setInterval(() => {
      frameIndex %= this._totalCount;
      const colRow = this.toColRow(frameIndex);

      this.setColRow(colRow[0], colRow[1]);
      frameIndex++;

      // Done 1 Cycle?
      if (++frameCount === this._totalCount) {
        frameCount = 0;
        count++;
      }

      if (playCount > 0 &amp;&amp; count === playCount) {
        clearInterval(this._autoPlayTimer);
      }
    }, interval);
  }

  public toColRow(frameIndex: number) {
    const colCount = this._colCount;
    const rowCount = this._rowCount;

    if (frameIndex &lt; 0) {
      return [0, 0];
    } else if (frameIndex >= this._totalCount) {
      return [colCount - 1, rowCount - 1];
    }

    const col = frameIndex % colCount;
    const row = Math.floor(frameIndex / colCount);

    // console.log(frameIndex, col, row);
    return [col, row];
  }
}

export default SpriteImage;
</code></pre>
        </article>
    </section>






        
        <!-- disqus code -->
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="//disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <!-- // disqus code -->
        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 0.3.8</a> on Fri Dec 02 2022 17:27:40 GMT+0900 (대한민국 표준시)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/main.js"></script>
</body>
</html>
