{"version":3,"file":"view360.min.js","sources":["../src/core/View360Error.ts","../src/const/error.ts","../src/const/browser.ts","../src/const/external.ts","../src/const/internal.ts","../src/utils.ts","../src/core/Motion.ts","../src/core/CameraAnimation.ts","../src/core/Camera.ts","../src/control/input/MouseInput.ts","../src/control/input/TouchInput.ts","../src/control/input/KeyboardInput.ts","../src/control/RotateControl.ts","../src/control/input/WheelInput.ts","../src/control/input/PinchInput.ts","../src/control/ZoomControl.ts","../src/control/input/GyroInput.ts","../src/control/GyroControl.ts","../src/control/PanoControl.ts","../src/texture/Texture.ts","../src/texture/Texture2D.ts","../src/texture/TextureVideo.ts","../src/texture/TextureCube.ts","../src/core/TextureLoader.ts","../src/core/FrameAnimator.ts","../src/core/AutoResizer.ts","../src/core/Autoplay.ts","../src/core/XRManager.ts","../src/hotspot/Hotspot.ts","../src/hotspot/HotspotRenderer.ts","../src/core/VertexArrayObject.ts","../src/core/WebGLContext.ts","../src/core/WebGLRenderer.ts","../src/View360.ts","../src/core/Object3D.ts","../src/plugin/LoadingSpinner/LoadingSpinner.ts","../src/plugin/ControlBar/ControlBarItem.ts","../src/plugin/ControlBar/const.ts","../src/plugin/ControlBar/RangeControl.ts","../src/plugin/ControlBar/ProgressBar.ts","../src/plugin/ControlBar/PlayButton.ts","../src/plugin/ControlBar/VolumeControl.ts","../src/plugin/ControlBar/FullscreenButton.ts","../src/plugin/ControlBar/VideoTime.ts","../src/plugin/ControlBar/PieView.ts","../src/plugin/ControlBar/VRButton.ts","../src/plugin/ControlBar/GyroButton.ts","../src/plugin/ControlBar/AutoHide.ts","../src/plugin/ControlBar/VideoControl.ts","../src/plugin/ControlBar/ControlBar.ts","../src/projection/Projection.ts","../src/uniform/Uniform.ts","../src/uniform/UniformTextureCube.ts","../src/core/CubeTexturePainter.ts","../src/uniform/UniformCanvasCube.ts","../src/core/TriangleMesh.ts","../src/core/ShaderProgram.ts","../src/core/VertexData.ts","../src/geometry/Geometry.ts","../src/geometry/CubeGeometry.ts","../src/uniform/UniformTexture2D.ts","../src/geometry/CylinderGeometry.ts","../src/geometry/SphereGeometry.ts","../src/uniform/UniformFloat.ts","../src/geometry/PlaneGeometry.ts","../src/uniform/UniformVector4Array.ts","../src/projection/StereoEquiProjection.ts","../src/projection/CubemapProjection.ts","../src/projection/CubestripProjection.ts","../src/projection/CylindricalProjection.ts","../src/projection/EquiangularProjection.ts","../src/projection/EquirectProjection.ts","../src/projection/LittlePlanetProjection.ts","../src/cfc/utils.ts","../src/cfc/const.ts","../src/cfc/withMethods.ts","../src/index.umd.ts"],"sourcesContent":["/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n\n/**\n * Error thrown by {@link View360}\n * @ko {@link View360}이 발생시킨 에러\n * @since 4.0.0\n */\nclass View360Error extends Error {\n  /**\n   * Error code\n   * @ko 에러 코드\n   * @see ERROR_CODES\n   */\n  public code: number;\n\n  /**\n   * Create new instance of View360Error\n   * @ko View360Error의 인스턴스를 생성합니다.\n   * @param message - Error message {@ko 에러 메시지}\n   * @param code - Error code {@ko 에러 코드}\n   */\n  public constructor(message: string, code: number) {\n    super(message);\n\n    Object.setPrototypeOf(this, View360Error.prototype);\n\n    this.name = \"View360Error\";\n    this.code = code;\n  }\n}\n\nexport default View360Error;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n\n/**\n * Error codes of {@link View360Error}\n * @ko {@link View360Error}가 가질 수 있는 에러 코드 값들\n * @since 4.0.0\n */\nexport const ERROR_CODES = {\n  /**\n   * The given value's type is not expected\n   * @ko 주어진 값의 타입이 잘못되었을 경우\n   * @since 4.0.0\n   */\n  WRONG_TYPE: 0,\n  /**\n   * The given value is not a supported option\n   * @ko 잘못된 옵션을 받았을 경우\n   * @since 4.0.0\n   */\n  WRONG_OPTION: 1,\n  /**\n   * The element with given CSS selector does not exist\n   * @ko 주어진 CSS 셀렉터로 엘리먼트를 찾지 못했을 경우\n   * @since 4.0.0\n   */\n  ELEMENT_NOT_FOUND: 2,\n  /**\n   * Couldn't find canvas element inside the given container element.\n   * @ko 컨테이너 엘리먼트 내부에서 캔버스 엘리먼트를 찾지 못했을 경우\n   * @since 4.0.0\n   */\n  CANVAS_NOT_FOUND: 3,\n  /**\n   * The browser does not support WebGL\n   * @ko 브라우저가 WebGL을 지원하지 않는 경우\n   * @since 4.0.0\n   */\n  WEBGL_NOT_SUPPORTED: 4,\n  /**\n   * Failed creating canvas 2D context\n   * @ko 캔버스 2D 컨텍스트를 생성하지 못한 경우\n   * @since 4.0.0\n   */\n  FAILED_CREATE_CONTEXT_2D: 5,\n  /**\n   * `init()` is called before setting {@link View360Options#projection}\n   * @ko {@link View360Options#projection}을 설정하기 전에 `init()`이 호출된 경우\n   * @since 4.0.0\n   */\n  PROVIDE_PROJECTION_FIRST: 6,\n  /**\n   * Failed linking WebGL program. Only can be thrown when {@link View360Options#debug} is `true`.\n   * @ko WebGL 프로그램 링크에 실패한 경우. {@link View360Options#debug}를 `true`로 설정한 경우에만 발생할 수 있습니다.\n   * @since 4.0.0\n   */\n  FAILED_LINKING_PROGRAM: 7,\n  /**\n   * Arguments are not sufficient for the given property.\n   * @ko 프로퍼티에 값이 충분히 주어지지 않았을 때\n   * @since 4.0.0\n   */\n  INSUFFICIENT_ARGS: 8\n} as const;\n\nexport const MESSAGES = {\n  WRONG_TYPE: (val: any, types: string[]) => `${typeof val} is not a ${types.map(type => `\"${type}\"`).join(\" or \")}.`,\n  WRONG_OPTION: (val: any, optionName: string) => `Bad option: given \"${val}\" for option \"${optionName}\".`,\n  ELEMENT_NOT_FOUND: (query: string) => `Element with selector \"${query}\" not found.`,\n  CANVAS_NOT_FOUND: \"The canvas element was not found inside the given root element.\",\n  WEBGL_NOT_SUPPORTED: \"WebGL is not supported on this browser.\",\n  FAILED_CREATE_CONTEXT_2D: \"Failed to create canvas 2D context\",\n  PROVIDE_PROJECTION_FIRST: \"\\\"projection\\\" should be provided before initialization.\",\n  FAILED_LINKING_PROGRAM: (msg: string | null, shaderLog: string | null) => `Failed linking WebGL program - \"${msg}\\nShader compile Log: ${shaderLog}`,\n  INSUFFICIENT_ARGS: (val: any, name: string) => `Insufficient arguments: given \"${val}\" for \"${name}\".`\n};\n\nexport default {\n  CODES: ERROR_CODES,\n  MESSAGES\n};\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nexport const EVENTS = {\n  MOUSE_DOWN: \"mousedown\",\n  MOUSE_MOVE: \"mousemove\",\n  MOUSE_UP: \"mouseup\",\n  TOUCH_START: \"touchstart\",\n  TOUCH_MOVE: \"touchmove\",\n  TOUCH_END: \"touchend\",\n  WHEEL: \"wheel\",\n  RESIZE: \"resize\",\n  CONTEXT_MENU: \"contextmenu\",\n  MOUSE_ENTER: \"mouseenter\",\n  MOUSE_LEAVE: \"mouseleave\",\n  POINTER_DOWN: \"pointerdown\",\n  POINTER_MOVE: \"pointermove\",\n  POINTER_UP: \"pointerup\",\n  POINTER_CANCEL: \"pointercancel\",\n  POINTER_ENTER: \"pointerenter\",\n  POINTER_LEAVE: \"pointerleave\",\n  KEY_DOWN: \"keydown\",\n  KEY_UP: \"keyup\",\n  LOAD: \"load\",\n  ERROR: \"error\",\n  CLICK: \"click\",\n  DOUBLE_CLICK: \"dblclick\",\n  CONTEXT_CREATE_ERROR: \"webglcontextcreationerror\",\n  CONTEXT_LOST: \"webglcontextlost\",\n  CONTEXT_RESTORED: \"webglcontextrestored\",\n  DEVICE_ORIENTATION: \"deviceorientation\",\n  DEVICE_MOTION: \"devicemotion\",\n  ORIENTATION_CHANGE: \"orientationchange\",\n  VIDEO_PLAY: \"play\",\n  VIDEO_PAUSE: \"pause\",\n  VIDEO_LOADED_DATA: \"loadeddata\",\n  VIDEO_VOLUME_CHANGE: \"volumechange\",\n  VIDEO_TIME_UPDATE: \"timeupdate\",\n  VIDEO_DURATION_CHANGE: \"durationchange\",\n  VIDEO_CAN_PLAYTHROUGH: \"canplaythrough\",\n  TRANSITION_END: \"transitionend\",\n  XR_END: \"end\"\n} as const;\n\nexport const EL_DIV = \"div\";\nexport const EL_BUTTON = \"button\";\n\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\nexport enum MOUSE_BUTTON {\n  LEFT,\n  MIDDLE,\n  RIGHT\n}\n\nexport const CURSOR = {\n  GRAB: \"grab\",\n  GRABBING: \"grabbing\",\n  NONE: \"\"\n} as const;\n\nexport const KEY_DIRECTION = [\"LEFT\", \"UP\", \"RIGHT\", \"DOWN\"] as const;\nexport enum DIRECTION_KEY_CODE {\n  LEFT = 37,\n  UP = 38,\n  RIGHT = 39,\n  DOWN = 40\n}\nexport const SPACE_KEY_CODE = 32;\n\nexport const DIRECTION_KEY_NAME = {\n  LEFT: \"ArrowLeft\",\n  UP: \"ArrowUp\",\n  RIGHT: \"ArrowRight\",\n  DOWN: \"ArrowDown\"\n} as const;\nexport const SPACE_KEY_NAME = \" \";\n\nexport const FULLSCREEN_REQUEST = [\n  \"requestFullscreen\",\n  \"webkitRequestFullscreen\",\n  \"webkitRequestFullScreen\",\n  \"webkitCancelFullScreen\",\n  \"mozRequestFullScreen\",\n  \"msRequestFullscreen\"\n];\n\nexport const FULLSCREEN_ELEMENT = [\n  \"fullscreenElement\",\n  \"webkitFullscreenElement\",\n  \"webkitCurrentFullScreenElement\",\n  \"mozFullScreenElement\",\n  \"msFullscreenElement\"\n];\n\nexport const FULLSCREEN_EXIT = [\n  \"exitFullscreen\",\n  \"webkitExitFullscreen\",\n  \"webkitCancelFullScreen\",\n  \"mozCancelFullScreen\",\n  \"msExitFullscreen\"\n];\n\nexport const FULLSCREEN_CHANGE = [\n  \"fullscreenchange\",\n  \"webkitfullscreenchange\",\n  \"mozfullscreenchange\",\n  \"MSFullscreenChange\"\n];\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nexport { ERROR_CODES } from \"./error\";\n\n/**\n * Default class names\n * @ko 기본 클래스 이름들\n * @since 4.0.0\n */\nexport const DEFAULT_CLASS = {\n  CONTAINER: \"view360-container\",\n  CANVAS: \"view360-canvas\",\n  CTX_LOST: \"view360-ctx-lost\",\n  IN_VR: \"view360-vr-presenting\",\n  HOTSPOT_CONTAINER: \"view360-hotspots\",\n  HOTSPOT: \"view360-hotspot\",\n  HOTSPOT_VISIBLE: \"view360-hotspot-visible\",\n  HOTSPOT_FLIP_X: \"view360-hotspot-flip-x\",\n  HOTSPOT_FLIP_Y: \"view360-hotspot-flip-y\",\n} as const;\n\n/**\n * Event names\n * @ko 이벤트 이름들\n * @since 4.0.0\n * @example\n * ```ts\n * import View360, { EVENTS } from \"@egjs/view360\";\n *\n * const viewer = new View360(\"#el_id\");\n *\n * viewer.on(EVENTS.READY, evt => {\n *   console.log(\"View360 is ready!\");\n * });\n * ```\n */\nexport const EVENTS = {\n  READY: \"ready\",\n  LOAD_START: \"loadStart\",\n  LOAD: \"load\",\n  PROJECTION_CHANGE: \"projectionChange\",\n  RESIZE: \"resize\",\n  BEFORE_RENDER: \"beforeRender\",\n  RENDER: \"render\",\n  INPUT_START: \"inputStart\",\n  INPUT_END: \"inputEnd\",\n  VIEW_CHANGE: \"viewChange\",\n  STATIC_CLICK: \"staticClick\",\n  VR_START: \"vrStart\",\n  VR_END: \"vrEnd\"\n} as const;\n\n/**\n * Collection of predefined easing functions\n * @ko 미리 정의된 easing 함수들\n */\nexport const EASING = {\n  LINEAR: (x: number) => x,\n  SINE_WAVE: (x: number) => Math.sin(x * Math.PI * 2),\n  EASE_OUT_CUBIC: (x: number) => 1 - Math.pow(1 - x, 3),\n  EASE_OUT_BOUNCE: (x: number): number => {\n    const n1 = 7.5625;\n    const d1 = 2.75;\n\n    if (x < 1 / d1) {\n      return n1 * x * x;\n    } else if (x < 2 / d1) {\n      return n1 * (x -= 1.5 / d1) * x + 0.75;\n    } else if (x < 2.5 / d1) {\n      return n1 * (x -= 2.25 / d1) * x + 0.9375;\n    } else {\n      return n1 * (x -= 2.625 / d1) * x + 0.984375;\n    }\n  }\n} as const;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { EASING } from \"./external\";\nimport { Range } from \"../type/utils\";\n\nexport const CAMERA_EVENTS = {\n  CHANGE: \"change\",\n  ANIMATION_END: \"animationEnd\"\n} as const;\n\nexport const CONTROL_EVENTS = {\n  INPUT_START: \"inputStart\",\n  CHANGE: \"change\",\n  INPUT_END: \"inputEnd\",\n  ENABLE: \"enable\",\n  DISABLE: \"disable\",\n  STATIC_CLICK: \"staticClick\"\n} as const;\n\nexport const DEG_TO_RAD = Math.PI / 180;\nexport const RAD_TO_DEG = 180 / Math.PI;\nexport const DEFAULT_EASING = EASING.EASE_OUT_CUBIC;\nexport const DEFAULT_ANIMATION_DURATION = 300;\nexport const INFINITE_RANGE: Readonly<Range> = {\n  min: -Infinity, max: Infinity\n} as const;\nexport const DEFAULT_PITCH_RANGE: Readonly<Range> = {\n  min: -90, max: 90\n} as const;\nexport const DEFAULT_ZOOM_RANGE: Readonly<Range> = {\n  min: 0.6, max: 10\n} as const;\n\nexport enum ROTATE {\n  ZERO,\n  CW_90,\n  CCW_90,\n  CW_180\n}\n\n// Custom event name for video time change\nexport const VIDEO_TIME_CHANGE_EVENT = \"view360videotimechange\";\nexport const SVG_NAMESPACE = \"http://www.w3.org/2000/svg\";\nexport const SESSION_VR = \"immersive-vr\";\nexport const XR_REFERENCE_SPACE = \"local\";\n\nexport const EPSILON = Number.EPSILON ?? 2.220446049250313e-16;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { quat, vec3 } from \"gl-matrix\";\nimport View360Error from \"./core/View360Error\";\nimport ERROR from \"./const/error\";\nimport * as BROWSER from \"./const/browser\";\nimport { DEG_TO_RAD, RAD_TO_DEG } from \"./const/internal\";\nimport { NoBoolean } from \"./type/utils\";\n\nexport const isString = (val: any): val is string => typeof val === \"string\";\nexport const isElement = (val: any): val is Element => !!val && val.nodeType === Node.ELEMENT_NODE;\n\nexport const createElement = (className: string, tag = BROWSER.EL_DIV) => {\n  const el = document.createElement(tag);\n\n  el.classList.add(className);\n\n  return el;\n};\n\nexport const getNullableElement = (el: HTMLElement | string | null, parent?: HTMLElement): HTMLElement | null => {\n  let targetEl: HTMLElement | null = null;\n\n  if (isString(el)) {\n    const parentEl = parent ? parent : document;\n    const queryResult = parentEl.querySelector(el);\n\n    if (!queryResult) {\n      return null;\n    }\n\n    targetEl = queryResult as HTMLElement;\n  } else if (isElement(el)) {\n    targetEl = el;\n  }\n\n  return targetEl;\n};\n\nexport const getElement = (el: HTMLElement | string, parent?: HTMLElement): HTMLElement => {\n  const targetEl = getNullableElement(el, parent);\n\n  if (!targetEl) {\n    if (isString(el)) {\n      throw new View360Error(ERROR.MESSAGES.ELEMENT_NOT_FOUND(el), ERROR.CODES.ELEMENT_NOT_FOUND);\n    } else {\n      throw new View360Error(ERROR.MESSAGES.WRONG_TYPE(el, [\"HTMLElement\", \"string\"]), ERROR.CODES.WRONG_TYPE);\n    }\n  }\n\n  return targetEl;\n};\n\nexport const findCanvas = (root: HTMLElement, selector: string): HTMLCanvasElement => {\n  const canvas = root.querySelector(selector) as HTMLCanvasElement;\n\n  if (!canvas) {\n    throw new View360Error(ERROR.MESSAGES.CANVAS_NOT_FOUND, ERROR.CODES.CANVAS_NOT_FOUND);\n  }\n\n  return canvas;\n};\n\nexport const range = (end: number): number[] => {\n  if (!end || end <= 0) {\n    return [];\n  }\n\n  return Array.apply(0, Array(end)).map((undef, idx) => idx);\n};\n\nexport const clamp = (x: number, min: number, max: number) => Math.max(Math.min(x, max), min);\n\n// Linear interpolation between a and b\nexport const lerp = (a: number, b: number, t: number) => {\n  return a * (1 - t) + b * t;\n};\n\nexport const circulate = (val: number, min: number, max: number) => {\n  const size = Math.abs(max - min);\n\n  if (val < min) {\n    const offset = (min - val) % size;\n    val = max - offset;\n  } else if (val > max) {\n    const offset = (val - max) % size;\n    val = min + offset;\n  }\n\n  return val;\n};\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport const merge = (target: object, ...srcs: object[]): object => {\n  srcs.forEach(source => {\n    Object.keys(source).forEach(key => {\n      const value = source[key];\n      if (Array.isArray(target[key]) && Array.isArray(value)) {\n        target[key] = [...target[key], ...value];\n      } else {\n        target[key] = value;\n      }\n    });\n  });\n\n  return target;\n};\n\nexport const findIndex = <T>(array: T[], checker: (val: T) => boolean): number => {\n  for (let idx = 0; idx < array.length; idx++) {\n    if (checker(array[idx])) {\n      return idx;\n    }\n  }\n\n  return -1;\n};\n\nexport const getObjectOption = <T extends boolean | Partial<object>>(val?: T): NoBoolean<T> => typeof val === \"object\" ? val : {} as any;\nexport const toVerticalFov = (fovRadian: number, aspect: number) => {\n  return Math.atan(Math.tan(fovRadian * 0.5) / aspect) * 2;\n};\n\nexport const reorderCube = <T>(arr: T[], order: string, defaultOrder = \"RLUDFB\"): T[] => {\n  return defaultOrder.split(\"\")\n    .map(face => order.indexOf(face))\n    .map(index => arr[index]);\n};\n\nexport const isFullscreen = () => {\n  if (!document) return false;\n\n  for (const key of BROWSER.FULLSCREEN_ELEMENT) {\n    if (document[key]) return true;\n  }\n\n  return false;\n};\n\nexport const sensorCanBeEnabledIOS = () => {\n  return !!DeviceMotionEvent && \"requestPermission\" in DeviceMotionEvent && window.isSecureContext;\n};\n\nexport const hfovToZoom = (baseFov: number, fov: number) => {\n  const renderingWidth = Math.tan(DEG_TO_RAD * baseFov * 0.5);\n  const zoomedWidth = Math.tan(DEG_TO_RAD * fov * 0.5);\n\n  return renderingWidth / zoomedWidth;\n};\n\nexport const eulerToQuat = (out: quat, yaw: number, pitch: number, roll: number): quat => {\n  quat.identity(out);\n\n  const pitchThreshold = 0.01;\n  const pitchClamped = clamp(pitch, -90 + pitchThreshold, 90 - pitchThreshold);\n\n  quat.rotateY(out, out, yaw * DEG_TO_RAD);\n  quat.rotateX(out, out, pitchClamped * DEG_TO_RAD);\n  quat.rotateZ(out, out, roll * DEG_TO_RAD);\n\n  return out;\n};\n\n/**\n * Extract euler angles from the quaternion, except roll(z-axis rotation)\n * @hidden\n */\nexport const quatToEuler = (quaternion: quat) => {\n  const x = quaternion[0];\n  const y = quaternion[1];\n  const z = quaternion[2];\n  const w = quaternion[3];\n  const x2 = x * x;\n  const y2 = y * y;\n  const z2 = z * z;\n  const w2 = w * w;\n\n  const unit = x2 + y2 + z2 + w2;\n  const test = x * w - y * z;\n\n  let pitch: number, yaw: number;\n\n  if (test > 0.499995 * unit) {\n    // singularity at the north pole\n    pitch = Math.PI / 2;\n    yaw = 2 * Math.atan2(y, x);\n  } else if (test < -0.499995 * unit) {\n    // singularity at the south pole\n    pitch = -Math.PI / 2;\n    yaw = -2 * Math.atan2(y, x);\n  } else {\n    const view = vec3.fromValues(0, 0, 1);\n    const up = vec3.fromValues(0, 1, 0);\n\n    vec3.transformQuat(view, view, quaternion);\n    vec3.transformQuat(up, up, quaternion);\n\n    const viewXZ = Math.sqrt(view[0] * view[0] + view[2] * view[2]);\n\n    pitch = Math.atan2(-view[1], viewXZ);\n    yaw = Math.atan2(view[0], view[2]);\n  }\n\n  return {\n    pitch: clamp(pitch * RAD_TO_DEG, -90, 90),\n    yaw: circulate(yaw * RAD_TO_DEG, 0, 360)\n  };\n};\n","/*\n * Copyright (c) 2020 NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n\nimport { clamp, lerp, circulate } from \"../utils\";\nimport { Range } from \"../type/utils\";\nimport { DEFAULT_ANIMATION_DURATION, DEFAULT_EASING } from \"../const/internal\";\n\n/**\n * Interpolator between two values with duration\n * @ko 특정 시간동안 두 값을 보간해주는 보간기\n * @since 4.0.0\n */\nclass Motion {\n  // Options\n  private _duration: number;\n  private _loop: boolean;\n  private _range: Range;\n  private _easing: (x: number) => number;\n\n  // Internal states\n  private _progress: number;\n  private _val: number;\n  private _start: number;\n  private _end: number;\n  private _activated: boolean;\n\n  /**\n   * Current interpolated value\n   * @ko 현재 보간된 값\n   * @since 4.0.0\n   */\n  public get val() { return this._val; }\n  /**\n   * Start(from) value of interpolation\n   * @ko 보간 시작 값\n   * @since 4.0.0\n   */\n  public get start() { return this._start; }\n  /**\n   * End(to) value of interpolation\n   * @ko 보간 끝 값\n   * @since 4.0.0\n   */\n  public get end() { return this._end; }\n  /**\n   * Interpolation progress value (0 ~ 1)\n   * @ko 현재 보간 진행정도 (0 ~ 1)\n   * @since 4.0.0\n   */\n  public get progress() { return this._progress; }\n  /**\n   * Whether the interpolation is in active state.\n   * @ko 보간 진행중인지 여부. `true`일 경우 보간이 진행중입니다.\n   * @since 4.0.0\n   */\n  public get activated() { return this._activated; }\n\n  /**\n   * Duration of the interpolation\n   * @ko 보간할 시간\n   * @since 4.0.0\n   */\n  public get duration() { return this._duration; }\n  public set duration(val: number) { this._duration = val; }\n\n  /**\n   * Whether to loop interpolation on finish\n   * @ko 보간이 끝난 이후에 다시 시작할지 여부\n   * @since 4.0.0\n   */\n  public get loop() { return this._loop; }\n  public set loop(val: boolean) { this._loop = val; }\n\n  /**\n   * Range of the interpolation\n   * @ko 보간 범위\n   * @since 4.0.0\n   */\n  public get range() { return this._range; }\n\n  /**\n   * Easing function of the interpolation\n   * @ko 보간에 사용되는 easing function\n   * @since 4.0.0\n   */\n  public get easing() { return this._easing; }\n  public set easing(val: (x: number) => number) { this._easing = val; }\n\n  /**\n   * Create new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options Options {@ko 옵션들}\n   * @param options.duration Duration of the interpolation {@ko 보간할 시간}\n   * @param options.loop Whether to loop interpolation on finish {@ko 보간이 끝난 이후에 다시 시작할지 여부}\n   * @param options.range Range of the interpolation {@ko 보간 범위}\n   * @param options.loop Easing function of the interpolation {@ko 보간에 사용되는 easing function}\n   */\n  public constructor({\n    duration = DEFAULT_ANIMATION_DURATION,\n    loop = false,\n    range = { min: 0, max: 1 },\n    easing = DEFAULT_EASING\n  } = {}) {\n    this._duration = duration;\n    this._loop = loop;\n    this._range = range;\n    this._easing = easing;\n    this._activated = false;\n    this.reset(0);\n  }\n\n  /**\n   * Update motion and progress it by given deltaTime\n   * @ko 주어진 deltaTime만큼 보간을 진행합니다.\n   * @param deltaTime - number of milisec to update motion {@ko 보간을 진행할 시간, 밀리초 단위}\n   * @returns Difference(delta) of the value from the last update. {@ko 지난 업데이트 이후의 값 변화량}\n   * @since 4.0.0\n   */\n  public update(deltaTime: number): number {\n    if (!this._activated) {\n      this._val = this._end;\n      return 0;\n    }\n\n    const start = this._start;\n    const end = this._end;\n    const duration = this._duration;\n    const prev = this._val;\n    const loop = this._loop;\n\n    const nextProgress = this._progress + deltaTime / duration;\n\n    this._progress = loop\n      ? circulate(nextProgress, 0, 1)\n      : clamp(nextProgress, 0, 1);\n\n    const easedProgress = this._easing(this._progress);\n    this._val = lerp(start, end, easedProgress);\n\n    if (!loop && this._progress >= 1) {\n      this._activated = false;\n    }\n\n    return this._val - prev;\n  }\n\n  /**\n   * Set `start`, `end` to the given value and set `progress` to 0.\n   * @ko 주어진 값으로 시작 지점, 끝 지점을 초기화하고 progress를 0으로 세팅합니다.\n   * @param defaultVal - Value to reset {@ko 초기화할 값}\n   * @since 4.0.0\n   */\n  public reset(defaultVal: number): void {\n    const range = this._range;\n    const val = clamp(defaultVal, range.min, range.max);\n    this._start = val;\n    this._end = val;\n    this._val = val;\n    this._progress = 0;\n    this._activated = false;\n  }\n\n  /**\n   * Add delta to start & end and current value.\n   * @ko 현재 & 끝 및 현재 값에 주어진 값을 더합니다.\n   * @param delta - Delta value to add {@ko 추가할 값}\n   */\n  public add(delta: number) {\n    const range = this._range;\n\n    this._start = clamp(this._start + delta, range.min, range.max);\n    this._end = clamp(this._end + delta, range.min, range.max);\n    this._val = clamp(this._val + delta, range.min, range.max);\n  }\n\n  /**\n   * Set current value to start, and end to current value + delta, then reset progress to 0.\n   * @ko 현재 값을 시작 지점으로, 그에서 delta만큼 추가된 값을 끝점으로 하고 progress를 0으로 갱신합니다.\n   * @param delta - Delta value to add {@ko 추가할 값}\n   */\n  public setNewEndByDelta(delta: number): void {\n    const range = this._range;\n\n    this._start = this._val;\n    this._end = clamp(this._end + delta, range.min, range.max);\n    this._progress = 0;\n    this._activated = true;\n  }\n\n  /**\n   * Set new range of the interpolation.\n   * @ko 보간의 범위를 변경합니다.\n   * @param min - New minimum range {@ko 변경할 범위의 최소값}\n   * @param max - New maximum range {@ko 변경할 범위의 최대값}\n   */\n  public setRange(min: number, max: number) {\n    this._start = clamp(this._start, min, max);\n    this._end = clamp(this._end, min, max);\n    this._range = { min, max };\n  }\n}\n\nexport default Motion;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { quat } from \"gl-matrix\";\nimport Camera from \"./Camera\";\nimport Motion from \"./Motion\";\nimport { DEFAULT_ANIMATION_DURATION, DEFAULT_EASING } from \"../const/internal\";\nimport { lerp } from \"../utils\";\n\ntype CameraPose = {\n  rotation: quat;\n  zoom: number;\n}\n\n/**\n * Animation of the {@link Camera}\n * @internal\n * @ko {@link Camera}의 애니메이션\n * @since 4.0.0\n */\nclass CameraAnimation {\n  // Options\n  private _camera: Camera;\n  private _from: CameraPose;\n  private _to: CameraPose;\n\n  // Internal values\n  private _motion: Motion;\n  private _finishPromise: Promise<void>;\n  private _finish: () => void;\n\n  /**\n   * Duration of the animation\n   * @ko 애니메이션 재생시간\n   * @since 4.0.0\n   */\n  public get duration() { return this._motion.duration; }\n  public set duration(val: number) { this._motion.duration = val; }\n  /**\n   * Easing function of the animation\n   * @ko 애니메이션의 easing function\n   * @since 4.0.0\n   */\n  public get easing() { return this._motion.easing; }\n  public set easing(val: (x: number) => number) { this._motion.easing = val; }\n\n  /**\n   * Create new instance\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param camera - Camera to animate {@ko 애니메이션을 적용할 카메라}\n   * @param from - Start pose {@ko 애니메이션이 시작 시점의 카메라의 회전 및 줌}\n   * @param to - End pose {@ko 애니메이션이 끝났을 때 카메라의 회전 및 줌}\n   * @param options - Options {@ko 옵션들}\n   * @param options.duration - Animation duration {@ko 애니메이션 재생 시간}\n   * @param options.easing - Animation easing function {@ko 애니메이션 easing function}\n   */\n  public constructor(camera: Camera, from: CameraPose, to: CameraPose, {\n    duration = DEFAULT_ANIMATION_DURATION,\n    easing = DEFAULT_EASING\n  } = {}) {\n    this._camera = camera;\n    this._motion = new Motion({ duration, easing, range: { min: 0, max: 1 } });\n    this._from = from;\n    this._to = to;\n    this._finishPromise = new Promise(resolve => {\n      this._finish = resolve as () => void;\n    });\n\n    // Enable motion\n    this._motion.setNewEndByDelta(1);\n  }\n\n  /**\n   * Return a promise that resolved on animation end.\n   * @ko 애니메이션 재생이 끝났을 때 resolve되는 Promise를 반환합니다.\n   * @since 4.0.0\n   */\n  public getFinishPromise() {\n    return this._finishPromise;\n  }\n\n  /**\n   * Update animation by given deltaTime.\n   * @ko 주어진 시간만큼 애니메이션을 업데이트합니다.\n   * @param deltaTime Number of milisec to update {@ko 업데이트할 시간, 밀리초 단위}\n   * @since 4.0.0\n   */\n  public update(deltaTime: number): void {\n    const camera = this._camera;\n    const from = this._from;\n    const to = this._to;\n    const motion = this._motion;\n    motion.update(deltaTime);\n\n    // Progress that easing is applied\n    const progress = motion.val;\n    const rotation = quat.create();\n    const zoom = lerp(from.zoom, to.zoom, progress);\n\n    quat.slerp(rotation, from.rotation, to.rotation, progress);\n    camera.rotate(rotation, zoom);\n\n    if (progress >= 1) {\n      this._finish();\n    }\n  }\n}\n\nexport default CameraAnimation;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport { mat4, quat, vec3 } from \"gl-matrix\";\nimport CameraAnimation from \"./CameraAnimation\";\nimport {\n  CAMERA_EVENTS,\n  DEG_TO_RAD,\n  INFINITE_RANGE,\n  DEFAULT_PITCH_RANGE,\n  RAD_TO_DEG,\n  DEFAULT_ZOOM_RANGE,\n  DEFAULT_EASING,\n  EPSILON\n} from \"../const/internal\";\nimport {\n  circulate,\n  clamp,\n  eulerToQuat,\n  quatToEuler,\n  toVerticalFov\n} from \"../utils\";\nimport { Range } from \"../type/utils\";\n\n/**\n * Events that {@link Camera} can trigger\n * @ko {@link Camera}가 트리거할 수 있는 이벤트들\n * @since 4.0.0\n */\nexport interface CameraEvents {\n  /**\n   * An event that fires when camera's animation stops\n   * @ko 카메라 애니메이션이 멈췄을 때 트리거되는 이벤트\n   * @eventName animationEnd\n   * @eventOf Camera\n   * @version 4.0.0\n   */\n  [CAMERA_EVENTS.ANIMATION_END]: {\n    animation: CameraAnimation\n  };\n}\n\n/**\n * Options for {@link Camera}\n * @ko {@link Camera}용 옵션들\n * @since 4.0.0\n */\nexport interface CameraOptions {\n  /**\n   * @copy View360#initialYaw\n   */\n  initialYaw: number;\n  /**\n   * @copy View360#initialPitch\n   */\n  initialPitch: number;\n  /**\n   * @copy View360#initialZoom\n   */\n  initialZoom: number;\n  /**\n   * @copy View360#yawRange\n   */\n  yawRange: Range | null;\n  /**\n   * @copy View360#pitchRange\n   */\n  pitchRange: Range | null;\n  /**\n   * @copy View360#zoomRange\n   */\n  zoomRange: Range | null;\n  /**\n   * @copy View360#fov\n   */\n  fov: number;\n}\n\n/**\n * Camera for View360\n * @ko View360용 카메라 구현체\n * @version 4.0.0\n */\nclass Camera extends Component<CameraEvents> {\n  /**\n   * Current yaw(y-axis rotation) value\n   * @ko 현재 yaw(y축 회전) 값\n   * @since 4.0.0\n   */\n  public yaw: number;\n  /**\n   * Current pitch(x-axis rotation) value\n   * @ko 현재 pitch(x축 회전) 값\n   * @since 4.0.0\n   */\n  public pitch: number;\n  /**\n   * Current zoom value\n   * @ko 현재 줌 값\n   * @since 4.0.0\n   */\n  public zoom: number;\n\n  /**\n   * @copy View360#initialYaw\n   */\n  public initialYaw: number;\n  /**\n   * @copy View360#initialPitch\n   */\n  public initialPitch: number;\n  /**\n   * @copy View360#initialPitch\n   */\n  public initialZoom: number;\n  /**\n   * @hidden\n   * TODO: Please add comment for this when `rollOffset` is added\n   */\n  public rollOffset: number;\n\n  /**\n   * Current camera quaternion\n   * @ko 현재 회전을 나타내는 quaternion 값\n   * @since 4.0.0\n   * @internal\n   */\n  public quaternion: quat;\n  /**\n   * Current camera position\n   * @ko 현재 카메라 위치 좌표\n   * @since 4.0.0\n   * @internal\n   */\n  public position: vec3;\n  /**\n   * Active camera animation, `null` if there isn't.\n   * @ko 현재 활성화된 카메라 애니메이션, 없을 경우 `null`값을 가집니다.\n   * @since 4.0.0\n   */\n  public animation: CameraAnimation | null;\n  /**\n   * Camera's view matrix\n   * @ko 카메라의 뷰 변환 행렬\n   * @internal\n   * @since 4.0.0\n   */\n  public viewMatrix: mat4;\n  /**\n   * Camera's projection matrix\n   * @ko 카메라의 프로젝션 변환 행렬\n   * @internal\n   * @since 4.0.0\n   */\n  public projectionMatrix: mat4;\n\n  /**\n   * Camera's horizontal FOV(Field of View) value\n   * @ko 카메라의 수평 FOV(Field of View) 값\n   * @internal\n   * @since 4.0.0\n   */\n  public fov: number;\n\n  private _initialYawRange: Range | null;\n  private _initialPitchRange: Range | null;\n  private _initialZoomRange: Range | null;\n\n  private _yawRange: Range | null;\n  private _pitchRange: Range | null;\n  private _zoomRange: Range | null;\n\n  private _up: vec3;\n  private _aspect: number;\n  private _changed: boolean;\n  private _maxRenderHeight: number;\n\n  /**\n   * Camera's width / height ratio\n   * @ko 카메라의 가로 / 세로 비율\n   * @readonly\n   */\n  public get aspect() { return this._aspect; }\n  /**\n   * Whether the camera's rotation changed from the last frame.\n   * @ko 마지막 프레임 이후로 카메라의 회전값이 변경되었는지 나타내는 플래그.\n   * @readonly\n   */\n  public get changed() { return this._changed; }\n  /**\n   * @copy View360#yawRange\n   */\n  public get yawRange() { return this._initialYawRange; }\n  public set yawRange(val: Range | null) {\n    this._initialYawRange = val;\n  }\n  /**\n   * @copy View360#pitchRange\n   */\n  public get pitchRange() { return this._initialPitchRange; }\n  public set pitchRange(val: Range | null) {\n    this._initialPitchRange = val;\n  }\n  /**\n   * @copy View360#zoomRange\n   */\n  public get zoomRange() { return this._initialZoomRange; }\n  public set zoomRange(val: Range | null) {\n    this._initialZoomRange = val;\n  }\n\n  /**\n   * Create new instance of Camera\n   * @param options - Camera options {@ko 카메라 옵션들}\n   */\n  public constructor({\n    initialYaw,\n    initialPitch,\n    initialZoom,\n    yawRange,\n    pitchRange,\n    zoomRange,\n    fov\n  }: CameraOptions) {\n    super();\n\n    this.yaw = initialYaw;\n    this.pitch = initialPitch;\n    this.zoom = initialZoom;\n    this.rollOffset = 0;\n\n    this.initialYaw = initialYaw;\n    this.initialPitch = initialPitch;\n    this.initialZoom = initialZoom;\n\n    this.position = vec3.create();\n    this.animation = null;\n\n    this._up = vec3.fromValues(0, 1, 0);\n    this._aspect = 1;\n\n    this._initialYawRange = yawRange;\n    this._initialPitchRange = pitchRange;\n    this._initialZoomRange = zoomRange;\n\n    this._yawRange = yawRange;\n    this._pitchRange = pitchRange;\n    this._zoomRange = zoomRange;\n\n    this.quaternion = quat.create();\n    this._updateQuaternion();\n\n    this.viewMatrix = mat4.create();\n    this.projectionMatrix = mat4.create();\n    this.fov = fov;\n\n    this._maxRenderHeight = -1;\n  }\n\n  /**\n   * Destroy instance and detach all event listeners\n   * @ko 인스턴스를 삭제하고 모든 이벤트 리스너를 삭제합니다.\n   * @since 4.0.0\n   */\n  public destroy() {\n    this.off();\n  }\n\n  /**\n   * Refresh internal size value.\n   * @ko 내부 크기값을 갱신합니다.\n   * @param width - New width {@ko 변경된 너비값}\n   * @param height - New height {@ko 변경된 높이값}\n   * @since 4.0.0\n   */\n  public resize(width: number, height: number) {\n    const prevAspect = this._aspect;\n\n    this._aspect = width / height;\n\n    if (this._aspect !== prevAspect) {\n      this.updateMatrix();\n    }\n  }\n\n  /**\n   * Change camera's rotation with euler values.\n   * @ko 카메라 회전을 오일러 각 방향으로 변경합니다.\n   * @param rotation - Rotation values {@ko 회전 값}\n   * @param rotation.yaw - yaw(y-axis rotation) to look at {@ko 바라볼 yaw(y축 회전) 값}\n   * @param rotation.pitch - pitch(x-axis rotation) to look at {@ko 바라볼 pitch(x축 회전) 값}\n   * @param rotation.zoom - zoom value to apply {@ko 적용할 카메라 줌 값}\n   * @since 4.0.0\n   */\n  public lookAt({\n    yaw = this.yaw,\n    pitch = this.pitch,\n    zoom = this.zoom\n  }: Partial<{\n    yaw: number;\n    pitch: number;\n    zoom: number;\n  }>) {\n    const prevQuaternion = quat.clone(this.quaternion);\n    const prevZoom = this.zoom;\n\n    this.yaw = circulate(yaw, 0, 360);\n    this.pitch = clamp(pitch, -90, 90);\n    this.zoom = zoom;\n\n    this._updateQuaternion();\n\n    const zoomDiff = Math.abs(zoom - prevZoom);\n\n    if (\n      !quat.equals(this.quaternion, prevQuaternion)\n      || zoomDiff >= EPSILON * 10 // ignore small changes\n    ) {\n      this.updateMatrix();\n    }\n  }\n\n  /**\n   * Change camera's rotation with quaternion.\n   * @ko 카메라 회전을 Quaternion을 이용해서 변경합니다.\n   * @param rotation - Quaternion to apply {@ko 적용할 Quaternion}\n   * @param zoom - zoom value to apply {@ko 적용할 카메라 줌 값}\n   * @since 4.0.0\n   */\n  public rotate(rotation: quat, zoom: number = this.zoom) {\n    const normalized = quat.normalize(quat.create(), rotation);\n    const isSameRotation = quat.equals(this.quaternion, normalized);\n    quat.copy(this.quaternion, normalized);\n\n    const prevZoom = this.zoom;\n    const { yaw, pitch } = quatToEuler(normalized);\n\n    this.yaw = yaw;\n    this.pitch = pitch;\n    this.zoom = zoom;\n\n    const zoomDiff = Math.abs(zoom - prevZoom);\n\n    if (!isSameRotation || zoomDiff >= EPSILON * 10) {\n      this.updateMatrix();\n    }\n  }\n\n  /**\n   * Change camera's rotation to given euler values by the given duration.\n   * @ko 카메라를 주어진 방향으로 주어진 시간동안 서서히 이동시킵니다.\n   * @param options - Animation parameters {@ko 애니메이션 패러미터}\n   * @param options.yaw - yaw(y-axis rotation) to look at {@ko 바라볼 yaw(y축 회전) 값}\n   * @param options.pitch - pitch(x-axis rotation) to look at {@ko 바라볼 pitch(x축 회전) 값}\n   * @param options.zoom - zoom value to apply {@ko 적용할 카메라 줌 값}\n   * @param options.duration - Duration of the animation {@ko 애니메이션 시간}\n   * @param options.easing - Easing function for the animation {@ko 애니메이션에 적용할 easing function}\n   */\n  public async animateTo({\n    yaw = this.yaw,\n    pitch = this.pitch,\n    zoom = this.zoom,\n    duration = 0,\n    easing = DEFAULT_EASING\n  }: Partial<{\n    yaw: number;\n    pitch: number;\n    zoom: number;\n    duration: number;\n    easing: (x: number) => number;\n  }> = {}): Promise<void> {\n    if (\n      this.yaw === yaw\n      && this.pitch === pitch\n      && this.zoom === zoom\n    ) return;\n\n    const from = {\n      rotation: quat.clone(this.quaternion),\n      zoom: this.zoom\n    };\n    const to = {\n      rotation: eulerToQuat(quat.create(), yaw, pitch, this.rollOffset),\n      zoom\n    };\n\n    const animation = new CameraAnimation(this, from, to, {\n      duration,\n      easing\n    });\n    const finishPromise = animation.getFinishPromise();\n\n    this.animation = animation;\n    finishPromise.then(() => {\n      this.animation = null;\n      this.trigger(CAMERA_EVENTS.ANIMATION_END, { animation });\n    });\n\n    return finishPromise;\n  }\n\n  /**\n   * @hidden\n   */\n  public restrictYawRange(min: number, max: number) {\n    this._yawRange = { min, max };\n  }\n\n  /**\n   * @hidden\n   */\n  public restrictPitchRange(min: number, max: number) {\n    this._pitchRange = { min, max };\n  }\n\n  /**\n   * @hidden\n   */\n  public restrictZoomRange(min: number, max: number) {\n    this._zoomRange = { min, max };\n  }\n\n  /**\n   * @hidden\n   */\n  public restrictRenderHeight(height: number) {\n    this._maxRenderHeight = height;\n  }\n\n  /**\n   * @hidden\n   */\n  public resetRange() {\n    this._yawRange = this._initialYawRange;\n    this._pitchRange = this._initialPitchRange;\n    this._zoomRange = this._initialZoomRange;\n    this._maxRenderHeight = -1;\n  }\n\n  /**\n   * Get actual yaw range by the given zoom value.\n   * @ko 주어진 zoom 값에 대한 실제 yaw 범위값을 반환합니다.\n   * @since 4.0.0\n   */\n  public getYawRange(zoom: number) {\n    const yawLimit = this._yawRange;\n    const maxRenderHeight = this._maxRenderHeight;\n    if (!yawLimit) return INFINITE_RANGE;\n\n    const halfHFov = this.getHorizontalFov(zoom) * 0.5;\n    let minYaw = yawLimit.min;\n    let maxYaw = yawLimit.max;\n\n    if (maxRenderHeight > 0) {\n      const halfVFovRad = toVerticalFov(halfHFov * DEG_TO_RAD, this._aspect);\n      const h = maxRenderHeight * 0.5;\n      const t = Math.tan(halfVFovRad);\n      const d = Math.sqrt((1 + h * h) / (1 + t * t));\n      const theta = Math.atan(Math.tan(halfHFov * DEG_TO_RAD) * d) * RAD_TO_DEG;\n\n      minYaw = yawLimit.min + theta;\n      maxYaw = yawLimit.max - theta;\n    }\n\n    if (minYaw > maxYaw) {\n      minYaw = 0;\n      maxYaw = 0;\n    }\n\n    return {\n      min: minYaw,\n      max: maxYaw\n    };\n  }\n\n  /**\n   * Get actual pitch range by the given zoom value.\n   * @ko 주어진 zoom 값에 대한 실제 pitch 범위값을 반환합니다.\n   * @since 4.0.0\n   */\n  public getPitchRange(zoom: number) {\n    const pitchLimit = this._pitchRange;\n    const maxRenderHeight = this._maxRenderHeight;\n\n    if (!pitchLimit) return DEFAULT_PITCH_RANGE;\n\n    let minPitch = pitchLimit.min;\n    let maxPitch = pitchLimit.max;\n\n    if (maxRenderHeight > 0) {\n      const halfVFov = this.getVerticalFov(zoom) * 0.5;\n\n      minPitch = pitchLimit.min + halfVFov;\n      maxPitch = pitchLimit.max - halfVFov;\n    }\n\n    if (minPitch > maxPitch) {\n      minPitch = 0;\n      maxPitch = 0;\n    }\n\n    return {\n      min: Math.max(minPitch, -90),\n      max: Math.min(maxPitch, 90)\n    };\n  }\n\n  /**\n   * Get actual zoom range in fov degrees.\n   * @ko 실제 줌 범위를 fov각의 범위로 반환합니다.\n   * @since 4.0.0\n   */\n  public getZoomRange() {\n    const limit = this._zoomRange ?? DEFAULT_ZOOM_RANGE;\n\n    // max (zoom in) -> minimum fov\n    const minFov = this.getHorizontalFov(limit.max);\n    const maxFov = this.getHorizontalFov(limit.min);\n    const currentFov = this.getHorizontalFov(this.zoom);\n\n    return {\n      min: Math.max(minFov, 1),\n      max: Math.min(maxFov, 180),\n      current: currentFov\n    };\n  }\n\n  /**\n   * Return horizontal fov value when the given zoom is applied. (in degrees, °)\n   * @ko 주어진 zoom 값이 적용되었을 때의 수평 fov값을 반환합니다. (도 단위, °)\n   * @returns Zoomed horizontal FOV {@ko 줌이 적용된 수평 fov값}\n   * @since 4.0.0\n   */\n  public getHorizontalFov(zoom = this.zoom) {\n    return this._getZoomedHorizontalFov(zoom) * RAD_TO_DEG;\n  }\n\n  /**\n   * Return vertical fov value when the given zoom is applied. (in degrees, °)\n   * @ko 주어진 zoom 값이 적용되었을 때의 수직 fov값을 반환합니다. (도 단위, °)\n   * @returns Zoomed vertical FOV {@ko 줌이 적용된 수직 fov값}\n   * @since 4.0.0\n   */\n  public getVerticalFov(zoom = this.zoom) {\n    const aspect = this._aspect;\n    const hFov = this._getZoomedHorizontalFov(zoom); // In radians\n    const vFov = toVerticalFov(hFov, aspect);\n\n    return vFov * RAD_TO_DEG;\n  }\n\n  /**\n   * Calculate zoom value for the given fov.\n   * @ko 주어진 fov값을 zoom값으로 변환합니다.\n   * @param fov horizontal fov (in degrees, °) {@ko 수평 fov 값 (도 단위, °)}\n   * @since 4.0.0\n   */\n  public fovToZoom(fov: number) {\n    const baseFov = this.fov;\n    const renderingWidth = Math.tan(DEG_TO_RAD * baseFov * 0.5);\n    const zoomedWidth = Math.tan(DEG_TO_RAD * fov * 0.5);\n\n    return renderingWidth / zoomedWidth;\n  }\n\n  /**\n   * Update inner matrixes.\n   * @ko 내부 행렬들을 업데이트합니다.\n   * @internal\n   * @since 4.0.0\n   */\n  public updateMatrix() {\n    const up = this._up;\n    const aspect = this._aspect;\n    const viewMatrix = this.viewMatrix;\n    const projMatrix = this.projectionMatrix;\n    const position = this.position;\n    const rotation = this.quaternion;\n\n    const upDir = vec3.create();\n    const viewDir = vec3.fromValues(0, 0, -1);\n    vec3.transformQuat(viewDir, viewDir, rotation);\n    vec3.transformQuat(upDir, up, rotation);\n\n    const hFov = this._getZoomedHorizontalFov(); // In radians\n    const vFov = toVerticalFov(hFov, aspect);\n\n    mat4.lookAt(viewMatrix, position, viewDir, upDir);\n    mat4.perspective(projMatrix, vFov, aspect, 0.1, 100);\n\n    this._changed = true;\n  }\n\n  /**\n   * @hidden\n   */\n  public onFrameRender() {\n    this._changed = false;\n  }\n\n  private _updateQuaternion() {\n    eulerToQuat(this.quaternion, this.yaw, this.pitch, this.rollOffset);\n  }\n\n  /**\n   * @param zoom Current zoom value\n   * @returns horizontal fov including zoom, in radian\n   */\n  private _getZoomedHorizontalFov(zoom = this.zoom) {\n    return 2 * Math.atan(Math.tan(DEG_TO_RAD * this.fov * 0.5) / zoom);\n  }\n}\n\nexport default Camera;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport * as BROWSER from \"../../const/browser\";\nimport { CONTROL_EVENTS } from \"../../const/internal\";\nimport { InputEvents } from \"../../type/internal\";\n\nclass MouseInput extends Component<InputEvents<{ x: number, y: number }, MouseEvent>> {\n  private _el: HTMLElement | null;\n  private _prevPos: [number, number];\n\n  public constructor() {\n    super();\n\n    this._el = null;\n    this._prevPos = [0, 0];\n  }\n\n  public enable(element: HTMLElement) {\n    if (this._el) return;\n\n    element.addEventListener(BROWSER.EVENTS.MOUSE_DOWN, this._onMouseDown);\n\n    this._el = element;\n  }\n\n  public disable() {\n    const element = this._el;\n    if (!element) return;\n\n    element.removeEventListener(BROWSER.EVENTS.MOUSE_DOWN, this._onMouseDown);\n    window.removeEventListener(BROWSER.EVENTS.MOUSE_MOVE, this._onMouseMove, false);\n    window.removeEventListener(BROWSER.EVENTS.MOUSE_UP, this._onMouseUp, false);\n\n    this._el = null;\n  }\n\n  private _onMouseDown = (evt: MouseEvent) => {\n    const el = this._el;\n    if (!el || evt.button !== BROWSER.MOUSE_BUTTON.LEFT) return;\n\n    evt.preventDefault();\n\n    if (el.focus) {\n      el.focus();\n    } else {\n      window.focus();\n    }\n\n    this._prevPos[0] = evt.clientX;\n    this._prevPos[1] = evt.clientY;\n\n    window.addEventListener(BROWSER.EVENTS.MOUSE_MOVE, this._onMouseMove, false);\n    window.addEventListener(BROWSER.EVENTS.MOUSE_UP, this._onMouseUp, false);\n\n    this.trigger(CONTROL_EVENTS.INPUT_START, {\n      srcEvent: evt,\n      isTouch: false,\n      isKeyboard: false\n    });\n  }\n\n  private _onMouseMove = (evt: MouseEvent) => {\n    evt.preventDefault();\n\n    const x = evt.clientX;\n    const y = evt.clientY;\n    const prevPos = this._prevPos;\n    const deltaX = x - prevPos[0];\n    const deltaY = y - prevPos[1];\n\n    this.trigger(CONTROL_EVENTS.CHANGE, {\n      delta: {\n        x: deltaX,\n        y: deltaY\n      },\n      isTouch: false,\n      isKeyboard: false\n    });\n\n    prevPos[0] = x;\n    prevPos[1] = y;\n  }\n\n  private _onMouseUp = () => {\n    this._prevPos[0] = 0;\n    this._prevPos[1] = 0;\n\n    window.removeEventListener(BROWSER.EVENTS.MOUSE_MOVE, this._onMouseMove, false);\n    window.removeEventListener(BROWSER.EVENTS.MOUSE_UP, this._onMouseUp, false);\n\n    this.trigger(CONTROL_EVENTS.INPUT_END, {\n      isTouch: false,\n      isKeyboard: false,\n      scrolling: false\n    });\n  }\n}\n\nexport default MouseInput;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport * as BROWSER from \"../../const/browser\";\nimport { CONTROL_EVENTS } from \"../../const/internal\";\nimport { InputEvents } from \"../../type/internal\";\nimport { isFullscreen } from \"../../utils\";\n\nclass TouchInput extends Component<InputEvents<{ x: number, y: number }, TouchEvent>> {\n  private _el: HTMLElement | null;\n  private _prevPos: [number, number];\n  private _isFirstTouch: boolean;\n  private _scrolling: boolean;\n  private _scrollable: boolean;\n\n  public get scrollable() { return this._scrollable; }\n  public set scrollable(val: boolean) { this._scrollable = val; }\n\n  public constructor() {\n    super();\n\n    this._el = null;\n    this._prevPos = [0, 0];\n    this._isFirstTouch = false;\n    this._scrolling = false;\n    this._scrollable = false;\n  }\n\n  public enable(element: HTMLElement) {\n    if (this._el) return;\n\n    element.addEventListener(BROWSER.EVENTS.TOUCH_START, this._onTouchStart, { passive: false });\n    element.addEventListener(BROWSER.EVENTS.TOUCH_MOVE, this._onTouchMove, { passive: false });\n    element.addEventListener(BROWSER.EVENTS.TOUCH_END, this._onTouchEnd);\n\n    this._el = element;\n  }\n\n  public disable() {\n    const element = this._el;\n    if (!element) return;\n\n    element.removeEventListener(BROWSER.EVENTS.TOUCH_START, this._onTouchStart);\n    element.removeEventListener(BROWSER.EVENTS.TOUCH_MOVE, this._onTouchMove);\n    element.removeEventListener(BROWSER.EVENTS.TOUCH_END, this._onTouchEnd);\n\n    this._el = null;\n  }\n\n  private _onTouchStart = (evt: TouchEvent) => {\n    if (evt.touches.length > 1 || this._scrolling) return;\n\n    const touch = evt.touches[0];\n\n    this._isFirstTouch = true;\n    this._prevPos[0] = touch.clientX;\n    this._prevPos[1] = touch.clientY;\n\n    this.trigger(CONTROL_EVENTS.INPUT_START, {\n      srcEvent: evt,\n      isTouch: true,\n      isKeyboard: false\n    });\n  };\n\n  private _onTouchMove = (evt: TouchEvent) => {\n    // Only the one finger motion should be considered\n    if (evt.touches.length > 1 || this._scrolling) return;\n\n    const touch = evt.touches[0];\n    const scrollable = this._scrollable;\n    const prevPos = this._prevPos;\n\n    const x = touch.clientX;\n    const y = touch.clientY;\n    const deltaX = x - prevPos[0];\n    const deltaY = y - prevPos[1];\n\n    if (this._isFirstTouch) {\n      if (scrollable && !isFullscreen()) {\n        if (Math.abs(deltaY) > Math.abs(deltaX)) {\n          // Assume Scrolling\n          this._scrolling = true;\n          return;\n        }\n      }\n\n      this._isFirstTouch = false;\n    }\n\n    if (evt.cancelable !== false) {\n      evt.preventDefault();\n    }\n\n    this.trigger(CONTROL_EVENTS.CHANGE, {\n      delta: {\n        x: deltaX,\n        y: deltaY\n      },\n      isTouch: true,\n      isKeyboard: false\n    });\n\n    prevPos[0] = x;\n    prevPos[1] = y;\n  };\n\n  private _onTouchEnd = (evt: TouchEvent) => {\n    if (evt.touches.length !== 0) return;\n\n    const touch = evt.touches[0];\n    const prevPos = this._prevPos;\n\n    if (touch) {\n      prevPos[0] = touch.clientX;\n      prevPos[1] = touch.clientY;\n    } else {\n      prevPos[0] = 0;\n      prevPos[1] = 0;\n\n      this.trigger(CONTROL_EVENTS.INPUT_END, {\n        isTouch: true,\n        isKeyboard: false,\n        scrolling: this._scrolling\n      });\n    }\n\n    if (evt.cancelable !== false) {\n      evt.preventDefault();\n    }\n\n    this._scrolling = false;\n  };\n}\n\nexport default TouchInput;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport * as BROWSER from \"../../const/browser\";\nimport { CONTROL_EVENTS } from \"../../const/internal\";\nimport { InputEvents } from \"../../type/internal\";\n\nclass KeyboardInput extends Component<InputEvents<{ x: number, y: number }, KeyboardEvent>> {\n  private _el: HTMLElement | null;\n  private _pressed: {\n    LEFT: boolean;\n    UP: boolean;\n    RIGHT: boolean;\n    DOWN: boolean;\n  };\n\n  public get active() {\n    const pressed = this._pressed;\n    return pressed.LEFT || pressed.UP || pressed.RIGHT || pressed.DOWN;\n  }\n\n  public constructor() {\n    super();\n\n    this._el = null;\n    this._clearPressedKeys();\n  }\n\n  public enable(element: HTMLElement) {\n    if (this._el) return;\n\n    element.addEventListener(BROWSER.EVENTS.KEY_DOWN, this._onKeyDown);\n    element.addEventListener(BROWSER.EVENTS.KEY_UP, this._onKeyUp);\n\n    this._el = element;\n    this._clearPressedKeys();\n  }\n\n  public disable() {\n    const element = this._el;\n    if (!element) return;\n\n    element.removeEventListener(BROWSER.EVENTS.KEY_DOWN, this._onKeyDown);\n    element.removeEventListener(BROWSER.EVENTS.KEY_UP, this._onKeyUp);\n\n    this._el = null;\n    this._clearPressedKeys();\n  }\n\n  public update() {\n    const delta = this._getDeltaByPressedKeys();\n\n    if (delta.x !== 0 || delta.y !== 0) {\n      this.trigger(CONTROL_EVENTS.CHANGE, {\n        delta,\n        isTouch: false,\n        isKeyboard: true\n      });\n    }\n  }\n\n  private _clearPressedKeys() {\n    this._pressed = BROWSER.KEY_DIRECTION.reduce((obj, keyName) => {\n      return {\n        ...obj,\n        [keyName]: false\n      };\n    }, {} as KeyboardInput[\"_pressed\"]);\n  }\n\n  private _updateKeyPress(event: KeyboardEvent, isEnable: boolean): void {\n    const pressed = this._pressed;\n    const keyToUpdate = event.keyCode != null\n      ? BROWSER.DIRECTION_KEY_CODE[event.keyCode]\n      : BROWSER.DIRECTION_KEY_NAME[event.key];\n\n    if (!keyToUpdate) return;\n\n    pressed[keyToUpdate] = isEnable;\n  }\n\n  private _getPressedKeyCount() {\n    return BROWSER.KEY_DIRECTION.filter(key => this._pressed[key]).length;\n  }\n\n  private _getDeltaByPressedKeys() {\n    const pressed = this._pressed;\n    let x = 0;\n    let y = 0;\n\n    if (pressed.LEFT) {\n      x += 1;\n    }\n\n    if (pressed.RIGHT) {\n      x -= 1;\n    }\n\n    if (pressed.UP) {\n      y += 1;\n    }\n\n    if (pressed.DOWN) {\n      y -= 1;\n    }\n\n    return {\n      x, y\n    };\n  }\n\n  private _onKeyDown = (evt: KeyboardEvent) => {\n    // Ignore all other keypress except main arrow keys\n    if (evt.location !== KeyboardEvent.DOM_KEY_LOCATION_STANDARD) return;\n\n    this._updateKeyPress(evt, true);\n\n    const pressedCount = this._getPressedKeyCount();\n    if (pressedCount <= 0) return;\n\n    evt.preventDefault();\n    if (pressedCount === 1 && !evt.repeat) {\n      // On first keydown\n      this.trigger(CONTROL_EVENTS.INPUT_START, {\n        srcEvent: evt,\n        isTouch: false,\n        isKeyboard: true\n      });\n    }\n  };\n\n  private _onKeyUp = (evt: KeyboardEvent) => {\n    // Ignore all other keypress except main arrow keys\n    if (evt.location !== KeyboardEvent.DOM_KEY_LOCATION_STANDARD) return;\n\n    this._updateKeyPress(evt, false);\n\n    const pressedCount = this._getPressedKeyCount();\n    if (pressedCount > 0) return;\n\n    this.trigger(CONTROL_EVENTS.INPUT_END, {\n      isTouch: false,\n      isKeyboard: true,\n      scrolling: false\n    });\n  };\n}\n\nexport default KeyboardInput;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport CameraControl from \"./CameraControl\";\nimport MouseInput from \"./input/MouseInput\";\nimport TouchInput from \"./input/TouchInput\";\nimport KeyboardInput from \"./input/KeyboardInput\";\nimport Camera from \"../core/Camera\";\nimport Motion from \"../core/Motion\";\nimport { CONTROL_EVENTS, INFINITE_RANGE, DEFAULT_PITCH_RANGE, DEFAULT_ANIMATION_DURATION, DEFAULT_EASING, DEG_TO_RAD, RAD_TO_DEG } from \"../const/internal\";\nimport { toVerticalFov } from \"../utils\";\nimport { ControlEvents, InputEvents } from \"../type/internal\";\n\n/**\n * Options for {@link RotateControl}\n * @ko {@link RotateControl}용 옵션들\n * @since 4.0.0\n */\nexport interface RotateControlOptions {\n  /**\n   * @copy RotateControl#pointerScale\n   */\n  pointerScale: [number, number];\n  /**\n   * @copy RotateControl#keyboardScale\n   */\n  keyboardScale: [number, number];\n  /**\n   * @copy RotateControl#duration\n   */\n  duration: number;\n  /**\n   * @copy RotateControl#easing\n   */\n  easing: (x: number) => number;\n  /**\n   * @copy RotateControl#disablePitch\n   */\n  disablePitch: boolean;\n  /**\n   * @copy RotateControl#disableYaw\n   */\n  disableYaw: boolean;\n  /**\n   * @copy RotateControl#disableKeyboard\n   */\n  disableKeyboard: boolean;\n}\n\ntype RotateDeltaType = { x: number; y: number; };\nexport type RotateControlEvents = ControlEvents<RotateDeltaType>;\n\n/**\n * Camera's rotation control\n * @ko 카메라의 회전을 담당하는 컨트롤\n * @since 4.0.0\n */\nclass RotateControl extends Component<RotateControlEvents> implements CameraControl {\n  // Options\n  private _pointerScale: RotateControlOptions[\"pointerScale\"];\n  private _keyboardScale: RotateControlOptions[\"keyboardScale\"];\n  private _duration: RotateControlOptions[\"duration\"];\n  private _easing: RotateControlOptions[\"easing\"];\n  private _disablePitch: RotateControlOptions[\"disablePitch\"];\n  private _disableYaw: RotateControlOptions[\"disableYaw\"];\n  private _disableKeyboard: RotateControlOptions[\"disableKeyboard\"];\n\n  // Internal values\n  private _controlEl: HTMLElement;\n  private _enableBlocked: boolean;\n  private _mouseInput: MouseInput;\n  private _touchInput: TouchInput;\n  private _keyboardInput: KeyboardInput;\n  private _xMotion: Motion;\n  private _yMotion: Motion;\n  private _screenScale: [number, number];\n  private _zoomScale: number;\n  private _enabled: boolean;\n  private _changedWhileDragging: boolean;\n\n  /**\n   * @copy CameraControl#enabled\n   */\n  public get enabled() { return this._enabled; }\n  /**\n   * @hidden\n   */\n  public get enableBlocked() { return this._enableBlocked; }\n  /**\n   * @copy CameraControl#animating\n   */\n  public get animating() {\n    return this._keyboardInput.active\n      || this._xMotion.activated\n      || this._yMotion.activated;\n  }\n  /**\n   * Current yaw value\n   * @ko 현재 yaw 값\n   * @readonly\n   * @since 4.0.0\n   */\n  public get yaw() { return this._xMotion; }\n  /**\n   * Current pitch value\n   * @ko 현재 pitch 값\n   * @readonly\n   * @since 4.0.0\n   */\n  public get pitch() { return this._yMotion; }\n  /**\n   * @copy View360#scrollable\n   */\n  public get scrollable() { return this._touchInput.scrollable; }\n  public set scrollable(val: boolean) {\n    this._touchInput.scrollable = val;\n  }\n\n  /**\n   * Scale factor for mouse/touch rotation\n   * @ko 마우스/터치를 통한 회전 배율\n   * @default [1, 1]\n   * @since 4.0.0\n   */\n  public get pointerScale() { return this._pointerScale; }\n  public set pointerScale(val: RotateControlOptions[\"pointerScale\"]) {\n    this._pointerScale = val;\n  }\n\n  /**\n   * Scale factor for keyboard rotation\n   * @ko 키보드를 통한 회전 배율\n   * @default [1, 1]\n   * @since 4.0.0\n   */\n  public get keyboardScale() { return this._keyboardScale; }\n  public set keyboardScale(val: RotateControlOptions[\"keyboardScale\"]) {\n    this._keyboardScale = val;\n  }\n\n  /**\n   * Duration of the input animation (ms)\n   * @ko 회전 애니메이션의 시간 (ms)\n   * @default 300\n   */\n  public get duration() { return this._duration; }\n  public set duration(val: RotateControlOptions[\"duration\"]) {\n    this._duration = val;\n    this._xMotion.duration = val;\n    this._yMotion.duration = val;\n  }\n\n  /**\n   * Easing function of the animation\n   * @ko 회전 애니메이션에 적용할 easing 함수\n   * @default EASING.EASE_OUT_CUBIC\n   * @see EASING\n   */\n  public get easing() { return this._easing; }\n  public set easing(val: RotateControlOptions[\"easing\"]) {\n    this._easing = val;\n    this._xMotion.easing = val;\n    this._yMotion.easing = val;\n  }\n\n  /**\n   * Disable X-axis(pitch) rotation.\n   * @ko x축 회전(pitch)을 비활성화합니다.\n   * @default false\n   */\n  public get disablePitch() { return this._disablePitch; }\n  public set disablePitch(val: RotateControlOptions[\"disablePitch\"]) { this._disablePitch = val; }\n\n  /**\n   * Disable Y-axis(yaw) rotation.\n   * @ko y축 회전(yaw)을 비활성화합니다.\n   * @default false\n   */\n  public get disableYaw() { return this._disableYaw; }\n  public set disableYaw(val: RotateControlOptions[\"disableYaw\"]) { this._disableYaw = val; }\n\n  /**\n   * Disable rotation by keyboard.\n   * @ko 키보드를 이용한 회전을 비활성화합니다.\n   * @default false\n   */\n  public get disableKeyboard() { return this._disableKeyboard; }\n  public set disableKeyboard(val: RotateControlOptions[\"disableKeyboard\"]) { this._disableKeyboard = val; }\n\n  /**\n   * Create new RotateControl instance\n   * @ko RotateControl의 인스턴스를 생성합니다.\n   * @param controlEl - Element to attach handlers {@ko 입력을 받을 엘리먼트}\n   * @param enableBlocked - Whether to disable control on init {@ko 초기화 과정에서 컨트롤 활성화 여부}\n   * @param options - Options for control {@ko 컨트롤 옵션들}\n   */\n  public constructor(controlEl: HTMLElement, enableBlocked: boolean, {\n    duration = DEFAULT_ANIMATION_DURATION,\n    easing = DEFAULT_EASING,\n    pointerScale = [1, 1],\n    keyboardScale = [1, 1],\n    disablePitch = false,\n    disableYaw = false,\n    disableKeyboard = false\n  }: Partial<RotateControlOptions> = {}) {\n    super();\n\n    this._controlEl = controlEl;\n    this._pointerScale = pointerScale;\n    this._keyboardScale = keyboardScale;\n    this._duration = duration;\n    this._easing = easing;\n    this._disablePitch = disablePitch;\n    this._disableYaw = disableYaw;\n    this._disableKeyboard = disableKeyboard;\n\n    this._enableBlocked = enableBlocked;\n    this._mouseInput = new MouseInput();\n    this._touchInput = new TouchInput();\n    this._keyboardInput = new KeyboardInput();\n    this._xMotion = new Motion({ duration, range: INFINITE_RANGE, easing });\n    this._yMotion = new Motion({ duration, range: DEFAULT_PITCH_RANGE, easing });\n    this._screenScale = [1, 1];\n    this._zoomScale = 1;\n    this._enabled = false;\n    this._changedWhileDragging = false;\n    this._bindInputs();\n  }\n\n  public destroy(): void {\n    this.disable();\n    this._mouseInput.off();\n    this._touchInput.off();\n    this._keyboardInput.off();\n    this.off();\n    this._changedWhileDragging = false;\n  }\n\n  /**\n   * @hidden\n   */\n  public update(delta: number): void {\n    if (!this._enabled) return;\n\n    const xMotion = this._xMotion;\n    const yMotion = this._yMotion;\n    const keyboardInput = this._keyboardInput;\n\n    if (!this._disableKeyboard) {\n      keyboardInput.update();\n    }\n\n    if (!this._disablePitch) {\n      yMotion.update(delta);\n    }\n\n    if (!this._disableYaw) {\n      xMotion.update(delta);\n    }\n  }\n\n  /**\n   * @hidden\n   */\n  public updateRange(camera: Camera, zoom: number) {\n    const yawRange = camera.getYawRange(zoom);\n    const pitchRange = camera.getPitchRange(zoom);\n\n    this._xMotion.setRange(yawRange.min, yawRange.max);\n    this._yMotion.setRange(pitchRange.min, pitchRange.max);\n  }\n\n  /**\n   * @hidden\n   */\n  public setZoomScale(val: number) {\n    this._zoomScale = val;\n  }\n\n  /**\n   * Resize control to match target size.\n   * @ko 컨트롤의 내부 크기를 갱신합니다.\n   * @param hfov - Camera horizontal fov in degrees {@ko 카메라의 수평방향 fov값 (도 단위)}\n   * @param aspect - Camera aspect {@ko 카메라 가로/세로 비율}\n   * @param width - New width {@ko 갱신된 너비}\n   * @param height - New height {@ko 갱신된 높이}\n   */\n  public resize(hfov: number, aspect: number, width: number, height: number) {\n    const vfov = toVerticalFov(hfov * DEG_TO_RAD, aspect) * RAD_TO_DEG;\n\n    this._screenScale[0] = hfov / width;\n    this._screenScale[1] = vfov / height;\n  }\n\n  public enable(): void {\n    if (this._enabled) return;\n\n    const element = this._controlEl;\n\n    this._mouseInput.enable(element);\n    this._touchInput.enable(element);\n    this._keyboardInput.enable(element);\n\n    this._enabled = true;\n    this._enableBlocked = false;\n\n    this.trigger(CONTROL_EVENTS.ENABLE, { control: this, updateCursor: true });\n  }\n\n  public disable(): void {\n    if (!this._enabled) return;\n\n    this._mouseInput.disable();\n    this._touchInput.disable();\n    this._keyboardInput.disable();\n\n    this._enabled = false;\n\n    this.trigger(CONTROL_EVENTS.DISABLE, { updateCursor: true });\n  }\n\n  public sync(camera: Camera): void {\n    this.updateRange(camera, camera.zoom);\n\n    this._xMotion.reset(camera.yaw);\n    this._yMotion.reset(camera.pitch);\n  }\n\n  private _bindInputs() {\n    const mouseInput = this._mouseInput;\n    const touchInput = this._touchInput;\n    const keyboardInput = this._keyboardInput;\n\n    mouseInput.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    mouseInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    mouseInput.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    touchInput.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    touchInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    touchInput.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    keyboardInput.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    keyboardInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    keyboardInput.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n  }\n\n  private _onInputStart = (evt: InputEvents<RotateDeltaType>[typeof CONTROL_EVENTS.INPUT_START]) => {\n    this._changedWhileDragging = false;\n    this.trigger(CONTROL_EVENTS.INPUT_START, {\n      ...evt,\n      inputType: \"rotate\"\n    });\n  };\n\n  private _onChange = (evt: InputEvents<RotateDeltaType>[typeof CONTROL_EVENTS.CHANGE]) => {\n    const delta = evt.delta;\n    const invZoomScale = 1 / this._zoomScale; // Reduce speed on zoom\n    const screenScale = this._screenScale;\n    const keyboardScale = this._keyboardScale;\n    const pointerScale = this._pointerScale;\n\n    let scale: [number, number];\n\n    if (evt.isKeyboard) {\n      scale = [\n        keyboardScale[0] * invZoomScale,\n        keyboardScale[1] * invZoomScale\n      ];\n    } else {\n      scale = [\n        pointerScale[0] * screenScale[0] * invZoomScale,\n        pointerScale[1] * screenScale[1] * invZoomScale\n      ];\n    }\n\n    const scaledX = delta.x * scale[0];\n    const scaledY = delta.y * scale[1];\n\n    this._xMotion.setNewEndByDelta(scaledX);\n    this._yMotion.setNewEndByDelta(scaledY);\n\n    this._changedWhileDragging = true;\n  }\n\n  private _onInputEnd = (evt: InputEvents<RotateDeltaType>[typeof CONTROL_EVENTS.INPUT_END]) => {\n    this.trigger(CONTROL_EVENTS.INPUT_END, {\n      ...evt,\n      inputType: \"rotate\"\n    });\n\n    if (!this._changedWhileDragging && !evt.isKeyboard && !evt.scrolling) {\n      this.trigger(CONTROL_EVENTS.STATIC_CLICK, {\n        isTouch: evt.isTouch\n      });\n    }\n\n    this._changedWhileDragging = false;\n  };\n}\n\nexport default RotateControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport * as BROWSER from \"../../const/browser\";\nimport { CONTROL_EVENTS, DEFAULT_ANIMATION_DURATION } from \"../../const/internal\";\nimport { InputEvents } from \"../../type/internal\";\n\nclass WheelInput extends Component<InputEvents<number, WheelEvent>> {\n  private _el: HTMLElement | null;\n  private _scrollable: boolean;\n  private _baseScale: number;\n  private _inputTimer: number;\n\n  public get scrollable() { return this._scrollable; }\n  public set scrollable(val: boolean) { this._scrollable = val; }\n\n  public constructor() {\n    super();\n\n    this._el = null;\n    this._baseScale = 0.04;\n    this._scrollable = false;\n    this._inputTimer = -1;\n  }\n\n  public enable(element: HTMLElement) {\n    if (this._el) return;\n\n    element.addEventListener(BROWSER.EVENTS.WHEEL, this._onWheel, { passive: false, capture: false });\n\n    this._el = element;\n    this._clearTimer();\n  }\n\n  public disable() {\n    const element = this._el;\n    if (!element) return;\n\n    element.removeEventListener(BROWSER.EVENTS.WHEEL, this._onWheel, false);\n\n    this._el = null;\n    this._clearTimer();\n  }\n\n  private _onWheel = (evt: WheelEvent) => {\n    const scrollable = this._scrollable;\n\n    if (evt.deltaY === 0 || scrollable) return;\n\n    evt.preventDefault();\n    evt.stopPropagation();\n\n    if (this._inputTimer < 0) {\n      this.trigger(CONTROL_EVENTS.INPUT_START, {\n        srcEvent: evt,\n        isTouch: false,\n        isKeyboard: false\n      });\n    } else {\n      this._clearTimer();\n    }\n\n    const delta = this._baseScale * evt.deltaY;\n\n    this.trigger(CONTROL_EVENTS.CHANGE, {\n      delta,\n      isTouch: false,\n      isKeyboard: false\n    });\n\n    this._inputTimer = window.setTimeout(() => {\n      this.trigger(CONTROL_EVENTS.INPUT_END, {\n        isTouch: false,\n        isKeyboard: false,\n        scrolling: false\n      });\n      this._inputTimer = -1;\n    }, DEFAULT_ANIMATION_DURATION);\n  };\n\n  private _clearTimer() {\n    window.clearTimeout(this._inputTimer);\n    this._inputTimer = -1;\n  }\n}\n\nexport default WheelInput;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport * as BROWSER from \"../../const/browser\";\nimport { CONTROL_EVENTS } from \"../../const/internal\";\nimport { InputEvents } from \"../../type/internal\";\n\nclass PinchInput extends Component<InputEvents<number, TouchEvent>> {\n  private _el: HTMLElement | null;\n  private _baseScale: number;\n  private _prevDistance: number;\n  private _isFirstTouch: boolean;\n\n  public constructor() {\n    super();\n\n    this._el = null;\n    this._baseScale = -0.2;\n    this._prevDistance = -1;\n    this._isFirstTouch = true;\n  }\n\n  public enable(element: HTMLElement) {\n    if (this._el) return;\n\n    element.addEventListener(BROWSER.EVENTS.TOUCH_MOVE, this._onTouchMove, { passive: false, capture: false });\n    element.addEventListener(BROWSER.EVENTS.TOUCH_END, this._onTouchEnd);\n\n    this._el = element;\n    this._prevDistance = -1;\n    this._isFirstTouch = true;\n  }\n\n  public disable() {\n    const element = this._el;\n    if (!element) return;\n\n    element.removeEventListener(BROWSER.EVENTS.TOUCH_MOVE, this._onTouchMove, false);\n    element.removeEventListener(BROWSER.EVENTS.TOUCH_END, this._onTouchEnd);\n\n    this._el = null;\n  }\n\n  private _onTouchMove = (evt: TouchEvent) => {\n    const touches = evt.touches;\n    if (touches.length !== 2) return;\n\n    if (!evt.cancelable) return;\n\n    evt.preventDefault();\n    evt.stopPropagation();\n\n    const prevDistance = this._prevDistance;\n\n    const diff = [\n      touches[0].pageX - touches[1].pageX,\n      touches[0].pageY - touches[1].pageY\n    ];\n\n    const distance = Math.sqrt(diff[0] * diff[0] + diff[1] * diff[1]) * this._baseScale;\n    const delta = this._isFirstTouch\n      ? 0\n      : distance - prevDistance;\n\n    if (this._isFirstTouch) {\n      this.trigger(CONTROL_EVENTS.INPUT_START, {\n        srcEvent: evt,\n        isTouch: true,\n        isKeyboard: false\n      });\n    }\n\n    this._prevDistance = distance;\n    this._isFirstTouch = false;\n\n    this.trigger(CONTROL_EVENTS.CHANGE, {\n      delta,\n      isTouch: true,\n      isKeyboard: false\n    });\n  };\n\n  private _onTouchEnd = (evt: TouchEvent) => {\n    if (evt.touches.length !== 0) return;\n\n    if (!this._isFirstTouch) {\n      this.trigger(CONTROL_EVENTS.INPUT_END, {\n        isTouch: true,\n        isKeyboard: false,\n        scrolling: false\n      });\n    }\n\n    this._prevDistance = -1;\n    this._isFirstTouch = true;\n  };\n}\n\nexport default PinchInput;\n","/*\n* Copyright (c) 2023-present NAVER Corp.\n* egjs projects are licensed under the MIT license\n*/\nimport Component from \"@egjs/component\";\nimport CameraControl from \"./CameraControl\";\nimport WheelInput from \"./input/WheelInput\";\nimport PinchInput from \"./input/PinchInput\";\nimport Camera from \"../core/Camera\";\nimport Motion from \"../core/Motion\";\nimport {\n  CONTROL_EVENTS,\n  DEFAULT_ANIMATION_DURATION,\n  DEFAULT_EASING,\n  INFINITE_RANGE\n} from \"../const/internal\";\nimport { ControlEvents, InputEvents } from \"../type/internal\";\n\n/**\n * Options for {@link ZoomControl}\n * @ko {@link ZoomControl}용 옵션들\n * @since 4.0.0\n */\nexport interface ZoomControlOptions {\n  /**\n   * @copy ZoomControl#scale\n   */\n  scale: number;\n  /**\n   * @copy ZoomControl#duration\n   */\n  duration: number;\n  /**\n   * @copy ZoomControl#easing\n   */\n  easing: (x: number) => number;\n}\n\ntype ZoomControlEvents = ControlEvents<number>;\n\n/**\n * Camera's zoom control\n * @ko 카메라의 줌 값을 담당하는 컨트롤\n * @since 4.0.0\n */\nclass ZoomControl extends Component<ZoomControlEvents> implements CameraControl {\n  // Options\n  private _scale: ZoomControlOptions[\"scale\"];\n\n  // Internal values\n  private _controlEl: HTMLElement;\n  private _enableBlocked: boolean;\n  private _wheelInput: WheelInput;\n  private _pinchInput: PinchInput;\n  private _motion: Motion;\n  private _enabled: boolean;\n\n  /**\n   * @copy CameraControl#enabled\n   */\n  public get enabled() { return this._enabled; }\n  /**\n   * @hidden\n   */\n  public get enableBlocked() { return this._enableBlocked; }\n  /**\n   * @copy CameraControl#animating\n   */\n  public get animating() { return this._motion.activated; }\n  /**\n   * Current zoom value\n   * @ko 현재 줌 값\n   * @since 4.0.0\n   * @readonly\n   */\n  public get zoom() { return this._motion.val; }\n  /**\n   * @copy View360#wheelScrollable\n   */\n  public get scrollable() { return this._wheelInput.scrollable; }\n  public set scrollable(val: boolean) {\n    this._wheelInput.scrollable = val;\n  }\n  /**\n   * @hidden\n   */\n  public get range() { return this._motion.range; }\n\n  /**\n   * Scale factor of the zoom\n   * @ko 입력에 의한 줌 배율\n   * @default 1\n   * @since 4.0.0\n   */\n  public get scale() { return this._scale; }\n  public set scale(val: ZoomControlOptions[\"scale\"]) { this._scale = val; }\n\n  /**\n   * Duration of the input animation (ms)\n   * @ko 회전 애니메이션의 시간 (ms)\n   * @default 300\n   * @since 4.0.0\n   */\n  public get duration() { return this._motion.duration; }\n\n  /**\n   * Easing function of the animation\n   * @ko 회전 애니메이션에 적용할 easing 함수\n   * @default EASING.EASE_OUT_CUBIC\n   * @see EASING\n   * @since 4.0.0\n   */\n  public get easing() { return this._motion.easing; }\n\n  /**\n   * Create new ZoomControl instance\n   * @ko ZoomControl의 인스턴스를 생성합니다.\n   * @param controlEl - Element to attach handlers {@ko 입력을 받을 엘리먼트}\n   * @param enableBlocked - Whether to disable control on init {@ko 초기화 과정에서 컨트롤 활성화 여부}\n   * @param options - Options for control {@ko 컨트롤 옵션들}\n   */\n  public constructor(controlEl: HTMLElement, enableBlocked: boolean, {\n    scale = 1,\n    duration = DEFAULT_ANIMATION_DURATION,\n    easing = DEFAULT_EASING\n  }: Partial<ZoomControlOptions> = {}) {\n    super();\n\n    this._scale = scale;\n\n    this._controlEl = controlEl;\n    this._enableBlocked = enableBlocked;\n    this._wheelInput = new WheelInput();\n    this._pinchInput = new PinchInput();\n    this._motion = new Motion({\n      duration,\n      easing,\n      range: INFINITE_RANGE\n    });\n    this._enabled = false;\n\n    this._bindInputs();\n  }\n\n  public destroy(): void {\n    this.disable();\n    this._wheelInput.off();\n    this._pinchInput.off();\n    this.off();\n  }\n\n  /**\n   * @hidden\n   */\n  public update(delta: number): void {\n    if (!this._enabled) return;\n\n    const motion = this._motion;\n    motion.update(delta);\n  }\n\n  public enable(): void {\n    if (this._enabled) return;\n\n    const element = this._controlEl;\n    this._wheelInput.enable(element);\n    this._pinchInput.enable(element);\n\n    this._enabled = true;\n    this._enableBlocked = false;\n\n    this.trigger(CONTROL_EVENTS.ENABLE, { control: this, updateCursor: false });\n  }\n\n  public disable(): void {\n    if (!this._enabled) return;\n\n    this._wheelInput.disable();\n    this._pinchInput.disable();\n\n    this._enabled = false;\n\n    this.trigger(CONTROL_EVENTS.DISABLE, { updateCursor: false });\n  }\n\n  public sync(camera: Camera): void {\n    const motion = this._motion;\n    const range = camera.getZoomRange();\n\n    motion.setRange(range.min, range.max);\n    motion.reset(range.current);\n  }\n\n  private _bindInputs() {\n    const wheelInput = this._wheelInput;\n    const pinchInput = this._pinchInput;\n\n    wheelInput.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    wheelInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    wheelInput.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    pinchInput.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    pinchInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    pinchInput.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n  }\n\n  private _onInputStart = (evt: InputEvents<number>[typeof CONTROL_EVENTS.INPUT_START]) => {\n    this.trigger(CONTROL_EVENTS.INPUT_START, {\n      ...evt,\n      inputType: \"zoom\"\n    });\n  };\n\n  private _onChange = ({ delta }: InputEvents<number>[typeof CONTROL_EVENTS.CHANGE]) => {\n    const scale = this._scale;\n    const scaledDelta = delta * scale;\n\n    this._motion.setNewEndByDelta(scaledDelta);\n  };\n\n  private _onInputEnd = (evt: InputEvents<number>[typeof CONTROL_EVENTS.INPUT_END]) => {\n    this.trigger(CONTROL_EVENTS.INPUT_END, {\n      ...evt,\n      inputType: \"zoom\"\n    });\n  };\n}\n\nexport default ZoomControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport { quat, vec3 } from \"gl-matrix\";\nimport * as BROWSER from \"../../const/browser\";\nimport { DEG_TO_RAD, RAD_TO_DEG } from \"../../const/internal\";\nimport { InputEvents } from \"../../type/internal\";\nimport { quatToEuler } from \"../../utils\";\n\nexport const ROTATE_CONSTANT = {\n  PITCH_DELTA: 1,\n  YAW_DELTA_BY_ROLL: 2,\n  YAW_DELTA_BY_YAW: 3\n} as const;\n\nROTATE_CONSTANT[ROTATE_CONSTANT.PITCH_DELTA] = {\n  targetAxis: [0, 1, 0],\n  meshPoint: [0, 0, 1]\n};\nROTATE_CONSTANT[ROTATE_CONSTANT.YAW_DELTA_BY_ROLL] = {\n  targetAxis: [0, 1, 0],\n  meshPoint: [1, 0, 0]\n};\nROTATE_CONSTANT[ROTATE_CONSTANT.YAW_DELTA_BY_YAW] = {\n  targetAxis: [1, 0, 0],\n  meshPoint: [0, 0, 1]\n};\n\nclass GyroInput extends Component<InputEvents<{ x: number, y: number, z: number }, MouseEvent>> {\n  public quaternion: quat;\n\n  private _ignoreRoll: boolean;\n\n  private _yawOrigin: number;\n  private _yawOffset: number;\n  private _orientation: {\n    alpha: number;\n    beta: number;\n    gamma: number;\n  }\n  private _orientationUpdated: boolean;\n  private _needsCalibrate: boolean;\n  private _screenOrientation: number;\n  private _enabled: boolean;\n\n  public get enabled() { return this._enabled; }\n  public get orientationUpdated() { return this._orientationUpdated; }\n  public get ignoreRoll() { return this._ignoreRoll; }\n  public set ignoreRoll(val: boolean) { this._ignoreRoll = val; }\n\n  public constructor() {\n    super();\n\n    this.quaternion = quat.create();\n\n    this._orientation = {\n      alpha: 0,\n      beta: 90,\n      gamma: 0\n    };\n    this._yawOrigin = 0;\n    this._yawOffset = 0;\n    this._orientationUpdated = false;\n    this._screenOrientation = 0;\n    this._needsCalibrate = true;\n    this._enabled = false;\n  }\n\n  public enable() {\n    if (this._enabled) return;\n\n    window.addEventListener(BROWSER.EVENTS.DEVICE_ORIENTATION, this._onDeviceOrientation);\n    window.addEventListener(BROWSER.EVENTS.ORIENTATION_CHANGE, this._updateScreenOrientation);\n\n    this._updateScreenOrientation();\n    this._orientationUpdated = false;\n    this._needsCalibrate = true;\n    this._enabled = true;\n  }\n\n  public disable() {\n    if (!this._enabled) return;\n\n    window.removeEventListener(BROWSER.EVENTS.DEVICE_ORIENTATION, this._onDeviceOrientation);\n    window.removeEventListener(BROWSER.EVENTS.ORIENTATION_CHANGE, this._updateScreenOrientation);\n\n    this._enabled = false;\n  }\n\n  public update() {\n    this._updateRotation();\n    this._orientationUpdated = false;\n  }\n\n  public collectDelta() {\n    if (!this._orientationUpdated) {\n      return {\n        pitch: 0,\n        yaw: 0\n      };\n    }\n\n    const prevRotation = quat.clone(this.quaternion);\n\n    this._updateRotation();\n    this._orientationUpdated = false;\n\n    return this._toEulerDelta(prevRotation, this.quaternion);\n  }\n\n  public setInitialRotation(yaw: number) {\n    this._yawOrigin = yaw;\n  }\n\n  private _onDeviceOrientation = (evt: DeviceOrientationEvent) => {\n    const prevOrientation = this._orientation;\n    const { alpha, beta, gamma } = evt;\n\n    if (\n      alpha == null\n      || beta == null\n      || gamma == null\n    ) return;\n\n    prevOrientation.alpha = alpha;\n    prevOrientation.beta = beta;\n    prevOrientation.gamma = gamma;\n\n    this._orientationUpdated = true;\n\n    if (this._needsCalibrate) {\n      this._needsCalibrate = false;\n      this._calibrateSensor();\n    }\n  };\n\n  private _calibrateSensor() {\n    const yawOrigin = this._yawOrigin;\n    const rotation = this.quaternion;\n\n    this._yawOffset = 0;\n    this._updateRotation();\n\n    const { yaw: sensorYaw } = quatToEuler(rotation);\n    this._yawOffset = sensorYaw - yawOrigin;\n    this._updateRotation();\n\n    this._needsCalibrate = false;\n  }\n\n  private _updateRotation() {\n    const rotation = this.quaternion;\n    const { alpha, beta, gamma } = this._orientation;\n\n    quat.identity(rotation);\n    quat.rotateY(rotation, rotation, (alpha - this._yawOffset) * DEG_TO_RAD);\n    quat.rotateX(rotation, rotation, beta * DEG_TO_RAD);\n    quat.rotateZ(rotation, rotation, -gamma * DEG_TO_RAD);\n\n    const screen = quat.create();\n    const screenAngle = -this._screenOrientation * 0.5 * DEG_TO_RAD;\n    const world = quat.fromValues(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5));\n\n    quat.set(screen, 0, Math.sin(screenAngle), 0, Math.cos(screenAngle));\n    quat.multiply(rotation, rotation, screen);\n    quat.multiply(rotation, rotation, world);\n\n    quat.normalize(rotation, rotation);\n  }\n\n  private _updateScreenOrientation = () => {\n    if (window.screen && window.screen.orientation && window.screen.orientation.angle !== undefined) {\n      this._screenOrientation = screen.orientation.angle;\n    } else if (window.orientation !== undefined) {\n      this._screenOrientation = window.orientation >= 0 ?\n        window.orientation : 360 + window.orientation;\n    } else {\n      this._screenOrientation = 0;\n    }\n  }\n\n  private _toEulerDelta(prevQuat: quat, currentQuat: quat) {\n    return {\n      yaw: this._getDeltaYaw(prevQuat, currentQuat),\n      pitch: this._getDeltaPitch(prevQuat, currentQuat),\n    };\n  }\n\n  private _getDeltaYaw(prvQ: quat, curQ: quat): number {\n    const yawDeltaByYaw = this._getRotationDelta(prvQ, curQ, ROTATE_CONSTANT.YAW_DELTA_BY_YAW);\n    const yawDeltaByRoll = this._getRotationDelta(prvQ, curQ, ROTATE_CONSTANT.YAW_DELTA_BY_ROLL)\n      * Math.sin(this._extractPitchFromQuat(curQ));\n\n    return yawDeltaByRoll + yawDeltaByYaw;\n  }\n\n  private _getDeltaPitch(prvQ: quat, curQ: quat): number {\n    return this._getRotationDelta(prvQ, curQ, ROTATE_CONSTANT.PITCH_DELTA);\n  }\n\n  private _getRotationDelta(prevQ: quat, curQ: quat, rotateKind: typeof ROTATE_CONSTANT[keyof typeof ROTATE_CONSTANT]) {\n    const targetAxis = vec3.fromValues(\n      ROTATE_CONSTANT[rotateKind].targetAxis[0],\n      ROTATE_CONSTANT[rotateKind].targetAxis[1],\n      ROTATE_CONSTANT[rotateKind].targetAxis[2]\n    );\n    const meshPoint = ROTATE_CONSTANT[rotateKind].meshPoint;\n\n    const prevQuaternion = quat.clone(prevQ);\n    const curQuaternion = quat.clone(curQ);\n\n    quat.normalize(prevQuaternion, prevQuaternion);\n    quat.normalize(curQuaternion, curQuaternion);\n\n    let prevPoint = vec3.fromValues(0, 0, 1);\n    let curPoint = vec3.fromValues(0, 0, 1);\n\n    vec3.transformQuat(prevPoint, prevPoint, prevQuaternion);\n    vec3.transformQuat(curPoint, curPoint, curQuaternion);\n    vec3.transformQuat(targetAxis, targetAxis, curQuaternion);\n\n    const rotateDistance = vec3.dot(targetAxis, vec3.cross(vec3.create(), prevPoint, curPoint));\n    const rotateDirection = rotateDistance > 0 ? 1 : -1;\n\n    // when counter clock wise, use vec3.fromValues(0,1,0)\n    // when clock wise, use vec3.fromValues(0,-1,0)\n    // const meshPoint1 = vec3.fromValues(0, 0, 0);\n    const meshPoint2 = vec3.fromValues(meshPoint[0], meshPoint[1], meshPoint[2]);\n\n    let meshPoint3;\n\n    if (rotateKind !== ROTATE_CONSTANT.YAW_DELTA_BY_YAW) {\n      meshPoint3 = vec3.fromValues(0, rotateDirection, 0);\n    } else {\n      meshPoint3 = vec3.fromValues(rotateDirection, 0, 0);\n    }\n\n    vec3.transformQuat(meshPoint2, meshPoint2, curQuaternion);\n    vec3.transformQuat(meshPoint3, meshPoint3, curQuaternion);\n\n    const vecU = meshPoint2;\n    const vecV = meshPoint3;\n    const vecN = vec3.create();\n\n    vec3.cross(vecN, vecU, vecV);\n    vec3.normalize(vecN, vecN);\n\n    const coefficientA = vecN[0];\n    const coefficientB = vecN[1];\n    const coefficientC = vecN[2];\n\n    // a point on the plane\n    curPoint = vec3.fromValues(meshPoint[0], meshPoint[1], meshPoint[2]);\n    vec3.transformQuat(curPoint, curPoint, curQuaternion);\n\n    // a point should project on the plane\n    prevPoint = vec3.fromValues(meshPoint[0], meshPoint[1], meshPoint[2]);\n    vec3.transformQuat(prevPoint, prevPoint, prevQuaternion);\n\n    // distance between prevPoint and the plane\n    let distance = Math.abs(\n      prevPoint[0] * coefficientA +\n      prevPoint[1] * coefficientB +\n      prevPoint[2] * coefficientC\n    );\n\n    const projectedPrevPoint = vec3.create();\n\n    vec3.subtract(projectedPrevPoint, prevPoint, vec3.scale(vec3.create(), vecN, distance));\n\n    let trigonometricRatio =\n      (projectedPrevPoint[0] * curPoint[0] +\n      projectedPrevPoint[1] * curPoint[1] +\n      projectedPrevPoint[2] * curPoint[2]) /\n      (vec3.length(projectedPrevPoint) * vec3.length(curPoint));\n\n    // defensive block\n    if (trigonometricRatio > 1) {\n      trigonometricRatio = 1;\n    }\n\n    const theta = Math.acos(trigonometricRatio);\n\n    const crossVec = vec3.cross(vec3.create(), curPoint, projectedPrevPoint);\n\n    distance = coefficientA * crossVec[0]\n      + coefficientB * crossVec[1]\n      + coefficientC * crossVec[2];\n\n    let thetaDirection: number;\n\n    if (rotateKind !== ROTATE_CONSTANT.YAW_DELTA_BY_YAW) {\n      thetaDirection = distance > 0 ? 1 : -1;\n    } else {\n      thetaDirection = distance < 0 ? 1 : -1;\n    }\n\n    const deltaRadian = theta * thetaDirection * rotateDirection;\n\n    return deltaRadian * RAD_TO_DEG;\n  }\n\n  private _extractPitchFromQuat(quaternion: quat) {\n    const baseV = vec3.fromValues(0, 0, 1);\n    vec3.transformQuat(baseV, baseV, quaternion);\n\n    return -1 * Math.atan2(\n      baseV[1],\n      Math.sqrt(Math.pow(baseV[0], 2) + Math.pow(baseV[2], 2)));\n  }\n}\n\nexport default GyroInput;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport CameraControl from \"./CameraControl\";\nimport GyroInput from \"./input/GyroInput\";\nimport Motion from \"../core/Motion\";\nimport Camera from \"../core/Camera\";\nimport * as BROWSER from \"../const/browser\";\nimport { CONTROL_EVENTS } from \"../const/internal\";\nimport { ControlEvents } from \"../type/internal\";\nimport { sensorCanBeEnabledIOS } from \"../utils\";\n\n/**\n * Options for {@link GyroControl}\n * @ko {@link GyroControl}용 옵션들\n * @since 4.0.0\n */\nexport interface GyroControlOptions {\n  /**\n   * @copy GyroControl#ignoreRoll\n   */\n  ignoreRoll: boolean;\n}\n\nexport type GyroControlEvents = ControlEvents<void>;\n\n/**\n * Camera's rotation control by gyroscope\n * @ko 자이로스코프를 이용한 회전 컨트롤\n * @since 4.0.0\n */\nclass GyroControl extends Component<GyroControlEvents> implements CameraControl {\n  // Options\n  private _ignoreRoll: GyroControlOptions[\"ignoreRoll\"];\n\n  // Internal values\n  private _enableBlocked: boolean;\n  private _input: GyroInput;\n\n  /**\n   * @copy CameraControl#enabled\n   */\n  public get enabled() { return this._input.enabled; }\n  /**\n   * @hidden\n   */\n  public get enableBlocked() { return this._enableBlocked; }\n  /**\n   * @copy CameraControl#animating\n   */\n  public get animating() {\n    return this._input.enabled && this._input.orientationUpdated;\n  }\n\n  /**\n   * When `true`, ignore gyroscope's roll(z-axis rotation) value.\n   * :::caution\n   * Setting `false` will ignore camera's range limit.\n   * Options like {@link View360Options#yawRange}, {@link View360Options#pitchRange} are ignored, and {@link CylinderProjection} also can't force it's camera range limit.\n   * :::\n   * @ko `true`일 경우 자이로스코프 입력의 roll(z축 회전)값을 무시합니다.\n   * :::caution\n   * 이 값을 `false`로 설정할 경우 카메라 범위 제약을 무시합니다.\n   * {@link View360Options#yawRange}, {@link View360Options#pitchRange}와 같은 값은 무시되며, {@link CylinderProjection} 사용시에도 범위를 벗어날 수 있습니다.\n   * :::\n   * @default true\n   * @since 4.0.0\n   */\n  public get ignoreRoll() { return this._ignoreRoll; }\n  public set ignoreRoll(val: GyroControlOptions[\"ignoreRoll\"]) { this._ignoreRoll = val; }\n\n  /**\n   * Return availability of the gyroscope.\n   * :::caution\n   * This will always return false until user permission under environments like iOS which requires user permission when using gyroscope.\n   * :::\n   * @ko 자이로스코프 사용 가능 여부를 반환합니다.\n   * :::caution\n   * iOS와 같이 GyroScope 사용시 사용자 Permission을 요구하는 환경에서는 사용자 Permission을 받기 전까지 항상 `false`입니다.\n   * :::\n   * @example\n   * ```ts\n   * const gyroAvailable = await GyroControl.isAvailable();\n   * ```\n   */\n  public static async isAvailable(): Promise<boolean> {\n    if (!DeviceMotionEvent) {\n      return false;\n    }\n\n    let onDeviceMotionChange: (evt: DeviceMotionEvent) => void;\n\n    const listenDeviceMotion = () => new Promise(res => {\n      onDeviceMotionChange = (evt: DeviceMotionEvent) => {\n        res(evt.rotationRate && evt.rotationRate.alpha != null);\n      };\n\n      window.addEventListener(BROWSER.EVENTS.DEVICE_MOTION, onDeviceMotionChange);\n    });\n\n    const timeout = () => new Promise(res => {\n      setTimeout(() => res(false), 1000);\n    });\n\n    return Promise.race([listenDeviceMotion(), timeout()])\n      .then((available: boolean) => {\n        window.removeEventListener(BROWSER.EVENTS.DEVICE_MOTION, onDeviceMotionChange);\n\n        return available;\n      });\n  }\n\n  /**\n   * Request user permission for gyroscope sensor.\n   * This can be used in environments like iOS which requires user permission when using gyroscope sensors.\n   * @ko 사용자의 sensor permission 취득을 요청합니다.\n   * iOS와 같이 gyroscope 사용시 사용자 Permission을 요구하는 환경에서 사용 가능합니다.\n   * @returns Whether the permission is granted {@ko 사용자 permission 취득 여부}\n   */\n  public static async requestSensorPermission(): Promise<boolean> {\n    // Request sensor permission, on iOS13+\n    if (sensorCanBeEnabledIOS()) {\n      return (DeviceMotionEvent as typeof DeviceMotionEvent & {\n        requestPermission: () => Promise<string>;\n      }).requestPermission().then(permissionState => {\n        return permissionState === \"granted\";\n      }).catch(() => false);\n    }\n\n    return true;\n  }\n\n  /**\n   * Create new GyroControl instance\n   * @ko GyroControl의 인스턴스를 생성합니다.\n   * @param enableBlocked - Whether to disable control on init {@ko 초기화 과정에서 컨트롤 활성화 여부}\n   * @param options - Options for control {@ko 컨트롤 옵션들}\n   */\n  public constructor(enableBlocked: boolean, {\n    ignoreRoll = true\n  }: Partial<GyroControlOptions> = {}) {\n    super();\n\n    this._enableBlocked = enableBlocked;\n    this._ignoreRoll = ignoreRoll;\n    this._input = new GyroInput();\n  }\n\n  /**\n   * @copy CameraControl#destroy\n   */\n  public destroy(): void {\n    this.disable();\n    this._input.off();\n    this.off();\n  }\n\n  /**\n   * @hidden\n   */\n  public update(camera: Camera, yaw: Motion, pitch: Motion, zoom: number) {\n    if (!this._ignoreRoll) {\n      this._updateQuaternion(camera, zoom);\n    } else {\n      this._updateYawPitch(camera, yaw, pitch, zoom);\n    }\n  }\n\n  /**\n   * @copy CameraControl#enable\n   */\n  public enable(): void {\n    if (this._input.enabled) return;\n\n    this._input.enable();\n    this._enableBlocked = false;\n    this.trigger(CONTROL_EVENTS.ENABLE, { control: this, updateCursor: false });\n  }\n\n  /**\n   * @copy CameraControl#disable\n   */\n  public disable(): void {\n    if (!this._input.enabled) return;\n\n    this._input.disable();\n    this.trigger(CONTROL_EVENTS.DISABLE, { updateCursor: false });\n  }\n\n  /**\n   * @copy CameraControl#sync\n   */\n  public sync(): void {} // eslint-disable-line @typescript-eslint/no-empty-function\n\n  private _updateYawPitch(camera: Camera, yaw: Motion, pitch: Motion, zoom: number) {\n    const input = this._input;\n    if (!input.enabled) return;\n\n    const {\n      yaw: yawDelta,\n      pitch: pitchDelta\n    } = input.collectDelta();\n\n    yaw.add(yawDelta);\n    pitch.add(pitchDelta);\n\n    camera.lookAt({\n      yaw: yaw.val,\n      pitch: pitch.val,\n      zoom\n    });\n  }\n\n  private _updateQuaternion(camera: Camera, zoom: number) {\n    const input = this._input;\n    if (!input.enabled) return;\n\n    input.update();\n    camera.rotate(input.quaternion, zoom);\n  }\n}\n\nexport default GyroControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport CameraControl from \"./CameraControl\";\nimport RotateControl, { RotateControlEvents, RotateControlOptions } from \"./RotateControl\";\nimport ZoomControl, { ZoomControlOptions } from \"./ZoomControl\";\nimport GyroControl, { GyroControlOptions } from \"./GyroControl\";\nimport Camera from \"../core/Camera\";\nimport CameraAnimation from \"../core/CameraAnimation\";\nimport * as BROWSER from \"../const/browser\";\nimport { CAMERA_EVENTS, CONTROL_EVENTS } from \"../const/internal\";\nimport { ValueOf } from \"../type/utils\";\nimport { getObjectOption, hfovToZoom } from \"../utils\";\n\n/**\n * Options for {@link PanoControl}\n * @ko {@link PanoControl}용 옵션들\n * @since 4.0.0\n */\nexport interface PanoControlOptions {\n  /**\n   * @copy View360#useGrabCursor\n   */\n  useGrabCursor: boolean;\n  /**\n   * @copy View360#scrollable\n   */\n  scrollable: boolean;\n  /**\n   * @copy View360#wheelScrollable\n   */\n  wheelScrollable: boolean;\n  /**\n   * @copy View360#disableContextMenu\n   */\n  disableContextMenu: boolean;\n  /**\n   * Options for {@link RotateControl}.\n   * `false` to disable rotation.\n   * @ko {@link RotateControl}용 옵션들.\n   * `false`일 경우 회전이 비활성화됩니다.\n   * @since 4.0.0\n   */\n  rotate: boolean | Partial<RotateControlOptions>;\n  /**\n   * Options for {@link ZoomControl}.\n   * `false` to disable zoom.\n   * @ko {@link ZoomControl}용 옵션들.\n   * `false`일 경우 줌이 비활성화됩니다.\n   * @since 4.0.0\n   */\n  zoom: boolean | Partial<ZoomControlOptions>;\n  /**\n   * Options for {@link GyroControl}.\n   * `false` to disable gyroscope control.\n   * @ko {@link GyroControl}용 옵션들.\n   * `false`일 경우 자이로스코프를 통한 컨트롤이 비활성화됩니다.\n   * @since 4.0.0\n   */\n  gyro: boolean | Partial<GyroControlOptions>;\n}\n\n/**\n * Panorama control for View360\n * @ko View360용 파노라마 컨트롤\n * @since 4.0.0\n */\nclass PanoControl {\n  // Options\n  private _useGrabCursor: PanoControlOptions[\"useGrabCursor\"];\n  private _disableContextMenu: PanoControlOptions[\"disableContextMenu\"];\n\n  // Internal Values\n  private _camera: Camera;\n  private _controlEl: HTMLElement;\n  private _rotateControl: RotateControl;\n  private _zoomControl: ZoomControl;\n  private _gyroControl: GyroControl;\n  private _ignoreZoomScale: boolean;\n  private _enabled: boolean;\n\n  /**\n   * @copy View360#useGrabCursor\n   */\n  public get useGrabCursor() { return this._useGrabCursor; }\n  public set useGrabCursor(val: PanoControlOptions[\"useGrabCursor\"]) {\n    if (val === this._useGrabCursor) return;\n\n    this._useGrabCursor = val;\n\n    if (val && this._enabled) {\n      this._setCursor(BROWSER.CURSOR.GRAB);\n    } else if (!val) {\n      this._setCursor(BROWSER.CURSOR.NONE);\n    }\n  }\n\n  /**\n   * @copy View360#disableContextMenu\n   */\n  public get disableContextMenu() { return this._disableContextMenu; }\n  public set disableContextMenu(val: PanoControlOptions[\"disableContextMenu\"]) {\n    if (val === this._disableContextMenu) return;\n\n    this._disableContextMenu = val;\n\n    if (val && this._enabled) {\n      this._blockContextMenu();\n    } else if (!val) {\n      this._restoreContextMenu();\n    }\n  }\n\n  /**\n   * @copy View360#disableContextMenu\n   */\n  public get scrollable() { return this._rotateControl.scrollable; }\n  public set scrollable(val: PanoControlOptions[\"scrollable\"]) { this._rotateControl.scrollable = val; }\n  /**\n   * @copy View360#disableContextMenu\n   */\n  public get wheelScrollable() { return this._zoomControl.scrollable; }\n  public set wheelScrollable(val: PanoControlOptions[\"wheelScrollable\"]) { this._zoomControl.scrollable = val; }\n  /**\n   * When `true`, disables rotation slow-down by zoom-value.\n   * @ko `true`일 경우 줌 된 정도에 따라 회전속도를 늦추는 동작을 비활성화합니다.\n   * @since 4.0.0\n   */\n  public get ignoreZoomScale() { return this._ignoreZoomScale; }\n  public set ignoreZoomScale(val: boolean) { this._ignoreZoomScale = val; }\n\n  /**\n   * Whether the control is enabled or not\n   * @ko 컨트롤 활성화 여부를 가리키는 값\n   * @readonly\n   * @since 4.0.0\n   */\n  public get enabled() { return this._enabled; }\n  /**\n   * @copy View360#rotate\n   */\n  public get rotate() { return this._rotateControl; }\n  /**\n   * @copy View360#zoom\n   */\n  public get zoom() { return this._zoomControl; }\n  /**\n   * @copy View360#gyro\n   */\n  public get gyro() { return this._gyroControl; }\n\n  /**\n   * Whether one of the controls is animating at the moment\n   * @ko 현재 컨트롤 중 하나라도 동작중인지 여부를 나타내는 값\n   * @readonly\n   * @since 4.0.0\n   */\n  public get animating() {\n    return this._rotateControl.animating\n      || this._zoomControl.animating\n      || this._gyroControl.animating;\n  }\n\n  /**\n   * Create new instance.\n   * @ko 새 인스턴스를 생성합니다.\n   * @param element - Canvas element {@ko 캔버스 엘리먼트}\n   * @param camera - Camera instance {@ko Camera 인스턴스}\n   * @param options - Options for PanoControl {@ko PanoControl 옵션들}\n   */\n  public constructor(element: HTMLElement, camera: Camera, {\n    useGrabCursor,\n    scrollable,\n    wheelScrollable,\n    disableContextMenu,\n    rotate,\n    zoom,\n    gyro\n  }: PanoControlOptions) {\n    // Bind Options\n    this._useGrabCursor = useGrabCursor;\n    this._disableContextMenu = disableContextMenu;\n\n    // Set internal values\n    this._camera = camera;\n    this._controlEl = element;\n    this._ignoreZoomScale = false;\n    this._enabled = false;\n\n    this._rotateControl = new RotateControl(element, !rotate, getObjectOption(rotate));\n    this._zoomControl = new ZoomControl(element, !zoom, getObjectOption(zoom));\n    this._gyroControl = new GyroControl(!gyro, getObjectOption(gyro));\n\n    this._rotateControl.scrollable = scrollable;\n    this._zoomControl.scrollable = wheelScrollable;\n\n    this._bindEvents();\n  }\n\n  /**\n   * Destroy the instance and remove all event listeners attached.\n   * This also will reset CSS cursor to initial.\n   * @ko 인스턴스를 삭제하고 부착된 모든 이벤트 리스너를 제거합니다.\n   * 또한, 캔버스에 적용된 CSS cursor도 제거합니다.\n   * @since 4.0.0\n   */\n  public destroy(): void {\n    this.disable();\n    this._rotateControl.destroy();\n    this._zoomControl.destroy();\n    this._setCursor(BROWSER.CURSOR.NONE);\n  }\n\n  /**\n   * Resize control to match target size.\n   * @ko 컨트롤이 내부에 캐시하고 있는 크기값을 갱신합니다.\n   * @param width New width {@ko 변경된 너비}\n   * @param height New height {@ko 변경된 높이}\n   * @since 4.0.0\n   */\n  public resize(width: number, height: number): void {\n    const camera = this._camera;\n\n    this._rotateControl.resize(camera.fov, camera.aspect, width, height);\n  }\n\n  /**\n   * Enable this control and add event listeners.\n   * @ko 컨트롤을 활성화하고 이벤트 리스너들을 추가합니다.\n   * @since 4.0.0\n   */\n  public async enable(): Promise<void> {\n    if (this._enabled) return;\n\n    if (!this._rotateControl.enableBlocked) {\n      this._rotateControl.enable();\n    }\n\n    if (!this._zoomControl.enableBlocked) {\n      this._zoomControl.enable();\n    }\n\n    if (!this._gyroControl.enableBlocked) {\n      if (await GyroControl.isAvailable()) {\n        this._gyroControl.enable();\n      }\n    }\n\n    this.sync();\n\n    if (this._disableContextMenu) {\n      this._blockContextMenu();\n    }\n\n    this._enabled = true;\n  }\n\n  /**\n   * Disable this control and remove all event listeners\n   * @ko 컨트롤을 비활성화하고 모든 이벤트 리스너들을 제거합니다.\n   * @since 4.0.0\n   */\n  public disable(): void {\n    if (!this._enabled) return;\n\n    this._rotateControl.disable();\n    this._zoomControl.disable();\n    this._gyroControl.disable();\n\n    this._restoreContextMenu();\n\n    this._enabled = false;\n  }\n\n  /**\n   * Update control by given deltaTime\n   * @ko 컨트롤을 주어진 시간만큼 업데이트합니다.\n   * @param delta Number of milisec to update {@ko 업데이트할 시간, 밀리초 단위}\n   * @since 4.0.0\n   * @internal\n   */\n  public update(delta: number): void {\n    const camera = this._camera;\n    const rotateControl = this._rotateControl;\n    const zoomControl = this._zoomControl;\n    const gyroControl = this._gyroControl;\n\n    zoomControl.update(delta);\n    const zoom = hfovToZoom(camera.fov, zoomControl.zoom);\n\n    // Slow down rotation on zoom-in\n    const zoomScale = this._ignoreZoomScale ? 1 : Math.max(zoom, 1);\n    rotateControl.setZoomScale(zoomScale);\n    rotateControl.updateRange(camera, zoom);\n    rotateControl.update(delta);\n\n    const yaw = rotateControl.yaw;\n    const pitch = rotateControl.pitch;\n\n    if (gyroControl.enabled) {\n      gyroControl.update(camera, yaw, pitch, zoom);\n    } else {\n      camera.lookAt({\n        yaw: yaw.val,\n        pitch: pitch.val,\n        zoom\n      });\n    }\n  }\n\n  /**\n   * Synchronize this control's state to current camera state\n   * @ko 컨트롤을 카메라의 현재 상태와 동기화합니다.\n   * @since 4.0.0\n   */\n  public sync(): void {\n    const camera = this._camera;\n\n    this._zoomControl.sync(camera);\n    this._rotateControl.sync(camera);\n  }\n\n  private _blockContextMenu() {\n    const el = this._controlEl;\n\n    el.addEventListener(BROWSER.EVENTS.CONTEXT_MENU, this._preventContextMenu);\n  }\n\n  private _restoreContextMenu() {\n    const el = this._controlEl;\n\n    el.removeEventListener(BROWSER.EVENTS.CONTEXT_MENU, this._preventContextMenu);\n  }\n\n  private _preventContextMenu = (evt: MouseEvent) => {\n    evt.preventDefault();\n  };\n\n  private _setCursor(newCursor: ValueOf<typeof BROWSER.CURSOR>) {\n    if (!this._useGrabCursor && newCursor !== BROWSER.CURSOR.NONE) return;\n\n    const targetEl = this._controlEl;\n    targetEl.style.cursor = newCursor;\n  }\n\n  private _bindEvents() {\n    const rotateControl = this._rotateControl;\n    const zoomControl = this._zoomControl;\n\n    rotateControl.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    rotateControl.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n    rotateControl.on(CONTROL_EVENTS.ENABLE, this._onEnable);\n    rotateControl.on(CONTROL_EVENTS.DISABLE, this._onDisable);\n    zoomControl.on(CONTROL_EVENTS.ENABLE, this._onEnable);\n    zoomControl.on(CONTROL_EVENTS.DISABLE, this._onDisable);\n    this._camera.on(CAMERA_EVENTS.ANIMATION_END, this._onCameraAnimationEnd);\n  }\n\n  private _onInputStart = (evt: RotateControlEvents[typeof CONTROL_EVENTS.INPUT_START]) => {\n    if (this._useGrabCursor && !evt.isKeyboard) {\n      this._setCursor(BROWSER.CURSOR.GRABBING);\n    }\n  };\n\n  private _onInputEnd = (evt: RotateControlEvents[typeof CONTROL_EVENTS.INPUT_END]) => {\n    if (this._useGrabCursor && !evt.isKeyboard) {\n      this._setCursor(BROWSER.CURSOR.GRAB);\n    }\n  };\n\n  private _onEnable = ({\n    control,\n    updateCursor\n  }: {\n    control: CameraControl;\n    updateCursor: boolean;\n  }) => {\n    if (updateCursor && this._useGrabCursor) {\n      this._setCursor(BROWSER.CURSOR.GRAB);\n    }\n\n    control.sync(this._camera);\n  };\n\n  private _onDisable = ({\n    updateCursor\n  }: {\n    updateCursor: boolean\n  }) => {\n    if (updateCursor) {\n      this._setCursor(BROWSER.CURSOR.NONE);\n    }\n  };\n\n  private _onCameraAnimationEnd = ({ animation }: { animation: CameraAnimation }) => {\n    animation.getFinishPromise().then(() => {\n      this.sync();\n    });\n  };\n}\n\nexport default PanoControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport TextureVideo from \"./TextureVideo\";\nimport TextureCube from \"./TextureCube\";\n\n/**\n * @hidden\n */\nabstract class Texture {\n  public width: number;\n  public height: number;\n  public flipY: boolean;\n  public wrapS: number;\n  public wrapT: number;\n\n  public constructor({\n    width,\n    height,\n    flipY\n  }: {\n    width: number;\n    height: number;\n    flipY: boolean;\n  }) {\n    this.width = width;\n    this.height = height;\n    this.flipY = flipY;\n    this.wrapS = WebGLRenderingContext.CLAMP_TO_EDGE;\n    this.wrapT = WebGLRenderingContext.CLAMP_TO_EDGE;\n  }\n\n  public destroy() {\n    // DO_NOTHING\n  }\n\n  public isVideo(): this is TextureVideo {\n    return false;\n  }\n\n  public isCube(): this is TextureCube {\n    return false;\n  }\n}\n\nexport default Texture;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Texture from \"./Texture\";\n\n/**\n * @hidden\n */\nclass Texture2D extends Texture {\n  public source: Exclude<TexImageSource, ImageData>;\n\n  public constructor({\n    source,\n    width,\n    height,\n    flipY\n  }: {\n    source: Exclude<TexImageSource, ImageData>;\n    width: number;\n    height: number;\n    flipY: boolean;\n  }) {\n    super({\n      width,\n      height,\n      flipY\n    });\n\n    this.source = source;\n  }\n}\n\nexport default Texture2D;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Texture2D from \"./Texture2D\";\n\n/**\n * @hidden\n */\nclass TextureVideo extends Texture2D {\n  public source: HTMLVideoElement;\n\n  public destroy() {\n    const video = this.source;\n\n    video.pause();\n    video.removeAttribute(\"src\");\n    video.load();\n  }\n\n  public isVideo(): this is TextureVideo { return true; }\n\n  public isPaused() {\n    const video = this.source;\n\n    return video.paused || video.ended || video.readyState <= 2;\n  }\n\n  public hasAudio() {\n    const video = this.source as any;\n\n    if (video.audioTracks) {\n      return video.audioTracks.length > 0;\n    }\n\n    if (video.webkitAudioDecodedByteCount != null) {\n      return video.webkitAudioDecodedByteCount > 0;\n    }\n\n    if (video.mozHasAudio != null) {\n      return video.mozHasAudio;\n    }\n\n    // We don't know whether the video has audio or not, return true\n    return true;\n  }\n}\n\nexport default TextureVideo;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Texture from \"./Texture\";\n\n/**\n * @hidden\n */\nclass TextureCube extends Texture {\n  public sources: TexImageSource[];\n\n  public constructor({\n    sources,\n    width,\n    height,\n    flipY\n  }: {\n    sources: TexImageSource[];\n    width: number;\n    height: number;\n    flipY: boolean;\n  }) {\n    super({\n      width,\n      height,\n      flipY\n    });\n\n    this.sources = sources;\n  }\n\n  public isCube(): this is TextureCube { return true; }\n}\n\nexport default TextureCube;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ImReady from \"@egjs/imready\";\nimport Texture from \"../texture/Texture\";\nimport Texture2D from \"../texture/Texture2D\";\nimport TextureVideo from \"../texture/TextureVideo\";\nimport TextureCube from \"../texture/TextureCube\";\nimport { getObjectOption, isString } from \"../utils\";\nimport { VideoConfig } from \"../type/external\";\nimport { ProjectionOptions } from \"../projection/Projection\";\n\n/**\n * @hidden\n */\nclass TextureLoader {\n  private _loadChecker: ImReady;\n\n  constructor() {\n    this._loadChecker = new ImReady();\n  }\n\n  public async load(src: ProjectionOptions[\"src\"], video: ProjectionOptions[\"video\"]): Promise<Texture> {\n    if (video) {\n      return this.loadVideo(src, getObjectOption(video));\n    } else {\n      if (Array.isArray(src) && src.length > 1) {\n        return this.loadCubeImage(src);\n      } else {\n        const imgSrc = Array.isArray(src) ? src[0] : src;\n        return this.loadImage(imgSrc);\n      }\n    }\n  }\n\n  public async loadImage(src: string | HTMLElement): Promise<Texture2D> {\n    const images = this._toImageArray(src);\n\n    return this._load(images, resolve => {\n      const image = images[0];\n\n      resolve(new Texture2D({\n        source: image,\n        width: image.naturalWidth,\n        height: image.naturalHeight,\n        flipY: true\n      }));\n    });\n  }\n\n  public async loadCubeImage(src: Array<string | HTMLElement>): Promise<TextureCube> {\n    const images = this._toImageArray(src);\n\n    return this._load(images, resolve => {\n      resolve(new TextureCube({\n        sources: images,\n        width: images[0].naturalWidth,\n        height: images[0].naturalHeight,\n        flipY: false\n      }));\n    });\n  }\n\n  public async loadVideo(src: ProjectionOptions[\"src\"], videoConfig: Partial<VideoConfig>): Promise<TextureVideo> {\n    const config: VideoConfig = {\n      autoplay: true,\n      muted: true,\n      loop: false,\n      volume: 1,\n      ...videoConfig,\n    };\n    const video = this._toVideoElement(src, config);\n\n    return this._load([video], resolve => {\n      const { autoplay, muted } = config;\n\n      video.currentTime = 0;\n      if (autoplay && muted) {\n        video.play().catch(() => void 0);\n      }\n\n      resolve(new TextureVideo({\n        source: video,\n        width: video.videoWidth,\n        height: video.videoHeight,\n        flipY: true\n      }));\n    });\n  }\n\n  private _load<T>(content: HTMLElement[], onLoad: (resolve: (value: T) => void) => void): Promise<T> {\n    const loader = this._loadChecker;\n\n    return new Promise((resolve, reject) => {\n      loader.once(\"ready\", evt => {\n        if (evt.errorCount > 0) return;\n\n        onLoad(resolve);\n      });\n\n      loader.once(\"error\", reject);\n      loader.check(content);\n    });\n  }\n\n  private _toImageArray(src: ProjectionOptions[\"src\"]): HTMLImageElement[] {\n    const srcs = Array.isArray(src) ? src : [src];\n\n    return srcs.map(source => {\n      if (isString(source)) {\n        const imgEl = new Image();\n\n        imgEl.crossOrigin = \"anonymous\";\n        imgEl.src = source;\n\n        return imgEl;\n      } else {\n        return source as HTMLImageElement;\n      }\n    });\n  }\n\n  private _toVideoElement(src: ProjectionOptions[\"src\"], {\n    muted,\n    loop,\n    volume\n  }: VideoConfig): HTMLVideoElement {\n    if (src instanceof HTMLVideoElement) {\n      return src;\n    }\n\n    const video = document.createElement(\"video\");\n\n    video.crossOrigin = \"anonymous\";\n    video.playsInline = true;\n    video.setAttribute(\"webkit-playsinline\", \"\");\n    video.muted = muted;\n    video.volume = volume;\n    video.loop = loop;\n\n    if (Array.isArray(src)) {\n      src.forEach(source => this._appendSourceElement(video, source));\n    } else {\n      this._appendSourceElement(video, src);\n    }\n\n    const sourceCount = video.querySelectorAll(\"source\").length;\n    if (sourceCount > 0 && video.readyState < 1) {\n      video.load();\n    }\n\n    return video;\n  }\n\n  private _appendSourceElement(video: HTMLMediaElement, src: string | HTMLElement) {\n    if (src instanceof HTMLSourceElement) {\n      return src;\n    }\n\n    const sourceEl = document.createElement(\"source\");\n    sourceEl.src = src as string;\n    video.appendChild(sourceEl);\n  }\n}\n\nexport default TextureLoader;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n\n/**\n * @internal\n */\nclass FrameAnimator {\n  public maxDeltaTime: number;\n\n  private _context: Window | XRSession;\n  private _rafId: number;\n  private _rafTimer: number;\n  private _lastUpdateTime: number;\n\n  /** */\n  public constructor(maxDeltaTime: number, context: Window | XRSession = window) {\n    this.maxDeltaTime = maxDeltaTime;\n\n    this._context = context;\n    this._rafId = -1;\n    this._rafTimer = -1;\n    this._lastUpdateTime = -1;\n  }\n\n  public start(callback: (delta: number, ...args: any[]) => any) {\n    const context = this._context;\n\n    // No context / callback set\n    if (!context || !callback) return;\n\n    // Animation already started\n    if (this._rafId >= 0 || this._rafTimer >= 0) return;\n\n    const loop = (_time: number, frame?: XRFrame) => {\n      const time = Date.now();\n      const delta = Math.min(time - this._lastUpdateTime, this.maxDeltaTime * 1000);\n\n      callback(delta, frame);\n\n      this._lastUpdateTime = time;\n      this._rafId = context.requestAnimationFrame(loop);\n    };\n\n    this._lastUpdateTime = Date.now();\n    this._rafId = context.requestAnimationFrame(loop);\n  }\n\n  public stop() {\n    if (this._rafId >= 0) {\n      this._context.cancelAnimationFrame(this._rafId);\n    }\n\n    if (this._rafTimer >= 0) {\n      clearTimeout(this._rafTimer);\n    }\n\n    this._rafId = -1;\n    this._rafTimer = -1;\n  }\n\n  public changeContext(context: Window | XRSession) {\n    this.stop();\n    this._context = context;\n  }\n}\n\nexport default FrameAnimator;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport * as BROWSER from \"../const/browser\";\n\n/**\n * Automatic resizer that uses both ResizeObserver and window resize event\n */\nclass AutoResizer {\n  private _enabled: boolean;\n  private _resizeObserver: ResizeObserver | null;\n  private _useResizeObserver: boolean;\n  private _onResize: () => any;\n\n  public get useResizeObserver() { return this._useResizeObserver; }\n\n  /**\n   * Returns whether AutoResizer is enabled\n   */\n  public get enabled() { return this._enabled; }\n\n  /** */\n  public constructor(useResizeObserver: boolean, onResize: () => any) {\n    this._useResizeObserver = useResizeObserver;\n\n    this._enabled = false;\n    this._resizeObserver = null;\n    this._onResize = onResize;\n  }\n\n  /**\n   * Enable resizer\n   */\n  public enable(element: HTMLElement): this {\n    if (this._enabled) {\n      this.disable();\n    }\n\n    if (this._useResizeObserver && !!window.ResizeObserver) {\n      const bbox = element.getBoundingClientRect();\n      const resizeImmediate = bbox.width !== 0 || bbox.height !== 0;\n\n      const resizeObserver = new ResizeObserver(resizeImmediate ? this._skipFirstResize : this._onResize);\n\n      resizeObserver.observe(element);\n\n      this._resizeObserver = resizeObserver;\n    } else {\n      window.addEventListener(BROWSER.EVENTS.RESIZE, this._onResize);\n    }\n\n    this._enabled = true;\n\n    return this;\n  }\n\n  /**\n   * Disable resizer\n   */\n  public disable(): this {\n    if (!this._enabled) return this;\n\n    const resizeObserver = this._resizeObserver;\n    if (resizeObserver) {\n      resizeObserver.disconnect();\n      this._resizeObserver = null;\n    } else {\n      window.removeEventListener(BROWSER.EVENTS.RESIZE, this._onResize);\n    }\n\n    this._enabled = false;\n\n    return this;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/member-ordering\n  private _skipFirstResize = (() => {\n    let isFirstResize = true;\n\n    return (() => {\n      if (isFirstResize) {\n        isFirstResize = false;\n\n        return;\n      }\n      this._onResize();\n    });\n  })();\n}\n\nexport default AutoResizer;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Camera from \"./Camera\";\nimport PanoControl from \"../control/PanoControl\";\nimport View360 from \"../View360\";\nimport * as BROWSER from \"../const/browser\";\nimport { CONTROL_EVENTS } from \"../const/internal\";\nimport { circulate, getObjectOption } from \"../utils\";\n\n/**\n * Options for {@link Autoplay}\n * @ko {@link Autoplay}용 옵션들\n * @since 4.0.0\n */\nexport interface AutoplayOptions {\n  /**\n   * @copy Autoplay#delay\n   */\n  delay: number;\n  /**\n   * @copy Autoplay#delayOnMouseLeave\n   */\n  delayOnMouseLeave: number;\n  /**\n   * @copy Autoplay#speed\n   */\n  speed: number;\n  /**\n   * @copy Autoplay#pauseOnHover\n   */\n  pauseOnHover: boolean;\n  /**\n   * @copy Autoplay#canInterrupt\n   */\n  canInterrupt: boolean;\n  /**\n   * @copy Autoplay#disableOnInterrupt\n   */\n  disableOnInterrupt: boolean;\n}\n\n/**\n * A manager class for autoplay feature.\n * @ko Autoplay 기능의 매니저 클래스.\n * @since 4.0.0\n */\nclass Autoplay {\n  // Options\n  private _delay: number;\n  private _delayOnMouseLeave: number;\n  private _speed: number;\n  private _pauseOnHover: boolean;\n  private _canInterrupt: boolean;\n  private _disableOnInterrupt: boolean;\n\n  // Internal values\n  private _enableBlocked: boolean;\n  private _camera: Camera;\n  private _control: PanoControl;\n  private _element: HTMLElement;\n  private _enabled: boolean;\n  private _interrupted: boolean;\n  private _interruptionTimer: number;\n  private _hovering: boolean;\n\n  /**\n   * Whether autoplay is enabled or not\n   * @ko 자동재생 활성화 여부를 나타내는 값\n   * @readonly\n   * @since 4.0.0\n   */\n  public get enabled() { return this._enabled; }\n  /**\n   * @hidden\n   */\n  public get enableBlocked() { return this._enableBlocked; }\n  /**\n   * Whether autoplay is updating the camera at the moment\n   * @ko 현재 자동재생이 동작중인지 여부를 나타내는 값\n   * @readonly\n   * @since 4.0.0\n   */\n  public get playing() {\n    return this._enabled && !this._interrupted;\n  }\n\n  /**\n   * Reactivation delay after mouse input in milisecond.\n   * @ko 재활성화되기까지의 시간 (밀리초 단위)\n   * @default 2000\n   * @since 4.0.0\n   */\n  public get delay() { return this._delay; }\n  public set delay(val: number) { this._delay = val; }\n\n  /**\n   * Reactivation delay after mouse leave when using {@link AutoplayOptions#pauseOnHover}\n   * @ko {@link AutoplayOptions#pauseOnHover} 사용시 마우스가 캔버스 영역을 떠난 뒤 자동재생이 다시 활성화되기까지의 시간\n   * @default 0\n   * @since 4.0.0\n   */\n  public get delayOnMouseLeave() { return this._delayOnMouseLeave; }\n  public set delayOnMouseLeave(val: number) { this._delayOnMouseLeave = val; }\n\n  /**\n   * Y-axis(yaw) rotation speed\n   * @ko Y-축 회전(yaw)의 속도\n   * @default 1\n   * @since 4.0.0\n   */\n  public get speed() { return this._speed; }\n  public set speed(val: number) { this._speed = val; }\n\n  /**\n   * Whether to pause rotation on mouse hover\n   * @ko 마우스가 캔버스 영역에 들어왔을 때 자동재생을 정지할지 여부\n   * @default false\n   * @since 4.0.0\n   */\n  public get pauseOnHover() { return this._pauseOnHover; }\n  public set pauseOnHover(val: boolean) { this._pauseOnHover = val; }\n\n  /**\n   * Whether user can interrupt the rotation with click/wheel input\n   * @ko 클릭이나 휠같은 사용자 인터랙션시 자동재생을 멈출지 여부\n   * @default true\n   * @since 4.0.0\n   */\n  public get canInterrupt() { return this._canInterrupt; }\n  public set canInterrupt(val: boolean) { this._canInterrupt = val; }\n\n  /**\n   * Whether to disable autoplay on user interrupt\n   * @ko 사용자 동작에 의해 자동재생이 정지할 때, {@link Autoplay#disable}을 호출하여 자동재생을 영구히 정지할지 여부\n   * @default false\n   * @since 4.0.0\n   */\n  public get disableOnInterrupt() { return this._disableOnInterrupt; }\n  public set disableOnInterrupt(val: boolean) { this._disableOnInterrupt = val; }\n\n  /**\n   * Create new AutoPlayer instance\n   * @param camera - Instance of the {@link Camera} {@ko Camera의 인스턴스}\n   * @param element - Canvas element {@ko 캔버스 엘리먼트}\n   * @param options - Autoplay options {@ko 자동재생 옵션들}\n   * @since 4.0.0\n   */\n  public constructor(viewer: View360, element: HTMLElement, options: boolean | Partial<AutoplayOptions>) {\n    this._camera = viewer.camera;\n    this._control = viewer.control;\n    this._element = element;\n\n    this._enabled = false;\n    this._interrupted = false;\n    this._interruptionTimer = -1;\n    this._hovering = false;\n\n    const {\n      delay = 2000,\n      delayOnMouseLeave = 0,\n      speed = 1,\n      pauseOnHover = false,\n      canInterrupt = true,\n      disableOnInterrupt = false\n    } = getObjectOption(options);\n\n    this._enableBlocked = !options;\n    this._delay = delay;\n    this._delayOnMouseLeave = delayOnMouseLeave;\n    this._speed = speed;\n    this._pauseOnHover = pauseOnHover;\n    this._canInterrupt = canInterrupt;\n    this._disableOnInterrupt = disableOnInterrupt;\n  }\n\n  /**\n   * Destroy the instance and remove all event listeners attached\n   * @ko 인스턴스를 제거하고 연결된 모든 이벤트 핸들러를 삭제합니다.\n   * @since 4.0.0\n   */\n  public destroy(): void {\n    this.disable();\n  }\n\n  /**\n   * Rotate camera by given deltaTime\n   * @ko 주어진 deltaTime만큼 카메라를 회전시킵니다.\n   * @param deltaTime - Number of milisec to update {@ko 업데이트할 시간, 밀리초 단위}\n   * @since 4.0.0\n   */\n  public update(deltaTime: number): void {\n    if (!this._enabled) return;\n    if (this._interrupted) {\n      if (this._disableOnInterrupt) {\n        this.disable();\n      }\n\n      return;\n    }\n\n    const camera = this._camera;\n    const delta = -this._speed * deltaTime / 100;\n\n    camera.yaw = circulate(camera.yaw + delta, 0, 360);\n  }\n\n  /**\n   * Enable autoplay and add event listeners.\n   * @ko 자동재생을 활성화하고 이벤트리스너들을 추가합니다.\n   * @since 4.0.0\n   */\n  public enable(): void {\n    const control = this._control;\n    const element = this._element;\n\n    if (this._enabled || control.gyro.enabled) return;\n\n    control.rotate.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    control.rotate.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    control.zoom.on(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    control.zoom.on(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    control.gyro.on(CONTROL_EVENTS.ENABLE, this._onGyroEnable);\n\n    element.addEventListener(BROWSER.EVENTS.MOUSE_ENTER, this._onMouseEnter, false);\n    element.addEventListener(BROWSER.EVENTS.MOUSE_LEAVE, this._onMouseLeave, false);\n\n    this._enabled = true;\n    this._enableBlocked = false;\n  }\n\n  /**\n   * Enable autoplay after current `delay` value.\n   * @ko 현재의 `delay`값만큼 시간이 지난 다음에 자동재생을 활성화합니다.\n   * @since 4.0.0\n   */\n  public enableAfterDelay() {\n    this.enable();\n    this._interrupted = true;\n    this._setUninterruptedAfterDelay(this._delay);\n  }\n\n  /**\n   * Disable autoplay and remove all event handlers.\n   * @ko 자동재생을 비활성화하고 모든 이벤트 핸들러를 제거합니다.\n   * @since 4.0.0\n   */\n  public disable(): void {\n    if (!this._enabled) return;\n\n    const control = this._control;\n    const element = this._element;\n\n    control.rotate.off(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    control.rotate.off(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    control.zoom.off(CONTROL_EVENTS.INPUT_START, this._onInputStart);\n    control.zoom.off(CONTROL_EVENTS.INPUT_END, this._onInputEnd);\n\n    control.gyro.off(CONTROL_EVENTS.ENABLE, this._onGyroEnable);\n\n    element.removeEventListener(BROWSER.EVENTS.MOUSE_ENTER, this._onMouseEnter, false);\n    element.removeEventListener(BROWSER.EVENTS.MOUSE_LEAVE, this._onMouseLeave, false);\n\n    this._enabled = false;\n    this._interrupted = false;\n    this._hovering = false;\n\n    this._clearTimeout();\n  }\n\n  private _onInputStart = () => {\n    if (!this._canInterrupt) return;\n\n    this._interrupted = true;\n    this._clearTimeout();\n  };\n\n  private _onInputEnd = () => {\n    this._setUninterruptedAfterDelay(this._delay);\n  };\n\n  private _onGyroEnable = () => {\n    this.disable();\n  };\n\n  private _onMouseEnter = () => {\n    if (!this._pauseOnHover) return;\n    this._interrupted = true;\n    this._hovering = true;\n  };\n\n  private _onMouseLeave = () => {\n    if (!this._pauseOnHover) return;\n    this._hovering = false;\n    this._setUninterruptedAfterDelay(this._delayOnMouseLeave);\n  };\n\n  private _setUninterruptedAfterDelay(delay: number): void {\n    if (this._hovering) return;\n\n    this._clearTimeout();\n\n    if (delay > 0) {\n      this._interruptionTimer = window.setTimeout(() => {\n        this._interrupted = false;\n        this._interruptionTimer = -1;\n      }, delay);\n    } else {\n      this._interrupted = false;\n      this._interruptionTimer = -1;\n    }\n  }\n\n  private _clearTimeout(): void {\n    if (this._interruptionTimer >= 0) {\n      window.clearTimeout(this._interruptionTimer);\n      this._interruptionTimer = -1;\n    }\n  }\n}\n\nexport default Autoplay;\n","import { mat4 } from \"gl-matrix\";\nimport Component from \"@egjs/component\";\nimport WebGLContext from \"./WebGLContext\";\nimport GyroControl from \"../control/GyroControl\";\nimport * as BROWSER from \"../const/browser\";\nimport { SESSION_VR, XR_REFERENCE_SPACE } from \"../const/internal\";\nimport { EVENTS } from \"../const/external\";\n\ninterface XRSessionOptions extends XRSessionInit {\n  [key: string]: any;\n}\n\n/**\n * WebXR manager class\n * @ko WebXR 매니저 클래스\n * @since 4.0.0\n */\nclass XRManager extends Component<{\n  /**\n   * An event that fires on entering VR session\n   * @ko VR 세션 진입시에 트리거되는 이벤트\n   * @eventName vrStart\n   * @eventOf XRManager\n   * @version 4.0.0\n   */\n  [EVENTS.VR_START]: {\n    session: XRSession;\n  };\n  /**\n   * An event that fires on exiting VR session\n   * @ko VR 세션에서 나갈 때 트리거되는 이벤트\n   * @eventName vrEnd\n   * @eventOf XRManager\n   * @version 4.0.0\n   */\n  [EVENTS.VR_END]: void;\n}> {\n  private _ctx: WebGLContext;\n  private _xrSession: XRSession | null;\n  private _xrRefSpace: XRReferenceSpace | null;\n  private _options: XRSessionOptions;\n\n  /**\n   * Create new instance.\n   * 새 인스턴스를 생성합니다.\n   * @param ctx - Instance of WebGL context helper {@ko WebGL 콘텍스트 헬퍼의 인스턴스}\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor(ctx: WebGLContext, options: XRSessionOptions = {}) {\n    super();\n\n    this._xrSession = null;\n    this._xrRefSpace = null;\n    this._ctx = ctx;\n    this._options = options;\n  }\n\n  /**\n   * Destroy instance and end XR session if there was any.\n   * @ko 인스턴스를 제거하고, XR 세션이 존재할 경우 종료합니다.\n   * @since 4.0.0\n   */\n  public destroy = () => {\n    this.exit();\n    this.off();\n  };\n\n  /**\n   * Returns WebXR availability.\n   * @ko WebXR 사용 가능 여부를 반환합니다.\n   * @since 4.0.0\n   */\n  public async isAvailable(): Promise<boolean> {\n    // eslint-disable-next-line compat/compat\n    const xr = window.navigator.xr;\n    if (!xr) return false;\n\n    return xr.isSessionSupported(SESSION_VR)\n      .then(available => {\n        return available;\n      }).catch(() => {\n        return false;\n      });\n  }\n\n  /**\n   * Enter VR session\n   * @ko VR 세션에 진입합니다.\n   * @since 4.0.0\n   */\n  public async enter() {\n    const ctx = this._ctx;\n\n    // eslint-disable-next-line compat/compat\n    const xr = window.navigator.xr;\n    if (!xr) return;\n\n    await GyroControl.requestSensorPermission();\n\n    const options = {\n      ...{\n        requiredFeatures: [XR_REFERENCE_SPACE]\n      },\n      ...this._options\n    };\n\n    await ctx.makeXRCompatible();\n\n    const session = await xr.requestSession(SESSION_VR, options);\n    ctx.bindXRLayer(session);\n\n    const refSpace = await session.requestReferenceSpace(XR_REFERENCE_SPACE);\n\n    this._setSession(session, refSpace);\n\n    this.trigger(EVENTS.VR_START, {\n      session\n    });\n  }\n\n  /**\n   * Exit VR session\n   * @ko VR 세션에서 나갑니다.\n   * @since 4.0.0\n   */\n  public exit() {\n    const xrSession = this._xrSession;\n\n    if (xrSession) {\n      xrSession.end()\n        .catch(() => void 0);\n    }\n\n    this._xrSession = null;\n    this._xrRefSpace = null;\n  }\n\n  /**\n   * @hidden\n   */\n  public canRender(frame: XRFrame) {\n    const refSpace = this._xrRefSpace;\n\n    if (!refSpace) return false;\n\n    const pose = frame.getViewerPose(refSpace);\n\n    return !!pose;\n  }\n\n  /**\n   * @hidden\n   */\n  public getEyeParams(frame: XRFrame): Array<{\n    viewport: XRViewport;\n    vMatrix: mat4;\n    pMatrix: mat4;\n  }> | null {\n    const session = frame.session;\n    const pose = frame.getViewerPose(this._xrRefSpace!);\n\n    if (!pose) return null;\n\n    const glLayer = session.renderState.baseLayer;\n\n    if (!glLayer) return null;\n\n    return pose.views.map(view => {\n      const viewport = glLayer.getViewport(view)!;\n      const vMatrix = view.transform.inverse.matrix;\n\n      return {\n        viewport,\n        vMatrix,\n        pMatrix: view.projectionMatrix\n      };\n    });\n  }\n\n  private _setSession(session: XRSession, refSpace: XRReferenceSpace) {\n    this._xrSession = session;\n    this._xrRefSpace = refSpace;\n\n    session.addEventListener(BROWSER.EVENTS.XR_END, this._onSessionEnd);\n  }\n\n  private _onSessionEnd = () => {\n    this.exit();\n    this.trigger(EVENTS.VR_END);\n  }\n}\n\nexport default XRManager;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { vec3 } from \"gl-matrix\";\n\n/**\n * Hotspot data\n * @ko 핫스팟 데이터\n * @since 4.0.0\n */\nclass Hotspot {\n  /**\n   * HTMLElement of the hotspot\n   * @ko 핫스팟의 HTMLElement\n   * @since 4.0.0\n   */\n  public readonly element: HTMLElement;\n  /**\n   * Position to render hotspot\n   * @ko 핫스팟을 렌더링할 위치\n   * @since 4.0.0\n   */\n  public readonly position: vec3;\n\n  public constructor(element: HTMLElement, position: vec3) {\n    this.element = element;\n    this.position = position;\n  }\n}\n\nexport default Hotspot;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { vec2, vec3 } from \"gl-matrix\";\nimport Hotspot from \"./Hotspot\";\nimport Camera from \"../core/Camera\";\nimport WebGLRenderer from \"../core/WebGLRenderer\";\nimport View360Error from \"../core/View360Error\";\nimport { getNullableElement } from \"../utils\";\nimport ERROR from \"../const/error\";\nimport { DEFAULT_CLASS } from \"../const/external\";\nimport { DEG_TO_RAD } from \"../const/internal\";\n\n/**\n * Options for {@link HotspotRenderer}\n * @ko {@link HotspotRenderer}용 옵션들\n * @since 4.0.0\n */\nexport interface HotspotOptions {\n  /**\n   * Apply scale for hotspots, makes their size sync with background panorama image.\n   * @ko 핫스팟에 스케일을 적용해서 배경 파노라마 이미지의 크기 변화와 동일하게 크기를 조절합니다.\n   * @since 4.0.0\n   */\n  zoom: boolean;\n}\n\n/**\n * Hotspot renderer\n * @ko Hotspot 렌더러\n * @since 4.0.0\n */\nclass HotspotRenderer {\n  // Options\n  private _zoom: HotspotOptions[\"zoom\"];\n\n  // Internal properties\n  private _containerEl: HTMLElement | null;\n  private _renderer: WebGLRenderer;\n  private _hotspots: Hotspot[];\n\n  /**\n   * Create new instance\n   * @ko 새 인스턴스를 생성합니다.\n   * @param rootEl - Container element for hotspots {@ko 핫스팟들의 컨테이너 엘리먼트}\n   * @param renderer - instance of WebGLRenderer {@ko WebGLRenderer의 인스턴스}\n   * @param options - Hotspot options {@ko Hotspot 옵션들 }\n   */\n  public constructor(rootEl: HTMLElement, renderer: WebGLRenderer, {\n    zoom = false\n  }: Partial<HotspotOptions>) {\n    this._containerEl = getNullableElement(`.${DEFAULT_CLASS.HOTSPOT_CONTAINER}`, rootEl);\n    this._renderer = renderer;\n    this._hotspots = [];\n\n    this._zoom = zoom;\n  }\n\n  /**\n   * Refresh hotspots by collecting hotspot elements from current hotspot root element\n   * @ko 현재 핫스팟 루트 엘리먼트 내에서 핫스팟 엘리먼트들을 수집하여 갱신합니다.\n   * @throws {ERROR_CODES.INSUFFICIENT_ARGS} if data-position doesn't include all x, y, z values {@ko data-position이 x, y, z좌표를 전부 포함하고 있지 않을 때}\n   */\n  public refresh() {\n    const container = this._containerEl;\n    if (!container) return;\n\n    const hotspotEls = [].slice.apply(container.querySelectorAll(`.${DEFAULT_CLASS.HOTSPOT}`)) as HTMLElement[];\n    this._hotspots = hotspotEls.map(el => this._parseHotspot(el));\n  }\n\n  /**\n   * Render hotspots\n   * @ko 핫스팟들을 렌더링합니다.\n   * @param camera - Instance of Camera {@ko Camera의 인스턴스}\n   */\n  public render(camera: Camera) {\n    const hotspots = this._hotspots;\n    const halfWidth = this._renderer.width * 0.5;\n    const halfHeight = this._renderer.height * 0.5;\n    const zoom = camera.zoom;\n    const centerTransform = \"translate(-50%, -50%)\";\n    const zoomTransform = this._zoom ? `scale(${zoom})` : \"\";\n\n    hotspots.forEach(hotspot => {\n      const position = hotspot.position;\n      const relPos = vec3.create();\n\n      vec3.copy(relPos, position);\n      vec3.transformMat4(relPos, relPos, camera.viewMatrix);\n      vec3.transformMat4(relPos, relPos, camera.projectionMatrix);\n\n      if (relPos[2] > 1 || relPos[2] < 0) {\n        hotspot.element.classList.remove(DEFAULT_CLASS.HOTSPOT_VISIBLE);\n        return;\n      }\n\n      const screenPos = vec2.fromValues(\n        relPos[0] * halfWidth + halfWidth,\n        -relPos[1] * halfHeight + halfHeight\n      );\n\n      hotspot.element.classList.add(DEFAULT_CLASS.HOTSPOT_VISIBLE);\n      hotspot.element.style.transform = [\n        centerTransform,\n        `translate(${screenPos[0]}px, ${screenPos[1]}px)`,\n        zoomTransform\n      ].join(\" \");\n    });\n  }\n\n  private _parseHotspot(element: HTMLElement): Hotspot {\n    const yawStr = element.dataset.yaw;\n    const pitchStr = element.dataset.pitch;\n    const positionStr = element.dataset.position;\n\n    if (yawStr || pitchStr) {\n      const yaw = yawStr ? parseFloat(yawStr) : 0;\n      const pitch = pitchStr ? parseFloat(pitchStr) : 0;\n\n      const position = this._yawPitchToVec3(yaw, pitch);\n\n      return new Hotspot(element, position);\n    } else if (positionStr) {\n      const pos: number[] = positionStr.split(\" \").map(val => parseFloat(val));\n      if (pos.length < 3) {\n        throw new View360Error(ERROR.MESSAGES.INSUFFICIENT_ARGS(positionStr, \"hotspot attribute \\\"data-position\\\"\"), ERROR.CODES.INSUFFICIENT_ARGS);\n      }\n\n      return new Hotspot(element, vec3.fromValues(pos[0], pos[1], pos[2]));\n    } else {\n      // Place hotspot at yaw: 0, pitch: 0\n      const defaultPos = vec3.fromValues(0, 0, -1);\n\n      return new Hotspot(element, defaultPos);\n    }\n  }\n\n  private _yawPitchToVec3(yaw: number, pitch: number) {\n    const yawRad = yaw * DEG_TO_RAD;\n    const pitchRad = pitch * DEG_TO_RAD;\n    const position = vec3.create();\n\n    position[1] = Math.sin(pitchRad);\n    position[2] = Math.cos(pitchRad);\n\n    position[0] = position[2] * Math.sin(-yawRad);\n    position[2] = -position[2] * Math.cos(-yawRad);\n\n    return position;\n  }\n}\n\nexport default HotspotRenderer;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Geometry from \"../geometry/Geometry\";\nimport { VAO } from \"../type/internal\";\n\n/**\n * @hidden\n */\nclass VertexArrayObject {\n  public readonly obj: VAO | null;\n  public readonly geometry: Geometry;\n  public readonly buffers: {\n    indicies: WebGLBuffer;\n    position: WebGLBuffer;\n    uv: WebGLBuffer;\n  }\n\n  public get count() { return this.geometry.indicies.count; }\n\n  constructor(obj: VAO | null, geometry: Geometry, buffers: VertexArrayObject[\"buffers\"]) {\n    this.obj = obj;\n    this.geometry = geometry;\n    this.buffers = buffers;\n  }\n}\n\nexport default VertexArrayObject;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { mat4 } from \"gl-matrix\";\nimport Uniform from \"../uniform/Uniform\";\nimport Camera from \"./Camera\";\nimport Object3D from \"./Object3D\";\nimport ShaderProgram from \"./ShaderProgram\";\nimport View360Error from \"./View360Error\";\nimport VertexArrayObject from \"./VertexArrayObject\";\nimport VertexData from \"./VertexData\";\nimport Texture from \"../texture/Texture\";\nimport Geometry from \"../geometry/Geometry\";\nimport * as BROWSER from \"../const/browser\";\nimport ERROR from \"../const/error\";\nimport { DEFAULT_CLASS } from \"../const/external\";\nimport { UniformLocations } from \"../type/internal\";\n\n/**\n * @hidden\n */\nclass WebGLContext {\n  private _canvas: HTMLCanvasElement;\n  private _gl: WebGLRenderingContext | WebGL2RenderingContext;\n  private _contextLost: boolean;\n  private _maxTextureSize: number;\n  private _isWebGL2: boolean;\n  private _debug: boolean;\n  private _extensions: {\n    vao: OES_vertex_array_object | null;\n    loseContext: WEBGL_lose_context | null;\n  };\n\n  public get canvas() { return this._canvas; }\n  public get maxTextureSize() { return this._maxTextureSize; }\n  public get isWebGL2() { return this._isWebGL2; }\n  public get supportVAO() { return this._isWebGL2 || !!this._extensions.vao; }\n  public get lost() { return this._contextLost; }\n  public get debug() { return this._debug; }\n\n  public constructor(canvas: HTMLCanvasElement, debug: boolean) {\n    this._canvas = canvas;\n    this._contextLost = false;\n    this._debug = debug;\n    this._extensions = {\n      vao: null,\n      loseContext: null\n    };\n  }\n\n  public init() {\n    const canvas = this._canvas;\n\n    const { gl, isWebGL2 } = this._getContext(canvas);\n\n    this._gl = gl;\n    this._maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n    this._isWebGL2 = isWebGL2;\n\n    if (!this._isWebGL2) {\n      this._extensions.vao = gl.getExtension(\"OES_vertex_array_object\");\n    }\n\n    this._extensions.loseContext = gl.getExtension(\"WEBGL_lose_context\");\n\n    canvas.addEventListener(BROWSER.EVENTS.CONTEXT_LOST, this._onContextLost);\n    canvas.addEventListener(BROWSER.EVENTS.CONTEXT_RESTORED, this._onContextRestore);\n\n    // gl.enable(gl.DEPTH_TEST);\n  }\n\n  public destroy() {\n    const gl = this._gl;\n    const canvas = this._canvas;\n\n    if (gl) {\n      // gl is not defined when destroy is called before init\n      gl.bindBuffer(gl.ARRAY_BUFFER, null);\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n    }\n\n    canvas.removeEventListener(BROWSER.EVENTS.CONTEXT_LOST, this._onContextLost);\n    canvas.removeEventListener(BROWSER.EVENTS.CONTEXT_RESTORED, this._onContextRestore);\n  }\n\n  public forceLoseContext() {\n    const extension = this._extensions.loseContext;\n\n    if (!extension) return;\n\n    extension.loseContext();\n  }\n\n  public forceRestoreContext() {\n    const extension = this._extensions.loseContext;\n\n    if (!extension) return;\n\n    extension.restoreContext();\n  }\n\n  public clear() {\n    const gl = this._gl;\n\n    gl.clear(gl.COLOR_BUFFER_BIT);\n  }\n\n  public resize() {\n    const gl = this._gl;\n\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n  }\n\n  public viewport(x: number, y: number, width: number, height: number) {\n    const gl = this._gl;\n\n    gl.viewport(x, y, width, height);\n  }\n\n  public createVAO(geometry: Geometry, shaderProgram: ShaderProgram) {\n    const nativeVAO = this._createNativeVAO();\n\n    const vao = new VertexArrayObject(nativeVAO, geometry, {\n      indicies: this._createBuffer(),\n      position: this._createBuffer(),\n      uv: this._createBuffer()\n    });\n\n    if (nativeVAO) {\n      this._bindNativeVAO(nativeVAO);\n      this._supplyGeometryData(vao, shaderProgram);\n      this._bindNativeVAO(null);\n      this._unbindBuffers();\n    }\n\n    return vao;\n  }\n\n  public draw(vao: VertexArrayObject, shaderProgram: ShaderProgram) {\n    const gl = this._gl;\n\n    if (vao.obj) {\n      this._bindNativeVAO(vao.obj);\n    } else {\n      this._supplyGeometryData(vao, shaderProgram);\n    }\n\n    gl.drawElements(gl.TRIANGLES, vao.count, gl.UNSIGNED_SHORT, 0);\n\n    if (vao.obj) {\n      this._bindNativeVAO(null);\n    } else {\n      this._unbindBuffers();\n    }\n  }\n\n  public releaseVAO(vao: VertexArrayObject) {\n    if (vao.obj) {\n      this._deleteNativeVAO(vao.obj);\n    }\n\n    this._deleteBuffer(vao.buffers.indicies);\n    this._deleteBuffer(vao.buffers.position);\n    this._deleteBuffer(vao.buffers.uv);\n  }\n\n  public getUniformLocations<T extends Record<string, Uniform>>(program: WebGLProgram, uniforms: T): UniformLocations<T> {\n    const gl = this._gl;\n\n    const uniformLocations = Object.keys(uniforms).reduce((locations, key) => {\n      locations[key as keyof T] = gl.getUniformLocation(program, key)!;\n\n      return locations;\n    }, {} as UniformLocations<T>);\n\n    return {\n      ...this._getCommonUniformLocations(program),\n      ...uniformLocations\n    };\n  }\n\n  public updateCommonUniforms(entity: Object3D, camera: Camera, shaderProgram: ShaderProgram) {\n    const gl = this._gl;\n\n    const uniformLocations = shaderProgram.uniformLocations;\n\n    // We're using \"matrix\"(=local matrix) here for efficiency\n    // As projection doesn't require world matrix, as it doesn't have any parent or child\n    const matrix = entity.matrix;\n    const mvMatrix = mat4.create();\n    mat4.multiply(mvMatrix, camera.viewMatrix, matrix);\n\n    gl.uniformMatrix4fv(uniformLocations.uMVMatrix, false, mvMatrix);\n    gl.uniformMatrix4fv(uniformLocations.uPMatrix, false, camera.projectionMatrix);\n  }\n\n  public updateVRUniforms(shaderProgram: ShaderProgram, mvMatrix: mat4, pMatrix: mat4, eyeIndex: number) {\n    const gl = this._gl;\n\n    const uniformLocations = shaderProgram.uniformLocations;\n\n    gl.uniformMatrix4fv(uniformLocations.uMVMatrix, false, mvMatrix);\n    gl.uniformMatrix4fv(uniformLocations.uPMatrix, false, pMatrix);\n\n    if (uniformLocations.uEye) {\n      gl.uniform1f(uniformLocations.uEye, eyeIndex);\n    }\n  }\n\n  public updateUniforms(shaderProgram: ShaderProgram) {\n    const gl = this._gl;\n\n    const uniforms = shaderProgram.uniforms;\n    const uniformLocations = shaderProgram.uniformLocations;\n\n    for (const key in uniforms) {\n      const uniform = uniforms[key];\n      const location = uniformLocations[key];\n\n      if (!uniform) continue;\n\n      if (uniform.needsUpdate) {\n        uniform.update(gl, location, this._isWebGL2);\n      }\n    }\n  }\n\n  public releaseShaderResources(shaderProgram: ShaderProgram) {\n    const gl = this._gl;\n\n    const uniforms = shaderProgram.uniforms;\n\n    for (const key in uniforms) {\n      const uniform = uniforms[key];\n\n      if (!uniform) continue;\n\n      if (uniform.needsUpdate) {\n        uniform.destroy(gl);\n      }\n    }\n\n    gl.deleteProgram(shaderProgram.program);\n  }\n\n  public useProgram(shaderProgram: ShaderProgram) {\n    const gl = this._gl;\n\n    gl.useProgram(shaderProgram.program);\n  }\n\n  public createProgram(vertexShader: string, fragmentShader: string) {\n    const gl = this._gl;\n    const program = gl.createProgram()!;\n\n    const vs = this._compileShader(gl.VERTEX_SHADER, vertexShader);\n    const fs = this._compileShader(gl.FRAGMENT_SHADER, fragmentShader);\n\n    gl.attachShader(program, vs);\n    gl.attachShader(program, fs);\n    gl.bindAttribLocation(program, 0, \"position\");\n    gl.bindAttribLocation(program, 1, \"uv\");\n    gl.linkProgram(program);\n\n    if (this._debug && !gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      let shaderLog: string | null = null;\n\n      if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)) {\n        shaderLog = gl.getShaderInfoLog(vs);\n      } else if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)) {\n        shaderLog = gl.getShaderInfoLog(fs);\n      }\n\n      throw new View360Error(ERROR.MESSAGES.FAILED_LINKING_PROGRAM(gl.getProgramInfoLog(program), shaderLog), ERROR.CODES.FAILED_LINKING_PROGRAM);\n    }\n\n    gl.deleteShader(vs);\n    gl.deleteShader(fs);\n\n    return program;\n  }\n\n  public createWebGLTexture(texData: Texture): WebGLTexture {\n    const gl = this._gl;\n    const texture = gl.createTexture()!;\n\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, texData.wrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, texData.wrapT);\n\n    if (!texData.isVideo() && this._isWebGL2) {\n      const gl2 = gl as WebGL2RenderingContext;\n\n      gl2.texStorage2D(gl2.TEXTURE_2D, 1, gl2.RGBA8, texData.width, texData.height);\n    }\n\n    return texture;\n  }\n\n  public createWebGLCubeTexture(texData: Texture, size: number): WebGLTexture {\n    const gl = this._gl;\n    const texture = gl.createTexture()!;\n\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, texData.wrapS);\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, texData.wrapT);\n\n    if (this._isWebGL2) {\n      const gl2 = gl as WebGL2RenderingContext;\n\n      gl2.texStorage2D(gl2.TEXTURE_CUBE_MAP, 1, gl2.RGBA8, size, size);\n    }\n\n    return texture;\n  }\n\n  public async makeXRCompatible() {\n    const gl = this._gl;\n    const attributes = gl.getContextAttributes();\n\n    if (attributes && attributes.xrCompatible !== true) {\n      await gl.makeXRCompatible();\n    }\n  }\n\n  public bindXRLayer(session: XRSession) {\n    const gl = this._gl;\n    const xrLayer = new XRWebGLLayer(session, gl);\n    session.updateRenderState({ baseLayer: xrLayer });\n  }\n\n  public bindXRFrame(frame: XRFrame) {\n    const gl = this._gl;\n    const session = frame.session;\n    const baseLayer = session.renderState.baseLayer!;\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, baseLayer.framebuffer);\n  }\n\n  public useDefaultFrameBuffer() {\n    const gl = this._gl;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  }\n\n  private _createBuffer(): WebGLBuffer {\n    return this._gl.createBuffer()!;\n  }\n\n  private _deleteBuffer(buffer: WebGLBuffer) {\n    return this._gl.deleteBuffer(buffer);\n  }\n\n  private _createNativeVAO() {\n    const gl = this._gl;\n\n    if (this._isWebGL2) {\n      return (gl as WebGL2RenderingContext).createVertexArray()!;\n    } else {\n      const ext = this._extensions.vao;\n\n      return ext?.createVertexArrayOES() || null;\n    }\n  }\n\n  private _bindNativeVAO(vao: WebGLVertexArrayObject | null) {\n    const gl = this._gl;\n\n    if (this._isWebGL2) {\n      (gl as WebGL2RenderingContext).bindVertexArray(vao);\n    } else {\n      const ext = this._extensions.vao;\n\n      ext?.bindVertexArrayOES(vao);\n    }\n  }\n\n  private _deleteNativeVAO(vao: WebGLVertexArrayObject | null) {\n    const gl = this._gl;\n\n    if (this._isWebGL2) {\n      (gl as WebGL2RenderingContext).deleteVertexArray(vao);\n    } else {\n      const ext = this._extensions.vao;\n\n      ext?.deleteVertexArrayOES(vao);\n    }\n  }\n\n  private _supplyGeometryData(vao: VertexArrayObject, shaderProgram: ShaderProgram) {\n    const geometry = vao.geometry;\n\n    this._supplyIndiciesData(geometry.indicies, vao.buffers.indicies);\n    this._supplyAttributeData(geometry.vertices, shaderProgram.program, \"position\", vao.buffers.position);\n    this._supplyAttributeData(geometry.uvs, shaderProgram.program, \"uv\", vao.buffers.uv);\n  }\n\n  private _unbindBuffers() {\n    const gl = this._gl;\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\n  }\n\n  private _supplyIndiciesData(indicies: VertexData<Uint16Array>, buffer: WebGLBuffer) {\n    const gl = this._gl;\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indicies.data, gl.STATIC_DRAW);\n  }\n\n  private _supplyAttributeData(attribute: VertexData<Float32Array>, program: WebGLProgram, name: string, buffer: WebGLBuffer) {\n    const gl = this._gl;\n    const attribLocation = gl.getAttribLocation(program, name);\n\n    // Attribute not used\n    if (attribLocation < 0) return;\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, attribute.data, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(attribLocation, attribute.itemSize, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(attribLocation);\n  }\n\n  private _compileShader(type: number, src: string) {\n    const gl = this._gl;\n    const shader = gl.createShader(type)!;\n\n    gl.shaderSource(shader, src);\n    gl.compileShader(shader);\n\n    return shader;\n  }\n\n  private _getCommonUniformLocations(program: WebGLProgram) {\n    const gl = this._gl;\n\n    return {\n      uMVMatrix: gl.getUniformLocation(program, \"uMVMatrix\")!,\n      uPMatrix: gl.getUniformLocation(program, \"uPMatrix\")!\n    };\n  }\n\n  private _getContext(canvas: HTMLCanvasElement): {\n    gl: WebGLRenderingContext | WebGL2RenderingContext;\n    isWebGL2: boolean;\n  } {\n    const webglIdentifiers = [\"webgl2\", \"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\n    let context: WebGLRenderingContext | null = null;\n    let isWebGL2 = false;\n    const contextAttributes = {\n      preserveDrawingBuffer: false,\n      antialias: false\n    };\n\n    const onWebglContextCreationError = e => e.statusMessage;\n\n    canvas.addEventListener(BROWSER.EVENTS.CONTEXT_CREATE_ERROR, onWebglContextCreationError);\n\n    for (const identifier of webglIdentifiers) {\n      try {\n        context = canvas.getContext(identifier, contextAttributes) as WebGLRenderingContext;\n        isWebGL2 = identifier === \"webgl2\";\n      } catch (t) {} // eslint-disable-line no-empty\n      if (context) {\n        break;\n      }\n    }\n\n    canvas.removeEventListener(BROWSER.EVENTS.CONTEXT_CREATE_ERROR, onWebglContextCreationError);\n\n    if (!context) {\n      throw new View360Error(ERROR.MESSAGES.WEBGL_NOT_SUPPORTED, ERROR.CODES.WEBGL_NOT_SUPPORTED);\n    }\n\n    return {\n      gl: context,\n      isWebGL2\n    };\n  }\n\n  private _onContextLost = () => {\n    const canvas = this._canvas;\n    canvas.classList.add(DEFAULT_CLASS.CTX_LOST);\n    this._contextLost = true;\n  };\n\n  private _onContextRestore = () => {\n    const canvas = this._canvas;\n    canvas.classList.remove(DEFAULT_CLASS.CTX_LOST);\n    this._contextLost = false;\n  };\n}\n\nexport default WebGLContext;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { mat4 } from \"gl-matrix\";\nimport Camera from \"./Camera\";\nimport Projection from \"../projection/Projection\";\nimport WebGLContext from \"./WebGLContext\";\nimport XRManager from \"./XRManager\";\n\n/**\n * Projection renderer, based on WebGL\n * @ko WebGL 기반의 프로젝션 렌더러\n * @since 4.0.0\n */\nclass WebGLRenderer {\n  private _canvas: HTMLCanvasElement;\n  private _elementSize: { x: number, y: number };\n  private _pixelRatio: number;\n\n  public readonly ctx: WebGLContext;\n\n  /**\n   * Canvas element\n   * @ko 캔버스 엘리먼트\n   * @since 4.0.0\n   */\n  public get canvas() { return this._canvas; }\n  /**\n   * Canvas's width (`devicePixelRatio` is not applied)\n   * @ko 캔버스의 보이는 너비 (`devicePixelRatio`가 적용되지 않은)\n   * @since 4.0.0\n   */\n  public get width() { return this._elementSize.x; }\n  /**\n   * Canvas's height (`devicePixelRatio` is not applied)\n   * @ko 캔버스의 높이 (`devicePixelRatio`가 적용되지 않은)\n   * @since 4.0.0\n   */\n  public get height() { return this._elementSize.y; }\n  /**\n   * Current `devicePixelRatio` value.\n   * @ko 현재 `devicePixelRatio` 값.\n   * @since 4.0.0\n   * @example\n   * ```js\n   * cosnt renderingWidth = view360.renderer.width * view360.renderer.pixelRatio;\n   * ```\n   */\n  public get pixelRatio() { return this._pixelRatio; }\n  /**\n   * Width / height ratio (= width / height)\n   * @ko 너비 / 높이의 비율 (= width / height)\n   * @since 4.0.0\n   * @example\n   * ```js\n   * const aspect = view360.renderer.width / view360.renderer.pixelRatio;\n   * assert(aspect === view360.renderer.aspect);\n   * ```\n   */\n  public get aspect() { return this._elementSize.x / this._elementSize.y; }\n\n  /**\n   * Create new instance\n   * @ko 새 인스턴스를 생성합니다.\n   * @param canvas - Canvas element {@ko 캔버스 엘리먼트}\n   * @param debug - Whether to enable WebGL debugging {@ko WebGL debug 활성화 여부 }\n   */\n  public constructor(canvas: HTMLCanvasElement, debug: boolean) {\n    this._canvas = canvas;\n    this._elementSize = { x: 0, y: 0 };\n    this._pixelRatio = 1;\n    this.ctx = new WebGLContext(canvas, debug);\n  }\n\n  /**\n   * Destroy instance and release all resources.\n   * @ko 인스턴스를 제거하고 사용된 리소스를 전부 해제합니다.\n   * @since 4.0.0\n   */\n  public destroy() {\n    const canvas = this._canvas;\n\n    this.ctx.destroy();\n    canvas.width = 1;\n    canvas.height = 1;\n  }\n\n  /**\n   * Resize canvas and renew inner size cache.\n   * @ko 캔버스의 크기를 재계산해서 내부의 사이즈 캐시값을 갱신합니다.\n   * @since 4.0.0\n   */\n  public resize() {\n    const canvas = this._canvas;\n    const canvasSize = this._elementSize;\n    const devicePixelRatio = window.devicePixelRatio;\n\n    canvasSize.x = canvas.clientWidth;\n    canvasSize.y = canvas.clientHeight;\n\n    canvas.width = canvasSize.x * devicePixelRatio;\n    canvas.height = canvasSize.y * devicePixelRatio;\n\n    this._pixelRatio = devicePixelRatio;\n    this.ctx.resize();\n  }\n\n  /**\n   * Render projection\n   * @ko 프로젝션을 렌더링합니다.\n   * @param projection - Projection to render {@ko 렌더링할 프로젝션}\n   * @param cameraa - Camera instance {@ko 카메라의 인스턴스}\n   * @since 4.0.0\n   */\n  public render(projection: Projection, camera: Camera) {\n    const ctx = this.ctx;\n    const mesh = projection.getMesh();\n    if (ctx.lost || !mesh) return;\n\n    ctx.clear();\n    ctx.useProgram(mesh.program);\n    ctx.updateCommonUniforms(mesh, camera, mesh.program);\n    projection.update(camera);\n    ctx.updateUniforms(mesh.program);\n    ctx.draw(mesh.vao, mesh.program);\n  }\n\n  /**\n   * Render VR frame, only used for rendering frames inside VR sessions.\n   * @ko VR 프레임을 렌더링합니다. VR 세션 진입 도중에만 사용됩니다.\n   * @internal\n   * @param projection - Projection to render {@ko 렌더링할 프로젝션}\n   * @param vr - Instance of XRManager {@ko XRManager의 인스턴스}\n   * @param frame - VR frame {@ko VR 프레임}\n   * @since 4.0.0\n   */\n  public renderVR(projection: Projection, vr: XRManager, frame: XRFrame) {\n    const ctx = this.ctx;\n    const mesh = projection.getMesh();\n    const eyeParams = vr.getEyeParams(frame);\n\n    if (!eyeParams || !mesh) return;\n\n    ctx.bindXRFrame(frame);\n    ctx.useProgram(mesh.program);\n    ctx.updateUniforms(mesh.program);\n\n    eyeParams.forEach((eye, eyeIndex) => {\n      const viewport = eye.viewport;\n      // We're using \"mesh.matrix\"(=local matrix) here for efficiency\n      // As projection doesn't require world matrix, as it doesn't have any parent or child\n      const mvMatrix = mat4.multiply(mat4.create(), eye.vMatrix, mesh.matrix);\n\n      ctx.viewport(viewport.x, viewport.y, viewport.width, viewport.height);\n      ctx.updateVRUniforms(mesh.program, mvMatrix, eye.pMatrix, eyeIndex);\n      ctx.draw(mesh.vao, mesh.program);\n    });\n  }\n}\n\nexport default WebGLRenderer;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport Camera, { CameraOptions } from \"./core/Camera\";\nimport PanoControl, { PanoControlOptions } from \"./control/PanoControl\";\nimport TextureLoader from \"./core/TextureLoader\";\nimport FrameAnimator from \"./core/FrameAnimator\";\nimport AutoResizer from \"./core/AutoResizer\";\nimport Autoplay, { AutoplayOptions } from \"./core/Autoplay\";\nimport XRManager from \"./core/XRManager\";\nimport View360Error from \"./core/View360Error\";\nimport Projection from \"./projection/Projection\";\nimport HotspotRenderer, { HotspotOptions } from \"./hotspot/HotspotRenderer\";\nimport WebGLRenderer from \"./core/WebGLRenderer\";\nimport Texture from \"./texture/Texture\";\nimport View360Plugin from \"./plugin/View360Plugin\";\nimport ERROR from \"./const/error\";\nimport { CONTROL_EVENTS } from \"./const/internal\";\nimport { DEFAULT_CLASS, EVENTS } from \"./const/external\";\nimport { findCanvas, getElement } from \"./utils\";\nimport * as EVENT_TYPES from \"./type/events\";\nimport { EventParams } from \"./type/utils\";\n\n/**\n * Events that {@link View360} can trigger\n * @ko {@link View360}가 트리거할 수 있는 이벤트들\n * @see [Detailed Example](/docs/events/ready)\n * @since 4.0.0\n */\nexport interface View360Events {\n  [EVENTS.READY]: EVENT_TYPES.ReadyEvent;\n  [EVENTS.LOAD_START]: EVENT_TYPES.LoadStartEvent;\n  [EVENTS.LOAD]: EVENT_TYPES.LoadEvent;\n  [EVENTS.PROJECTION_CHANGE]: EVENT_TYPES.ProjectionChangeEvent;\n  [EVENTS.RESIZE]: EVENT_TYPES.ResizeEvent;\n  [EVENTS.BEFORE_RENDER]: EVENT_TYPES.BeforeRenderEvent;\n  [EVENTS.RENDER]: EVENT_TYPES.RenderEvent;\n  [EVENTS.INPUT_START]: EVENT_TYPES.InputStartEvent;\n  [EVENTS.INPUT_END]: EVENT_TYPES.InputEndEvent;\n  [EVENTS.VIEW_CHANGE]: EVENT_TYPES.ViewChangeEvent;\n  [EVENTS.STATIC_CLICK]: EVENT_TYPES.StaticClickEvent;\n  [EVENTS.VR_START]: EVENT_TYPES.VRStartEvent;\n  [EVENTS.VR_END]: EVENT_TYPES.VREndEvent;\n}\n\n/**\n * Options for {@link View360}\n * @ko {@link View360}용 옵션들\n * @see [Detailed Example](/docs/options)\n * @since 4.0.0\n */\nexport interface View360Options extends CameraOptions, PanoControlOptions {\n  projection: Projection | null;\n  hotspot: Partial<HotspotOptions>;\n  autoplay: boolean | Partial<AutoplayOptions>;\n  autoInit: boolean;\n  autoResize: boolean;\n  canvasSelector: string;\n  useResizeObserver: boolean;\n  tabIndex: number | null;\n  on: Partial<{ [key in keyof View360Events]: (evt: View360Events[key]) => any }>;\n  plugins: View360Plugin[];\n  maxDeltaTime: number;\n  debug: boolean;\n}\n\n/**\n * Panorama 360 image viewer\n * @ko 파노라마 360 이미지 뷰어\n * @since 4.0.0\n * @see View360Options\n * @see View360Events\n */\nclass View360 extends Component<View360Events> {\n  /**\n   * Current version string of the View360\n   * @ko View360의 현재 버젼 문자열\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```ts\n   * // If the installed version of the View360 is v4.0.0, View360.VERSION is equal to \"4.0.0\"\n   * console.log(View360.VERSION) // 4.0.0\n   * ```\n   */\n  public static readonly VERSION = \"#__VERSION__#\";\n\n  private _rootEl: HTMLElement;\n  private _renderer: WebGLRenderer;\n  private _camera: Camera;\n  private _control: PanoControl;\n  private _animator: FrameAnimator;\n  private _autoplay: Autoplay;\n  private _hotspot: HotspotRenderer;\n  private _projection: Projection | null;\n  private _autoResizer: AutoResizer;\n  private _vr: XRManager;\n  private _plugins: View360Plugin[];\n  private _initialized: boolean;\n\n  private _autoInit: View360Options[\"autoInit\"];\n  private _autoResize: View360Options[\"autoResize\"];\n  private _canvasSelector: View360Options[\"canvasSelector\"];\n  private _useResizeObserver: View360Options[\"useResizeObserver\"];\n  private _tabIndex: View360Options[\"tabIndex\"];\n  private _debug: View360Options[\"debug\"];\n\n  /**\n   * Root element (`.view360-container`)\n   * @ko 루트 엘리먼트 (`.view360-container`)\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```html\n   * <div id=\"viewer\" class=\"view360-container\">\n   *   <canvas class=\"view360-canvas\"></canvas>\n   * </div>\n   * ```\n   * ```ts\n   * import View360 from \"@egjs/view360\";\n   *\n   * const viewer = new View360(\"#viewer\");\n   * console.log(viewer.rootEl); // Element with id \"viewer\"\n   * ```\n   */\n  public get rootEl() { return this._rootEl; }\n  /**\n   * Projection renderer.\n   * @ko 프로젝션 렌더러.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get renderer() { return this._renderer; }\n  /**\n   * Projection camera.\n   * @ko 프로젝션 카메라.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get camera() { return this._camera; }\n  /**\n   * Rotate/Zoom Controller.\n   * @ko 회전/줌 컨트롤러.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get control() { return this._control; }\n  /**\n   * WebXR-based VR manager.\n   * @ko WebXR 기반의 VR 기능 매니저 인스턴스.\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```ts\n   * // Example: Enter VR\n   * // This must be called on user interaction, else will be rejected.\n   * viewer.vr.enter();\n   * ```\n   */\n  public get vr() { return this._vr; }\n  /**\n   * Hotspot renderer.\n   * You can also change options of {@link View360Options#hotspot} with this.\n   * @ko 핫스팟 렌더러 인스턴스.\n   * {@link View360Options#hotspot} 옵션 변경도 가능합니다.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get hotspot() { return this._hotspot; }\n  /**\n   * An array of plugins added.\n   * @ko 추가된 플러그인의 배열\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   plugins: [new ControlBar()]\n   * });\n   *\n   * console.log(viewer.plugins); // [ControlBar]\n   *\n   * viewer.addPlugins(new LoadingSpinner()) // [ControlBar, LoadingSpinner];\n   * ```\n   */\n  public get plugins() { return this._plugins; }\n  /**\n   * A instance of {@link Projection} that currently enabled. `null` if not initialized yet.\n   * You should call {@link View360#load} to change panorama src or projection type.\n   * @ko 현재 사용중인 {@link Projection}의 인스턴스. 프로젝션을 활성화하지 않았을 경우 `null`입니다.\n   * 파노라마 이미지 소스나 프로젝션 타입을 변경하려면 {@link View360#load}를 호출하면 됩니다.\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```ts\n   * const viewer = new View360\n   * ```\n   */\n  public get projection() { return this._projection; }\n  public set projection(val: View360Options[\"projection\"]) {\n    if (this._initialized && val) {\n      this.load(val);\n    } else {\n      this._projection = val;\n    }\n  }\n  /**\n   * A boolean value whether {@link View360#init init()} is called before.\n   * @ko {@link View360#init init()}이 호출되었는지 여부를 가리키는 값\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el\", { autoInit: false });\n   *\n   * console.log(viewer.initialized); // false\n   *\n   * await viewer.init();\n   *\n   * console.log(viewer.initialized); // true\n   * ```\n   */\n  public get initialized() { return this._initialized; }\n  /**\n   * Instance of the Autoplay manager.\n   * You can also change {@link View360Options#autoplay} options with this.\n   * @ko Autoplay 기능의 매니저 인스턴스.\n   * 이 인스턴스를 통해 {@link View360Options#autoplay} 옵션을 변경하는 것도 가능합니다.\n   * @since 4.0.0\n   * @readonly\n   * @example\n   * ```ts\n   * // Disable autoplay\n   * viewer.autoplay.disable();\n   * ```\n   */\n  public get autoplay() { return this._autoplay; }\n  /**\n   * When this value is `true` and {@link View360Options#projection} is set, {@link View360#init init()} will be called automatically when instance is created.\n   * @ko 이 값이 `true`이고, {@link View360Options#projection}이 설정되었으면, 인스턴스 생성 시점에 자동으로 {@link View360#init init()}을 호출합니다.\n   * @default true\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * import View360, { EquirectProjection, EVENTS } from \"@egjs/view360\";\n   *\n   * // viewer.init() is called on instance creation\n   * // But as `init` is asynchronous, you should wait for \"ready\" event if you want to do something after initialization.\n   * const viewer = new View360(\"#el_id\", {\n   *   autoInit: true,\n   *   projection: new EquirectProjection({ src: \"SRC_TO_URL\" })\n   * });\n   *\n   * console.log(viewer.initialized); // false, as `init` is asynchronous\n   *\n   * viewer.once(EVENTS.READY, () => {\n   *   console.log(viewer.initialized); // true\n   * });\n   * ```\n   */\n  public get autoInit() { return this._autoInit; }\n  /**\n   * When `true`, {@link View360#resize} is called when the canvas size is changed.\n   * @ko `true`일 경우, 캔버스의 크기가 변경되었을 때 자동으로 {@link View360#resize}를 호출합니다.\n   * @default true\n   * @since 4.0.0\n   * @see View360#useResizeObserver\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   autoResize: true\n   * });\n   *\n   * // This can trigger `viewer.resize()` if the canvas size was not 400px\n   * const canvas = viewer.renderer.canvas;\n   * canvas.style.width = \"400px\";\n   * ```\n   */\n  public get autoResize() { return this._autoResize; }\n  /**\n   * CSS selector for canvas element to render panorama image/video.\n   * The canvas element should be placed inside the root element. (Dont' have to be direct child)\n   * @ko 파노라마 이미지/비디오를 렌더링할 canvas 엘리먼트의 CSS 선택자\n   * 캔버스 엘리먼트는 루트 엘리먼트 내부에 있어야합니다. 루트 엘리먼트의 직계 자식 엘리먼트(Direct child element)일 필요는 없습니다.\n   * @default \"canvas\"\n   * @since 4.0.0\n   * @example\n   * ```html\n   * <div class=\"view360-container\">\n   *   <canvas id=\"not_this_one\"></canvas>\n   *   <!-- This will be selected -->\n   *   <canvas id=\"canvas_to_select\"></canvas>\n   * </div>\n   * ```\n   *\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   canvasSelector: \"#canvas_to_select\"\n   * });\n   * ```\n   */\n  public get canvasSelector() { return this._canvasSelector; }\n  /**\n   * When `true`, it will use {@link ResizeObserver} API to detect canvas size change when {@link View360Options#autoResize} is enabled.\n   * @ko `true`일 때 {@link View360Options#autoResize}가 활성화되었으면, 사용 가능한 환경에서 {@link ResizeObserver} API를 사용해서 캔버스 크기 변화를 추적합니다.\n   * @default true\n   * @since 4.0.0\n   */\n  public get useResizeObserver() { return this._useResizeObserver; }\n  /**\n   * {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex tabindex} attribute for the canvas element.\n   * This is necessary for the keyboard controls.\n   * By default, `0` will be assigned. `null` to disable.\n   * @ko 캔버스 엘리먼트에 적용할 {@link https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex tabindex} 어트리뷰트의 값.\n   * 이 값을 설정해야만 키보드 컨트롤을 사용 가능합니다.\n   * 기본값으로 `0`이 설정됩니다. `null`로 지정하면 `tabindex`를 설정하지 않습니다.\n   * @see RotateControlOptions#disableKeyboard\n   * @default 0\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   tabindex: 5\n   * });\n   * ```\n   *\n   * ```html\n   * <!-- After init -->\n   * <div class=\"view360-container\">\n   *   <canvas class=\"view360-canvas\" tabindex=\"5\"></canvas>\n   * </div>\n   * ```\n   */\n  public get tabIndex() { return this._tabIndex; }\n  public set tabIndex(val: View360Options[\"tabIndex\"]) {\n    const canvas = this._renderer.canvas;\n    this._tabIndex = val;\n\n    if (val != null) {\n      canvas.tabIndex = val;\n    } else {\n      canvas.removeAttribute(\"tabindex\");\n    }\n  }\n  /**\n   * A maximum delta time between frames in seconds.\n   * It can prevent camera or control changing too fast when frame being late.\n   * @ko 프레임간 시간 차이의 최대값. (초 단위)\n   * 퍼포먼스 등의 이유로 프레임 렌더링이 늦어졌을 때, 화면이 갑작스럽게 바뀌는 것을 막아줍니다.\n   * @default 1 / 30\n   * @since 4.0.0\n   */\n  public get maxDeltaTime() { return this._animator.maxDeltaTime; }\n  public set maxDeltaTime(val: View360Options[\"maxDeltaTime\"]) { this._animator.maxDeltaTime = val; }\n  /**\n   * Enable WebGL debugging. Setting this to `true` can decrease performance.\n   * This is used internally on developing View360.\n   * @ko WebGL 디버깅을 활성화합니다. 이 값을 `true`로 할 경우 성능이 하락할 수 있습니다.\n   * 이 옵션은 View360을 개발하기 위해 내부적으로 사용됩니다.\n   * @default false\n   */\n  public get debug() { return this._debug; }\n  public set debug(val: View360Options[\"debug\"]) { this._debug = val; }\n\n  // Camera options\n  /**\n   * Initial yaw (y-axis rotation) value for camera. (in degrees, °)\n   * As View360 uses right-handed coordinate system internally, camera will rotate counter-clockwise by this value.\n   * @ko 카메라의 초기 yaw(y축 회전)값 (도 단위, °)\n   * View360은 오른손 좌표계를 사용하기 때문에, 카메라가 해당 값만큼 시계 반대방향으로 회전합니다.\n   * @default 0\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   initialYaw: 30\n   * });\n   *\n   * viewer.on(\"ready\", () => {\n   *   console.log(viewer.camera.yaw); // 30\n   * });\n   * ```\n   */\n  public get initialYaw() { return this._camera.initialYaw; }\n  public set initialYaw(val: View360Options[\"initialYaw\"]) { this._camera.initialYaw = val; }\n  /**\n   * Initial pitch (x-axis rotation) value for camera. (in degrees, °)\n   * As View360 uses right-handed coordinate system internally, positive value will make camera to look upside, while negative value will look down.\n   * @ko 카메라의 초기 pitch(x축 회전)값 (도 단위, °)\n   * View360은 오른손 좌표계를 사용하기 때문에, 양(+)의 값은 카메라가 위를 보게 하고, 음(-)의 값은 카메라가 아래를 보게 합니다.\n   * @default 0\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   initialPitch: 60\n   * });\n   *\n   * viewer.on(\"ready\", () => {\n   *   console.log(viewer.camera.pitch); // 60\n   * });\n   * ```\n   */\n  public get initialPitch() { return this._camera.initialPitch; }\n  public set initialPitch(val: View360Options[\"initialPitch\"]) { this._camera.initialPitch = val; }\n  /**\n   * Initial zoom value for camera.\n   * Setting this value to `2` will enlarge panorama 200% by width.\n   * @ko 카메라의 초기 줌 값.\n   * 이 값을 `2`로 설정할 경우 파노라마 이미지를 가로 기준 200%만큼 확대합니다.\n   * @default 1\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   initialZoom: 2\n   * });\n   *\n   * viewer.on(\"ready\", () => {\n   *   console.log(viewer.camera.zoom); // 2\n   * });\n   * ```\n   */\n  public get initialZoom() { return this._camera.initialZoom; }\n  public set initialZoom(val: View360Options[\"initialZoom\"]) { this._camera.initialZoom = val; }\n  /**\n   * Restrict yaw(y-axis rotation) range. (in degrees, °)\n   * @ko yaw(y축 회전) 범위를 제한합니다. (도 단위, °)\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   yawRange: [-30, 30]\n   * });\n   *\n   * viewer.on(\"ready\", () => {\n   *   console.log(viewer.camera.yaw); // 0\n   *   viewer.camera.lookAt({ yaw: 60  });\n   *   console.log(viewer.camera.yaw); // 30\n   * });\n   * ```\n   */\n  public get yawRange() { return this._camera.yawRange; }\n  public set yawRange(val: View360Options[\"yawRange\"]) {\n    this._camera.yawRange = val;\n    if (this._projection) this._projection.updateCamera(this._camera);\n  }\n  /**\n   * Restrict pitch(x-axis rotation) range. (in degrees, °)\n   * @ko pitch(x축 회전) 범위를 제한합니다. (도 단위, °)\n   * @default null\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   pitchRange: [-45, 45]\n   * });\n   *\n   * viewer.on(\"ready\", () => {\n   *   console.log(viewer.camera.pitch); // 0\n   *   viewer.camera.lookAt({ pitch: 60  });\n   *   console.log(viewer.camera.pitch); // 45\n   * });\n   * ```\n   */\n  public get pitchRange() { return this._camera.pitchRange; }\n  public set pitchRange(val: View360Options[\"pitchRange\"]) {\n    this._camera.pitchRange = val;\n    if (this._projection) this._projection.updateCamera(this._camera);\n  }\n  /**\n   * Restrict camera zoom range.\n   * If `null`, a default zoom range from `0.6` to `10` will be used.\n   * @ko 카메라 줌 범위를 제한합니다.\n   * `null`일 경우 기본값으로 `0.6`에서 `10`의 범위를 사용합니다.\n   * @default null\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * const viewer = new View360(\"#el_id\", {\n   *   zoomRange: [0.5, 4]\n   * });\n   *\n   * viewer.on(\"ready\", () => {\n   *   console.log(viewer.camera.zoom); // 1\n   *   viewer.camera.lookAt({ zoom: 6  });\n   *   console.log(viewer.camera.zoom); // 4\n   * });\n   * ```\n   */\n  public get zoomRange() { return this._camera.zoomRange; }\n  public set zoomRange(val: View360Options[\"zoomRange\"]) {\n    this._camera.zoomRange = val;\n    if (this._projection) this._projection.updateCamera(this._camera);\n  }\n  /**\n   * Camera's horizontal FOV(Field of View). (in degrees, °)\n   * @ko 카메라의 수평 FOV(Field of View) 값. (도 단위, °)\n   * @default 90\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * // Init with fov: 120\n   * const viewer = new View360(\"#el_id\", { fov: 120 });\n   *\n   * // Back to 90\n   * viewer.fov = 90;\n   * ```\n   */\n  public get fov() { return this._camera.fov; }\n  public set fov(val: View360Options[\"fov\"]) {\n    const camera = this._camera;\n    const control = this._control;\n\n    camera.fov = val;\n    camera.updateMatrix();\n    control.sync();\n  }\n\n  // Control options\n  /**\n   * A control for camera rotation.\n   * You can also change options of {@link View360Options#rotate} with this.\n   * @ko 카메라 회전을 담당하는 컨트롤.\n   * {@link View360Options#rotate} 옵션 변경도 가능합니다.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get rotate() { return this._control.rotate; }\n  /**\n   * A control for camera zoom.\n   * You can also change options of {@link View360Options#zoom} with this.\n   * @ko 카메라 줌을 담당하는 컨트롤.\n   * {@link View360Options#zoom} 옵션 변경도 가능합니다.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get zoom() { return this._control.zoom; }\n  /**\n   * A control for camera rotation with gyroscope input.\n   * You can also change options of {@link View360Options#gyro} with this.\n   * @ko 자이로스코프를 통한 카메라 회전을 담당하는 컨트롤.\n   * {@link View360Options#gyro} 옵션 변경도 가능합니다.\n   * @since 4.0.0\n   * @readonly\n   */\n  public get gyro() { return this._control.gyro; }\n  /**\n   * Apply CSS {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor cursor} by current state of input when using mouse.\n   * If `true`, this will add CSS style to canvas element. It'll apply `cursor: \"grab\"` by default and `cursor: \"grabbing\"` when holding the mouse button.\n   * @ko 마우스 사용시 CSS {@link https://developer.mozilla.org/en-US/docs/Web/CSS/cursor cursor}값을 자동으로 변경할지 여부.\n   * `true`일 경우 기본 상태에서 `cursor: \"grab\"`을, 입력 도중에 `cursor: \"grabbing\"`을 캔버스에 적용합니다.\n   * @default true\n   * @since 4.0.0\n   */\n  public get useGrabCursor() { return this._control.useGrabCursor; }\n  public set useGrabCursor(val: View360Options[\"useGrabCursor\"]) { this._control.useGrabCursor = val; }\n  /**\n   * Disable context menu which pops up on mouse right click.\n   * @ko 마우스 우클릭시 표시되는 컨텍스트 메뉴를 비활성화합니다.\n   * @default false\n   * @since 4.0.0\n   */\n  public get disableContextMenu() { return this._control.disableContextMenu; }\n  public set disableContextMenu(val: View360Options[\"disableContextMenu\"]) { this._control.disableContextMenu = val; }\n  /**\n   * If `true`, enables scroll on mobile(touch) devices on canvas.\n   * :::caution\n   * When this option is enabled, users must swipe horizontally first then vertically to change view up or down.\n   * :::\n   * @ko `true`로 설정할 경우, 모바일(터치) 환경의 캔버스 영역 내에서 스크롤을 가능하게 합니다.\n   * :::caution\n   * 이 값을 활성화할 경우, 사용자가 카메라 뷰를 위/아래로 바꾸기 위해서는 먼저 가로로 스와이프한 이후에 세로로 스와이프해야만 합니다.\n   * :::\n   * @since 4.0.0\n   * @default true\n   */\n  public get scrollable() { return this._control.scrollable; }\n  public set scrollable(val: View360Options[\"scrollable\"]) { this._control.scrollable = val; }\n  /**\n   * If `true`, enables scroll by mouse wheel on canvas.\n   * :::caution\n   * When this option is enabled, zoom by mouse wheel will be disabled.\n   * :::\n   * @ko `true`로 설정할 경우, 캔버스 영역 내에서 마우스 휠을 이용한 페이지 스크롤이 가능해집니다.\n   * :::caution\n   * 이 값을 활성화할 경우, 마우스 휠을 통한 줌이 불가능하게 됩니다.\n   * :::\n   * @since 4.0.0\n   * @default false\n   */\n  public get wheelScrollable() { return this._control.wheelScrollable; }\n  public set wheelScrollable(val: View360Options[\"wheelScrollable\"]) { this._control.wheelScrollable = val; }\n\n  /**\n   * Create new instance of View360\n   * @ko View360의 새로운 인스턴스를 생성합니다\n   * @param root - Root element(`.view360-container`) to mount View360\n   * Can be either a CSS selector or HTMLElement.\n   * {@ko View360을 마운트할 루트 엘리먼트, CSS 셀렉터나 HTMLElement를 지정 가능합니다.}\n   * @param options - Options to apply\n   * {@ko 적용할 옵션들}\n   * @example\n   * ```ts\n   * import View360, { EquirectProjection } from \"@egjs/view360\";\n   *\n   * // Create new View360 instance\n   * const viewer = new View360(\"#id-of-a-container\", {\n   *   projection: new EquirectProjection({\n   *     src: \"URL_TO_PANORAMA_IMAGE_OR_VIDEO\",\n   *   })\n   * });\n   * ```\n   */\n  public constructor(root: string | HTMLElement, {\n    projection = null,\n    initialYaw = 0,\n    initialPitch = 0,\n    initialZoom = 1,\n    yawRange = null,\n    pitchRange = null,\n    zoomRange = null,\n    fov = 90,\n    useGrabCursor = true,\n    disableContextMenu = false,\n    rotate = true,\n    zoom = true,\n    gyro = false,\n    scrollable = true,\n    wheelScrollable = false,\n    autoplay = false,\n    hotspot = {},\n    autoInit = true,\n    autoResize = true,\n    canvasSelector = \"canvas\",\n    useResizeObserver = true,\n    on = {},\n    plugins = [],\n    maxDeltaTime = 1 / 30,\n    tabIndex = 0,\n    debug = false\n  }: Partial<View360Options> = {}) {\n    super();\n\n    this._rootEl = getElement(root);\n    this._plugins = plugins;\n    this._initialized = false;\n\n    // Options\n    this._autoInit = autoInit;\n    this._autoResize = autoResize;\n    this._canvasSelector = canvasSelector;\n    this._useResizeObserver = useResizeObserver;\n    this._tabIndex = tabIndex;\n    this._debug = debug;\n\n    // Core components\n    const canvas = findCanvas(this._rootEl, canvasSelector);\n    this._renderer = new WebGLRenderer(canvas, debug);\n    this._camera = new Camera({\n      initialYaw,\n      initialPitch,\n      initialZoom,\n      fov,\n      yawRange,\n      pitchRange,\n      zoomRange\n    });\n    this._control = new PanoControl(canvas, this._camera, {\n      useGrabCursor,\n      scrollable,\n      wheelScrollable,\n      disableContextMenu,\n      rotate,\n      zoom,\n      gyro\n    });\n    this._animator = new FrameAnimator(maxDeltaTime);\n    this._autoplay = new Autoplay(this, canvas, autoplay);\n    this._projection = projection;\n    this._autoResizer = new AutoResizer(useResizeObserver, () => this.resize());\n    this._vr = new XRManager(this._renderer.ctx);\n    this._hotspot = new HotspotRenderer(this._rootEl, this._renderer, hotspot);\n\n    this._addEventHandlers(on);\n\n    if (projection && autoInit) {\n      this.init();\n    }\n  }\n\n  /**\n   * Destroy instance and release all resources.\n   * @ko 인스턴스를 제거하고 모든 리소스를 해제합니다.\n   * @since 4.0.0\n   */\n  public destroy() {\n    this._camera.destroy();\n    this._animator.stop();\n    this._renderer.destroy();\n    this._control.destroy();\n    this._autoResizer.disable();\n\n    if (this._projection) {\n      this._projection.releaseAllResources(this._renderer.ctx);\n      this._projection = null;\n    }\n\n    this._plugins.forEach(plugin => plugin.destroy(this));\n\n    this._initialized = false;\n  }\n\n  /**\n   * Initialize inner components and load projection src.\n   * @ko 내부 컴포넌트들을 초기화하고 프로젝션 소스를 로드합니다.\n   * @since 4.0.0\n   */\n  public async init() {\n    if (!this._projection) {\n      throw new View360Error(ERROR.MESSAGES.PROVIDE_PROJECTION_FIRST, ERROR.CODES.PROVIDE_PROJECTION_FIRST);\n    }\n\n    const renderer = this._renderer;\n    const camera = this._camera;\n    const control = this._control;\n    const animator = this._animator;\n    const hotspot = this._hotspot;\n    const projection = this._projection;\n    const canvas = renderer.canvas;\n\n    this._bindComponentEvents();\n    renderer.ctx.init();\n    this._resizeComponents();\n    camera.updateMatrix();\n\n    if (this._autoResize) {\n      this._autoResizer.enable(canvas);\n    }\n\n    if (!this._autoplay.enableBlocked) {\n      this._autoplay.enable();\n    }\n\n    this._plugins.forEach(plugin => {\n      plugin.init(this);\n    });\n\n    const texture = await this._loadTexture(projection);\n    this._applyProjection(projection, texture, null);\n    hotspot.refresh();\n    animator.start(this._renderFrameOnDemand);\n    await control.enable();\n\n    if (this._tabIndex != null && !canvas.hasAttribute(\"tabIndex\")) {\n      canvas.tabIndex = this._tabIndex;\n    }\n\n    this._initialized = true;\n    this.renderFrame(0);\n\n    this._emit(EVENTS.READY);\n  }\n\n  /**\n   * Load new panorama image/video and display it.\n   * This will {@link View360#init init()} View360 if it's not initialized yet.\n   * @ko 새로운 파노라마 이미지 혹은 비디오를 로드하고 표시합니다.\n   * 만약 View360이 아직 초기화되지 않았다면, {@link View360#init init()}을 호출합니다.\n   * @param projection - Projection & video options for new source. {@ko 새로운 파노라마 이미지/비디오에 적용할 옵션들}\n   * @returns `Promise<true>` if load was successful. {@ko 프로젝션 로드에 성공했을 경우 `Promise<true>`를 반환합니다. }\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * // Change to video\n   * viewer.load({\n   *   src: \"URL_TO_NEW_VIDEO\",\n   *   video: true\n   * });\n   * ```\n   */\n  public async load(projection: Projection): Promise<boolean> {\n    if (!projection) return false;\n\n    if (this._initialized) {\n      const texture = await this._loadTexture(projection);\n      this._applyProjection(projection, texture, this._projection);\n      this.renderFrame(0);\n    } else {\n      // Should update internal options before init\n      this._projection = projection;\n      this.init();\n    }\n\n    return true;\n  }\n\n  /**\n   * Refresh component's size by current\n   * @ko View360이 내부적으로 캐시하고 있는 엘리먼트 크기를 현재 크기로 갱신합니다.\n   * @since 4.0.0\n   */\n  public resize() {\n    if (!this._initialized) return;\n\n    this._resizeComponents();\n\n    // To prevent flickering, render immediately after resizing components\n    this.renderFrame(0);\n\n    const { width, height } = this._renderer;\n\n    this._emit(EVENTS.RESIZE, {\n      width,\n      height\n    });\n  }\n\n  /**\n   * Add new plugins\n   * @ko 새로운 플러그인을 추가합니다.\n   * @param plugins Plugins to add {@ko 추가할 플러그인들}\n   * @see View360Options#plugins\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * // Add a single plugin\n   * viewer.addPlugins(new ControlBar());\n   *\n   * // Add multiple plugins\n   * viewer.addPlugins(new ControlBar(), new LoadingSpinner());\n   * ```\n   */\n  public addPlugins(...plugins: View360Plugin[]) {\n    if (this._initialized) {\n      plugins.forEach(plugin => { plugin.init(this); });\n    }\n\n    this._plugins.push(...plugins);\n  }\n\n  /**\n   * Remove plugins.\n   * @ko 플러그인을 제거합니다.\n   * @param plugins Plugins to remove {@ko 제거할 플러그인들}\n   * @since 4.0.0\n   * @example\n   * ```ts\n   * // Remove a single plugin\n   * viewer.removePlugins(plugin1);\n   *\n   * // Remove multiple plugins\n   * viewer.removePlugins(plugin2, plugin3);\n   * ```\n   */\n  public removePlugins(...plugins: View360Plugin[]) {\n    plugins.forEach(plugin => {\n      const pluginIdx = this._plugins.indexOf(plugin);\n\n      if (pluginIdx < 0) return;\n\n      plugin.destroy(this);\n      this._plugins.splice(pluginIdx, 1);\n    });\n  }\n\n  /**\n   * Render a single panorama image/video frame.\n   * Rendering is performed automatically on demand, so you usually don't have to call this.\n   * Call this when a frame is not renewed after changing options.\n   * @ko 파노라마 이미지/비디오의 한 프레임을 렌더링합니다.\n   * 프레임 갱신은 보통 필요한 때에만 자동적으로 이루어지기 때문에, 보통은 이 메소드를 호출할 필요는 없습니다.\n   * 옵션 변경 이후에도 프레임 갱신이 이루어지지 않는다면, 이 메소드를 호출해주세요.\n   * @param delta Delta time in milisec. {@ko 프레임간 시간 차이, 밀리초 단위}\n   * @since 4.0.0\n   */\n  public renderFrame = (delta: number) => {\n    const camera = this._camera;\n    const renderer = this._renderer;\n    const control = this._control;\n    const hotspot = this._hotspot;\n    const autoPlayer = this._autoplay;\n    const projection = this._projection;\n\n    if (!projection) return;\n\n    this._emit(EVENTS.BEFORE_RENDER);\n\n    if (autoPlayer.playing) {\n      autoPlayer.update(delta);\n      control.sync();\n    }\n\n    if (camera.animation) {\n      camera.animation.update(delta);\n    } else {\n      control.update(delta);\n    }\n\n    renderer.render(projection, camera);\n    hotspot.render(camera);\n\n    if (camera.changed) {\n      this._emit(EVENTS.VIEW_CHANGE, {\n        yaw: camera.yaw,\n        pitch: camera.pitch,\n        zoom: camera.zoom,\n        quaternion: [\n          camera.quaternion[0],\n          camera.quaternion[1],\n          camera.quaternion[2],\n          camera.quaternion[3]\n        ]\n      });\n    }\n    camera.onFrameRender();\n\n    this._emit(EVENTS.RENDER);\n  };\n\n  private _emit<K extends keyof View360Events>(eventName: K, ...params: EventParams<View360Events, K>) {\n    const evtParams = params ? params[0] : {};\n\n    this.trigger(eventName as any, {\n      type: eventName,\n      target: this,\n      ...evtParams\n    });\n  }\n\n  private _renderFrameOnDemand = (delta: number) => {\n    const camera = this._camera;\n    const control = this._control;\n    const autoplay = this._autoplay;\n    const texture = this._projection?.getTexture();\n\n    if (!this._initialized || !texture) return;\n    if (\n      !camera.animation\n      && !control.animating\n      && !autoplay.playing\n      && !texture.isVideo()\n    ) return;\n\n    this.renderFrame(delta);\n  };\n\n  private _renderVRFrame = (_delta: number, frame: XRFrame) => {\n    const vr = this._vr;\n    const projection = this._projection;\n    const renderer = this._renderer;\n\n    if (!projection) return;\n\n    this._emit(EVENTS.BEFORE_RENDER);\n\n    renderer.renderVR(projection, vr, frame);\n\n    this._emit(EVENTS.RENDER);\n  }\n\n  private _applyProjection(projection: Projection, texture: Texture, prevProjection: Projection | null) {\n    const camera = this._camera;\n    const control = this._control;\n    const renderer = this._renderer;\n\n    // Remove previous projection\n    if (prevProjection) {\n      prevProjection.releaseAllResources(this._renderer.ctx);\n    }\n\n    projection.applyTexture(renderer.ctx, texture);\n    projection.updateCamera(camera);\n    projection.updateControl(control);\n\n    this._projection = projection;\n    this._emit(EVENTS.PROJECTION_CHANGE, {\n      projection\n    });\n  }\n\n  private async _loadTexture(projection: Projection): Promise<Texture> {\n    const contentLoader = new TextureLoader();\n    const { src, video } = projection;\n\n    this._emit(EVENTS.LOAD_START, {\n      src,\n      video\n    });\n\n    const texture = await contentLoader.load(src, video);\n\n    this._emit(EVENTS.LOAD, {\n      src,\n      video\n    });\n\n    return texture;\n  }\n\n  private _resizeComponents() {\n    const renderer = this._renderer;\n    const camera = this._camera;\n    const control = this._control;\n\n    renderer.resize();\n    camera.resize(renderer.width, renderer.height);\n    control.resize(renderer.width, renderer.height);\n  }\n\n  private _addEventHandlers(events: View360Options[\"on\"]) {\n    // Bind option \"on\"\n    Object.keys(events).forEach((evtName: keyof typeof EVENT_TYPES) => {\n      this.on(evtName, events[evtName]);\n    });\n  }\n\n  private _bindComponentEvents() {\n    // Bind internal component events\n    const root = this._rootEl;\n    const control = this._control;\n    const animator = this._animator;\n    const renderer = this._renderer;\n    const vr = this._vr;\n\n    const controlEventsToPropagate = [\n      CONTROL_EVENTS.STATIC_CLICK,\n      CONTROL_EVENTS.INPUT_START,\n      CONTROL_EVENTS.INPUT_END\n    ];\n\n    controlEventsToPropagate.forEach(evtName => {\n      control.rotate.on(evtName, evt => {\n        this._emit(evtName, evt);\n      });\n\n      control.zoom.on(evtName, evt => {\n        this._emit(evtName, evt);\n      });\n    });\n\n    vr.on(EVENTS.VR_START, evt => {\n      root.classList.add(DEFAULT_CLASS.IN_VR);\n\n      animator.changeContext(evt.session);\n      animator.start(this._renderVRFrame);\n\n      this._emit(EVENTS.VR_START);\n    });\n\n    vr.on(EVENTS.VR_END, () => {\n      root.classList.remove(DEFAULT_CLASS.IN_VR);\n\n      renderer.ctx.useDefaultFrameBuffer();\n      animator.changeContext(window);\n      animator.start(this._renderFrameOnDemand);\n\n      this.resize();\n\n      this._emit(EVENTS.VR_END);\n    });\n  }\n}\n\nexport default View360;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { mat4, quat, vec3 } from \"gl-matrix\";\n\n/**\n * Base class for 3D objects\n * @ko 3D 오브젝트의 베이스 클래스\n * @since 4.0.0\n * @internal\n */\nclass Object3D {\n  /**\n   * Local matrix of the object\n   * @ko 오브젝트의 local matrix\n   * @since 4.0.0\n   */\n  public matrix: mat4;\n  /**\n   * Rotation quaternion\n   * @ko 현재 오브젝트의 회전을 나타내는 사원수 값\n   * @since 4.0.0\n   */\n  public rotation: quat;\n  /**\n   * Position of the object\n   * @ko 오브젝트의 위치\n   * @since 4.0.0\n   */\n  public position: vec3;\n  /**\n   * A scale vector of the object\n   * @ko 오브젝트가 각 축으로 확대된 정도를 나타내는 벡터\n   * @since 4.0.0\n   */\n  public scale: vec3;\n\n  /**\n   * Create new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   */\n  public constructor() {\n    this.matrix = mat4.create();\n    this.rotation = quat.create();\n    this.position = vec3.fromValues(0, 0, 0);\n    this.scale = vec3.fromValues(1, 1, 1);\n  }\n\n  /**\n   * Update local matrix of the object.\n   * @ko 오브젝트의 local matrix를 갱신합니다.\n   * @since 4.0.0\n   */\n  public updateMatrix() {\n    mat4.fromRotationTranslationScale(this.matrix, this.rotation, this.position, this.scale);\n  }\n}\n\nexport default Object3D;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport View360Plugin from \"../View360Plugin\";\nimport View360 from \"../../View360\";\nimport { EVENTS } from \"../../const/external\";\nimport { createElement } from \"../../utils\";\nimport { LoadStartEvent } from \"../../type/events\";\n\n/**\n * Options for {@link LoadingSpinner}\n * @ko {@link LoadingSpinner}용 옵션들\n * @since 4.0.0\n * @category Plugin\n */\nexport interface LoadingSpinnerOptions {\n  /**\n   * Override default class names.\n   * @ko 디폴트 클래스 이름들을 오버라이드합니다.\n   * @since 4.0.0\n   */\n  className: Partial<{ -readonly [key in keyof typeof LoadingSpinner.DEFAULT_CLASS]: string }>;\n}\n\n/**\n * A plugin that displays loading spinner while loading the projection.\n * @ko 프로젝션 로딩중에 로딩 스피너를 보여주는 플러그인\n * @since 4.0.0\n * @category Plugin\n */\nclass LoadingSpinner implements View360Plugin {\n  /**\n   * Default class names that LoadingSpinner uses\n   * @ko LoadingSpinner가 사용하는 디폴트 클래스 이름\n   * @since 4.0.0\n   */\n  public static readonly DEFAULT_CLASS = {\n    /**\n     * A class name for the container element\n     * @ko 컨테이너 엘리먼트의 클래스 이름\n     * @since 4.0.0\n     */\n    CONTAINER: \"view360-spinner\",\n    /**\n     * A class name for the spinning ring element\n     * @ko 돌아가는 링 엘리먼트의 클래스 이름\n     * @since 4.0.0\n     */\n    RING: \"view360-spinner-ring\"\n  } as const;\n\n  /**\n   * A class names overriding\n   * @ko 현재 오버라이드 중인 클래스 이름\n   * @since 4.0.0\n   */\n  public readonly className: LoadingSpinnerOptions[\"className\"];\n\n  private _container: HTMLElement;\n\n  /**\n   * Create a new instance of LoadingSpinner. {@ko LoadingSpinner의 새 인스턴스를 생성합니다.}\n   * @param options Options {@ko 옵션들}\n   */\n  public constructor({\n    className = {}\n  }: Partial<LoadingSpinnerOptions> = {}) {\n    this.className = className;\n    this._container = this._createElements();\n  }\n\n  public init(viewer: View360) {\n    viewer.on(EVENTS.LOAD_START, this._startLoading);\n  }\n\n  public destroy(viewer: View360): void {\n    viewer.off(EVENTS.LOAD_START, this._startLoading);\n    this._detachElements({ target: viewer });\n  }\n\n  private _startLoading = ({ target: viewer }: LoadStartEvent) => {\n    viewer.rootEl.appendChild(this._container);\n\n    if (viewer.initialized) {\n      viewer.once(EVENTS.LOAD, this._detachElements);\n    } else {\n      viewer.once(EVENTS.READY, this._detachElements);\n    }\n  };\n\n  private _detachElements = ({ target: viewer }: { target: View360 }) => {\n    const container = this._container;\n    if (!container) return;\n\n    if (container.parentElement === viewer.rootEl) {\n      viewer.rootEl.removeChild(container);\n    }\n  };\n\n  private _createElements() {\n    const className = {\n      ...this.className,\n      ...LoadingSpinner.DEFAULT_CLASS\n    };\n\n    const container = createElement(className.CONTAINER);\n    const ring = createElement(className.RING);\n\n    container.appendChild(ring);\n\n    return container;\n  }\n}\n\nexport default LoadingSpinner;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\n/* eslint-disable @typescript-eslint/no-empty-function */\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport ControlBar from \"./ControlBar\";\nimport View360 from \"../../View360\";\n\n/**\n * Common options for {@link ControlBarItem}\n * @ko {@link ControlBarItem}의 공통 옵션들\n * @category Plugin\n * @since 4.0.0\n */\nexport interface ControlBarItemOptions {\n  /**\n   * @copy ControlBarItem#position\n   */\n  position: typeof ControlBar.POSITION[keyof typeof ControlBar.POSITION];\n  /**\n   * @copy ControlBarItem#order\n   */\n  order: number;\n}\n\n/**\n * Interface of the ControlBar items\n * @ko 컨트롤바 아이템의 인터페이스\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nabstract class ControlBarItem {\n  /**\n   * Element of the item.\n   * @ko 아이템의 엘리먼트\n   * @since 4.0.0\n   */\n  public abstract element: HTMLElement;\n\n  /**\n   * Position to display item.\n   * @ko 아이템을 표시할 위치.\n   * @since 4.0.0\n   */\n  public position: ControlBarItemOptions[\"position\"];\n  /**\n   * Order within the same position.\n   * The lowest one will be shown first.\n   * @ko 동일한 position 내에서의 순서, 작을수록 먼저 표시됩니다.\n   * @since 4.0.0\n   */\n  public order: ControlBarItemOptions[\"order\"];\n\n  /**\n   * Create new instance of the ControlBarItem\n   * @ko ControlBarItem의 새로운 인스턴스를 생성합니다.\n   * @param options Options {@ko 옵션들}\n   */\n  public constructor(options: ControlBarItemOptions) {\n    this.position = options.position;\n    this.order = options.order;\n  }\n\n  /**\n   * Initialize item.\n   * @ko 아이템을 초기화합니다.\n   * @param viewer - A instance of viewer to attach item {@ko 아이템을 부착할 뷰어의 인스턴스}\n   * @param controlBar - A instance of control bar to attach item {@ko 아이템을 부착할 컨트롤바의 인스턴스}\n   * @since 4.0.0\n   */\n  public abstract init(viewer: View360, controlBar: ControlBar): any;\n  /**\n   * Destroy item and release all resources & event handlers.\n   * @ko 아이템을 제거하고 할당된 모든 리소스 및 이벤트 핸들러를 제거합니다.\n   * @param viewer - A instance of viewer to detach item {@ko 아이템을 떼어 낼 뷰어의 인스턴스}\n   * @param controlBar - A instance of control bar to detach item {@ko 아이템을 떼어 낼 컨트롤바의 인스턴스}\n   * @since 4.0.0\n   */\n  public abstract destroy(viewer: View360, controlBar: ControlBar): any;\n}\n\nexport default ControlBarItem;\n","export const CONTROL_BAR_DEFAULT_CLASS = {\n  CONTROLS_ROOT: \"view360-controls\",\n  CONTROLS_BG: \"view360-controls-background\",\n  CONTROLS_MAIN: \"view360-controls-main\",\n  CONTROLS_TOP: \"view360-controls-top\",\n  CONTROLS_BOTTOM: \"view360-controls-bottom\",\n  CONTROLS_MID: \"view360-controls-mid\",\n  CONTROLS_LEFT: \"view360-controls-left\",\n  CONTROLS_RIGHT: \"view360-controls-right\",\n  CONTROLS_FLOAT_LEFT: \"view360-controls-float-left\",\n  CONTROLS_FLOAT_RIGHT: \"view360-controls-float-right\",\n  CONTROLS_BUTTON: \"view360-controls-button\",\n  PROGRESS_ROOT: \"view360-controls-progress\",\n  VOLUME_ROOT: \"view360-controls-volume\",\n  RANGE_ROOT: \"view360-range\",\n  RANGE_TRACK: \"view360-range-track\",\n  RANGE_THUMB: \"view360-range-thumb\",\n  RANGE_FILLER: \"view360-range-filler\",\n  PLAY_BUTTON: \"view360-controls-play\",\n  PAUSE_BUTTON: \"view360-controls-pause\",\n  UNMUTED_BUTTON: \"view360-controls-unmuted\",\n  MUTED_BUTTON: \"view360-controls-muted\",\n  FULLSCREEN_BUTTON: \"view360-controls-fullscreen\",\n  FULLSCREEN_EXIT_BUTTON: \"view360-controls-fullscreen-exit\",\n  VR_BUTTON: \"view360-controls-vr\",\n  GYRO_ENABLED: \"view360-controls-gyro-enabled\",\n  GYRO_DISABLED: \"view360-controls-gyro-disabled\",\n  VIDEO_TIME_DISPLAY: \"view360-controls-time\",\n  PIEVIEW_ROOT: \"view360-controls-pie\",\n  FIXED: \"view360-controls-fixed\",\n  UNAVAILABLE: \"view360-controls-unavailable\",\n  HIDDEN: \"view360-controls-hidden\"\n} as const;\n\nexport const CONTROL_BAR_ITEM_POSITION = {\n  /**\n   * Place control bar item floating at top-left corner\n   * @ko 아이템을 왼쪽 위 구석에 표시합니다.\n   * @since 4.0.0\n   */\n  TOP_LEFT: \"top-left\",\n  /**\n   * Place control bar item floating at top-right corner\n   * @ko 아이템을 오른쪽 위 구석에 표시합니다.\n   * @since 4.0.0\n   */\n  TOP_RIGHT: \"top-right\",\n  /**\n   * Place control bar item at upper block inside the bottom control bar.\n   * @ko 아이템을 하단에 표시되는 컨트롤바 내에서 위쪽 블럭에 표시합니다.\n   * @since 4.0.0\n   */\n  MAIN_TOP: \"main-top\",\n  /**\n   * Place control bar item at lower block inside the bottom control bar.\n   * @ko 아이템을 하단에 표시되는 컨트롤바 내에서 하단 블럭에 표시합니다.\n   * @since 4.0.0\n   */\n  MAIN_BOTTOM: \"main-bottom\",\n  /**\n   * Place control bar item at center-left block inside the bottom control bar.\n   * @ko 아이템을 하단에 표시되는 컨트롤바 내에서 중간 왼쪽 블럭에 표시합니다.\n   * @since 4.0.0\n   */\n  MAIN_LEFT: \"main-left\",\n  /**\n   * Place control bar item at center-right block inside the bottom control bar.\n   * @ko 아이템을 하단에 표시되는 컨트롤바 내에서 중간 오른쪽 블럭에 표시합니다.\n   * @since 4.0.0\n   */\n  MAIN_RIGHT: \"main-right\"\n} as const;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Component from \"@egjs/component\";\nimport { ControlBarOptions } from \"./ControlBar\";\nimport { CONTROL_BAR_DEFAULT_CLASS } from \"./const\";\nimport Motion from \"../../core/Motion\";\nimport MouseInput from \"../../control/input/MouseInput\";\nimport TouchInput from \"../../control/input/TouchInput\";\nimport { CONTROL_EVENTS, INFINITE_RANGE } from \"../../const/internal\";\nimport { clamp } from \"../../utils\";\nimport { InputEvents } from \"../../type/internal\";\nimport { EL_DIV } from \"../../const/browser\";\n\nclass RangeControl extends Component<{\n  [CONTROL_EVENTS.INPUT_START]: number;\n  [CONTROL_EVENTS.CHANGE]: number;\n  [CONTROL_EVENTS.INPUT_END]: void;\n}> {\n  public readonly rootEl: HTMLElement;\n  public readonly thumbEl: HTMLElement;\n  public readonly trackEl: HTMLElement;\n  public readonly fillerEl: HTMLElement;\n\n  private _motion: Motion;\n  private _mouseInput: MouseInput;\n  private _touchInput: TouchInput;\n  private _fixedClass: string;\n  private _bbox: DOMRect;\n\n  /**\n   *\n   */\n  public constructor() {\n    super();\n\n    const root = document.createElement(EL_DIV);\n    const track = document.createElement(EL_DIV);\n    const thumb = document.createElement(EL_DIV);\n    const filler = document.createElement(EL_DIV);\n\n    root.draggable = false;\n\n    track.appendChild(filler);\n    track.appendChild(thumb);\n    root.appendChild(track);\n\n    this.rootEl = root;\n    this.trackEl = track;\n    this.thumbEl = thumb;\n    this.fillerEl = filler;\n\n    this._mouseInput = new MouseInput();\n    this._touchInput = new TouchInput();\n    this._motion = new Motion({ duration: 1, range: INFINITE_RANGE, easing: x => x });\n    this._bbox = {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      top: 0\n    } as DOMRect;\n    this._fixedClass = CONTROL_BAR_DEFAULT_CLASS.FIXED;\n  }\n\n  public init(className: Required<ControlBarOptions[\"className\"]>) {\n    const mouseInput = this._mouseInput;\n    const touchInput = this._touchInput;\n\n    this.rootEl.classList.add(className.RANGE_ROOT);\n    this.trackEl.classList.add(className.RANGE_TRACK);\n    this.thumbEl.classList.add(className.RANGE_THUMB);\n    this.fillerEl.classList.add(className.RANGE_FILLER);\n    this._fixedClass = className.FIXED;\n\n    mouseInput.on(CONTROL_EVENTS.INPUT_START, this._onHold);\n    touchInput.on(CONTROL_EVENTS.INPUT_START, this._onHold);\n\n    mouseInput.on(CONTROL_EVENTS.INPUT_END, this._onRelease);\n    touchInput.on(CONTROL_EVENTS.INPUT_END, this._onRelease);\n\n    mouseInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    touchInput.on(CONTROL_EVENTS.CHANGE, this._onChange);\n\n    mouseInput.enable(this.rootEl);\n    touchInput.enable(this.rootEl);\n\n    this.resize();\n  }\n\n  public destroy() {\n    const mouseInput = this._mouseInput;\n    const touchInput = this._touchInput;\n\n    this.rootEl.className = \"\";\n    this.trackEl.className = \"\";\n    this.thumbEl.className = \"\";\n    this.fillerEl.className = \"\";\n\n    mouseInput.off();\n    touchInput.off();\n    mouseInput.disable();\n    touchInput.disable();\n  }\n\n  public resize() {\n    this._bbox = this.trackEl.getBoundingClientRect();\n  }\n\n  public updateStyle(progress: number) {\n    const width = this._bbox.width;\n    const clampedProgress = clamp(progress, 0, 1);\n\n    this.fillerEl.style.width = `${clampedProgress * 100}%`;\n    this.thumbEl.style.transform = `translateX(${clampedProgress * width}px)`;\n  }\n\n  private _onHold = ({ srcEvent, isTouch }: InputEvents<{ x: number; y: number }>[typeof CONTROL_EVENTS.INPUT_START]) => {\n    const bbox = this._bbox;\n    if (!bbox) return;\n\n    const x = isTouch\n      ? (srcEvent as TouchEvent).touches[0].pageX\n      : (srcEvent as MouseEvent).pageX;\n    const elX = bbox.x + (window.scrollX ?? window.pageXOffset);\n\n    const clamepdX = clamp(x, elX, elX + bbox.width);\n    const progress = (clamepdX - elX) / bbox.width;\n\n    this._motion.reset(clamepdX);\n    this.thumbEl.classList.add(this._fixedClass);\n\n    this.trigger(CONTROL_EVENTS.INPUT_START, progress);\n  };\n\n  private _onChange = ({ delta }: InputEvents<{ x: number; y: number }>[typeof CONTROL_EVENTS.CHANGE]) => {\n    const motion = this._motion;\n    const bbox = this._bbox;\n    if (!bbox) return;\n\n    motion.setNewEndByDelta(delta.x);\n    motion.update(1);\n\n    const elX = bbox.x + (window.scrollX ?? window.pageXOffset);\n    const clampedX = clamp(motion.val, elX, elX + bbox.width);\n    const progress = (clampedX - elX) / bbox.width;\n\n    this.trigger(CONTROL_EVENTS.CHANGE, progress);\n  };\n\n  private _onRelease = () => {\n    const bbox = this._bbox;\n    if (!bbox) return;\n\n    this.thumbEl.classList.remove(this._fixedClass);\n\n    this.trigger(CONTROL_EVENTS.INPUT_END);\n  };\n}\n\nexport default RangeControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport RangeControl from \"./RangeControl\";\nimport View360 from \"../../View360\";\nimport TextureVideo from \"../../texture/TextureVideo\";\nimport { CONTROL_EVENTS, VIDEO_TIME_CHANGE_EVENT } from \"../../const/internal\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport { EVENTS } from \"../../const/external\";\nimport * as BROWSER from \"../../const/browser\";\n\n/**\n * Show video progress bar.\n * @ko 비디오의 프로그레스 바를 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass ProgressBar extends ControlBarItem {\n  public get element() { return this._rangeControl.rootEl; }\n\n  private _controlBar: ControlBar | null;\n  private _video: TextureVideo | null;\n  private _rangeControl: RangeControl;\n\n  private _wasPaused: boolean;\n  private _currentTime: number;\n  private _duration: number;\n  private _playPromise: Promise<void> | null;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_TOP,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.position = position;\n    this.order = order;\n\n    this._controlBar = null;\n    this._rangeControl = new RangeControl();\n\n    this._video = null;\n    this._wasPaused = false;\n    this._currentTime = 0;\n    this._duration = 0;\n    this._playPromise = null;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const video = viewer.projection?.getTexture();\n    const element = this.element;\n    const rangeControl = this._rangeControl;\n    const unavailableClass = controlBar.className.UNAVAILABLE;\n\n    if (!video || !video.isVideo()) {\n      element.classList.add(unavailableClass);\n      return;\n    }\n\n    element.classList.remove(unavailableClass);\n    element.classList.add(controlBar.className.PROGRESS_ROOT);\n    viewer.on(EVENTS.RESIZE, this._onResize);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_TIME_UPDATE, this._onTimeUpdate);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_DURATION_CHANGE, this._onDurationChange);\n    video.source.addEventListener(VIDEO_TIME_CHANGE_EVENT, this._onTimeUpdate);\n    rangeControl.init(controlBar.className);\n    rangeControl.on(CONTROL_EVENTS.INPUT_START, this._onHold);\n    rangeControl.on(CONTROL_EVENTS.CHANGE, this._onControl);\n    rangeControl.on(CONTROL_EVENTS.INPUT_END, this._onRelease);\n\n    this._video = video;\n    this._currentTime = video.source.currentTime;\n    this._duration = video.source.duration;\n    this._controlBar = controlBar;\n\n    rangeControl.updateStyle(this._currentTime / this._duration);\n  }\n\n  public destroy(viewer: View360) {\n    const video = this._video;\n\n    viewer.off(EVENTS.RESIZE, this._onResize);\n\n    if (video) {\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_TIME_UPDATE, this._onTimeUpdate);\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_DURATION_CHANGE, this._onDurationChange);\n      video.source.removeEventListener(VIDEO_TIME_CHANGE_EVENT, this._onTimeUpdate);\n    }\n\n    this._rangeControl.destroy();\n    this._video = null;\n    this._playPromise = null;\n  }\n\n  private _onResize = () => {\n    this._rangeControl.resize();\n  }\n\n  private _onTimeUpdate = () => {\n    const video = this._video;\n    if (!video) return;\n\n    this._currentTime = video.source.currentTime;\n    this._rangeControl.updateStyle(this._currentTime / this._duration);\n  };\n\n  private _onDurationChange = () => {\n    const video = this._video;\n    if (!video) return;\n\n    this._duration = video.source.duration;\n    this._rangeControl.updateStyle(this._currentTime / this._duration);\n  };\n\n  private _onHold = (progress: number) => {\n    const video = this._video;\n    const controlBar = this._controlBar;\n    if (!video || !controlBar) return;\n\n    const paused = video.isPaused();\n\n    video.source.pause();\n\n    const time = video.source.duration * progress;\n    video.source.currentTime = time;\n    video.source.dispatchEvent(new CustomEvent(VIDEO_TIME_CHANGE_EVENT, { detail: { time }}));\n\n    controlBar.rootEl.classList.add(controlBar.className.FIXED);\n    this._wasPaused = !this._playPromise && paused;\n  };\n\n  private _onControl = (progress: number) => {\n    const video = this._video;\n    if (!video) return;\n\n    const time = video.source.duration * progress;\n    video.source.currentTime = time;\n    video.source.dispatchEvent(new CustomEvent(VIDEO_TIME_CHANGE_EVENT, { detail: { time }}));\n  };\n\n  private _onRelease = () => {\n    const video = this._video;\n    const controlBar = this._controlBar;\n\n    if (video && controlBar) {\n      if (!this._wasPaused && !this._playPromise) {\n        this._playPromise = video.source.play()\n          .catch(() => void 0);\n\n        // This should not be chained\n        this._playPromise.then(() => {\n          this._playPromise = null;\n        });\n\n        controlBar.rootEl.classList.remove(controlBar.className.FIXED);\n      }\n    }\n\n    this._wasPaused = false;\n  };\n}\n\nexport default ProgressBar;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport TextureVideo from \"../../texture/TextureVideo\";\nimport * as BROWSER from \"../../const/browser\";\n\n/**\n * Show video play / pause button.\n * @ko 비디오 재생 / 일시정지 버튼을 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass PlayButton extends ControlBarItem {\n  public readonly element: HTMLElement;\n  private _controlBar: ControlBar | null;\n  private _video: TextureVideo | null;\n  private _paused: boolean;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_LEFT,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.element = document.createElement(BROWSER.EL_BUTTON);\n\n    this._video = null;\n    this._paused = true;\n    this._controlBar = null;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const element = this.element;\n    const video = viewer.projection?.getTexture();\n    const className = controlBar.className;\n    const unavailableClass = className.UNAVAILABLE;\n\n    if (!video || !video.isVideo()) {\n      element.classList.add(unavailableClass);\n      return;\n    }\n\n    element.classList.add(className.CONTROLS_BUTTON);\n    element.classList.remove(unavailableClass);\n\n    const paused = video.isPaused();\n    this._video = video;\n    this._paused = paused;\n    this._controlBar = controlBar;\n\n    if (paused) {\n      this._onPause();\n    } else {\n      this._onPlay();\n    }\n\n    element.addEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_PLAY, this._onPlay);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_PAUSE, this._onPause);\n  }\n\n  public destroy() {\n    const video = this._video;\n    const element = this.element;\n\n    if (!video) return;\n\n    element.className = \"\";\n    element.removeEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    video.source.removeEventListener(BROWSER.EVENTS.VIDEO_PLAY, this._onPlay);\n    video.source.removeEventListener(BROWSER.EVENTS.VIDEO_PAUSE, this._onPause);\n\n    this._video = null;\n    this._paused = true;\n    this._controlBar = null;\n  }\n\n  private _onClick = () => {\n    const video = this._video;\n    if (!video) return;\n\n    if (this._paused) {\n      video.source.play();\n    } else {\n      video.source.pause();\n    }\n  };\n\n  private _onPlay = () => {\n    if (!this._controlBar) return;\n\n    const element = this.element;\n    const className = this._controlBar.className;\n\n    element.classList.add(className.PAUSE_BUTTON);\n    element.classList.remove(className.PLAY_BUTTON);\n    element.title = \"Pause Video\";\n\n    this._paused = false;\n  };\n\n  private _onPause = () => {\n    if (!this._controlBar) return;\n\n    const element = this.element;\n    const className = this._controlBar.className;\n\n    element.classList.add(className.PLAY_BUTTON);\n    element.classList.remove(className.PAUSE_BUTTON);\n    element.title = \"Play Video\";\n\n    this._paused = true;\n  };\n}\n\nexport default PlayButton;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport RangeControl from \"./RangeControl\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport TextureVideo from \"../../texture/TextureVideo\";\nimport * as BROWSER from \"../../const/browser\";\nimport { CONTROL_EVENTS } from \"../../const/internal\";\nimport { EVENTS } from \"../../const/external\";\n\n/**\n * Show video volume control.\n * @ko 비디오 볼륨 조절 버튼을 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass VolumeControl extends ControlBarItem {\n  public get element() { return this._rootEl; }\n\n  private _controlBar: ControlBar | null;\n  private _rootEl: HTMLButtonElement;\n  private _buttonEl: HTMLElement;\n  private _rangeControl: RangeControl;\n  private _video: TextureVideo | null;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_RIGHT,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this._controlBar = null;\n    this._rangeControl = new RangeControl();\n    this._createElements();\n\n    this._video = null;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const video = viewer.projection?.getTexture();\n    const root = this._rootEl;\n    const button = this._buttonEl;\n    const rangeControl = this._rangeControl;\n    const className = controlBar.className;\n    const unavailableClass = className.UNAVAILABLE;\n\n    if (!video || !video.isVideo()) {\n      root.classList.add(unavailableClass);\n      return;\n    }\n\n    root.classList.remove(unavailableClass);\n    root.classList.add(className.CONTROLS_BUTTON);\n    root.classList.add(className.VOLUME_ROOT);\n    button.classList.add(className.CONTROLS_BUTTON);\n\n    if (video.source.muted) {\n      button.classList.add(className.MUTED_BUTTON);\n    } else {\n      button.classList.add(className.UNMUTED_BUTTON);\n    }\n\n    viewer.on(EVENTS.RESIZE, this._onResize);\n    root.addEventListener(BROWSER.EVENTS.TRANSITION_END, this._onResize);\n    button.addEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_VOLUME_CHANGE, this._onVolumeChange);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_LOADED_DATA, this._updateDisplay);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_CAN_PLAYTHROUGH, this._updateDisplay);\n\n    rangeControl.init(className);\n    rangeControl.on(CONTROL_EVENTS.INPUT_START, this._onHold);\n    rangeControl.on(CONTROL_EVENTS.CHANGE, this._onChange);\n    rangeControl.on(CONTROL_EVENTS.INPUT_END, this._onRelease);\n\n    this._controlBar = controlBar;\n    this._video = video;\n\n    this._updateDisplay();\n  }\n\n  public destroy(viewer: View360) {\n    const video = this._video;\n    const button = this._buttonEl;\n    const root = this._rootEl;\n\n    root.className = \"\";\n    button.className = \"\";\n\n    viewer.off(EVENTS.RESIZE, this._onResize);\n    root.removeEventListener(BROWSER.EVENTS.TRANSITION_END, this._onResize);\n    button.removeEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n\n    if (video) {\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_VOLUME_CHANGE, this._onVolumeChange);\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_LOADED_DATA, this._updateDisplay);\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_CAN_PLAYTHROUGH, this._updateDisplay);\n    }\n\n    this._controlBar = null;\n    this._rangeControl.destroy();\n    this._video = null;\n  }\n\n  private _onResize = () => {\n    this._rangeControl.resize();\n    this._updateDisplay();\n  }\n\n  private _onClick = () => {\n    const video = this._video;\n    if (!video || this._rootEl.disabled) return;\n\n    video.source.muted = !video.source.muted;\n  };\n\n  private _onVolumeChange = () => {\n    const button = this._buttonEl;\n    const video = this._video;\n    const controlBar = this._controlBar;\n\n    if (!video || !controlBar) return;\n\n    const className = controlBar.className;\n\n    if (video.source.muted || video.source.volume === 0) {\n      button.classList.add(className.MUTED_BUTTON);\n      button.classList.remove(className.UNMUTED_BUTTON);\n    } else {\n      button.classList.add(className.UNMUTED_BUTTON);\n      button.classList.remove(className.MUTED_BUTTON);\n    }\n\n    this._updateDisplay();\n  };\n\n  private _createElements() {\n    const root = document.createElement(BROWSER.EL_BUTTON);\n    const buttonEl = document.createElement(BROWSER.EL_DIV);\n\n    root.appendChild(this._rangeControl.rootEl);\n    root.appendChild(buttonEl);\n    root.title = \"Toggle Mute\";\n\n    this._rootEl = root;\n    this._buttonEl = buttonEl;\n  }\n\n  private _onHold = (progress: number) => {\n    const video = this._video;\n    const controlBar = this._controlBar;\n\n    if (!video || !controlBar) return;\n\n    const className = controlBar.className;\n\n    video.source.volume = progress;\n\n    this._rootEl.classList.add(className.FIXED);\n    controlBar.containerEl.classList.add(className.FIXED);\n\n    this._updateDisplay();\n  };\n\n  private _onChange = (progress: number) => {\n    const video = this._video;\n    if (!video) return;\n\n    video.source.volume = progress;\n    if (progress > 0) {\n      video.source.muted = false;\n    } else {\n      video.source.muted = true;\n    }\n\n    this._updateDisplay();\n  };\n\n  private _onRelease = () => {\n    const controlBar = this._controlBar;\n    if (!controlBar) return;\n\n    const className = controlBar.className;\n\n    this._rootEl.classList.remove(className.FIXED);\n    controlBar.containerEl.classList.remove(className.FIXED);\n  };\n\n  private _updateDisplay = () => {\n    const video = this._video;\n    const root = this._rootEl;\n    if (!video) return;\n\n    if (!video.hasAudio()) {\n      root.disabled = true;\n      return;\n    }\n\n    root.disabled = false;\n\n    const volume = video.source.muted ? 0 : video.source.volume;\n\n    this._rangeControl.updateStyle(volume);\n  };\n}\n\nexport default VolumeControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport * as BROWSER from \"../../const/browser\";\nimport { isFullscreen } from \"../../utils\";\n\n/**\n * Show fullscreen enter / exit button.\n * @ko 풀스크린 진입 / 해제 버튼을 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass FullscreenButton extends ControlBarItem {\n  public readonly element: HTMLElement;\n  private _controlBar: ControlBar | null;\n  private _targetEl: HTMLElement | null;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_RIGHT,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.element = document.createElement(BROWSER.EL_BUTTON);\n    this.element.title = \"Toggle Fullscreen\";\n    this._controlBar = null;\n    this._targetEl = null;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const element = this.element;\n    const className = controlBar.className;\n\n    if (!this._fullscreenAvailable()) {\n      element.classList.add(className.UNAVAILABLE);\n      return;\n    }\n\n    element.classList.add(className.CONTROLS_BUTTON);\n    element.classList.remove(className.UNAVAILABLE);\n    element.addEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    this._addFullscreenHandlers();\n\n    if (isFullscreen()) {\n      element.classList.add(className.FULLSCREEN_EXIT_BUTTON);\n    } else {\n      element.classList.add(className.FULLSCREEN_BUTTON);\n    }\n\n    this._controlBar = controlBar;\n    this._targetEl = viewer.rootEl;\n  }\n\n  public destroy() {\n    const element = this.element;\n\n    element.className = \"\";\n    element.removeEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    this._removeFullscreenHandlers();\n\n    this._controlBar = null;\n    this._targetEl = null;\n  }\n\n  private _onClick = () => {\n    const target = this._targetEl;\n    if (!target) return;\n\n    if (isFullscreen()) {\n      this._exitFullscreen();\n    } else {\n      this._requestFullscreen(target);\n    }\n  };\n\n  private _fullscreenAvailable() {\n    return BROWSER.FULLSCREEN_REQUEST.some(key => !!document[key]);\n  }\n\n  private _requestFullscreen(el: HTMLElement) {\n    for (const key of BROWSER.FULLSCREEN_REQUEST) {\n      const request = el[key];\n      if (request) {\n        request.call(el);\n        return;\n      }\n    }\n  }\n\n  private _exitFullscreen() {\n    for (const key of BROWSER.FULLSCREEN_EXIT) {\n      const exit = document[key];\n\n      if (exit) {\n        exit.call(document);\n        return;\n      }\n    }\n  }\n\n  private _addFullscreenHandlers() {\n    BROWSER.FULLSCREEN_CHANGE.forEach(evtName => {\n      document.addEventListener(evtName, this._onFullscreenChange);\n    });\n  }\n\n  private _removeFullscreenHandlers() {\n    BROWSER.FULLSCREEN_CHANGE.forEach(evtName => {\n      document.removeEventListener(evtName, this._onFullscreenChange);\n    });\n  }\n\n  private _onFullscreenChange = () => {\n    const element = this.element;\n    const controlBar = this._controlBar;\n\n    if (!controlBar) return;\n\n    const className = controlBar.className;\n\n    if (isFullscreen()) {\n      element.classList.add(className.FULLSCREEN_EXIT_BUTTON);\n      element.classList.remove(className.FULLSCREEN_BUTTON);\n    } else {\n      element.classList.add(className.FULLSCREEN_BUTTON);\n      element.classList.remove(className.FULLSCREEN_EXIT_BUTTON);\n    }\n  };\n}\n\nexport default FullscreenButton;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport TextureVideo from \"../../texture/TextureVideo\";\nimport * as BROWSER from \"../../const/browser\";\nimport { VIDEO_TIME_CHANGE_EVENT } from \"../../const/internal\";\n\n/**\n * Show video current / total time.\n * @ko 비디오의 현재 / 총 재생시간을 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass VideoTime extends ControlBarItem {\n  public readonly element: HTMLElement;\n  private _video: TextureVideo | null;\n  private _currentTime: number;\n  private _duration: number;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_LEFT,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.element = document.createElement(BROWSER.EL_DIV);\n\n    this._video = null;\n    this._currentTime = 0;\n    this._duration = 0;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const video = viewer.projection?.getTexture();\n    const element = this.element;\n    const className = controlBar.className;\n\n    if (!video || !video.isVideo()) {\n      element.classList.add(className.UNAVAILABLE);\n      return;\n    }\n\n    element.classList.add(className.VIDEO_TIME_DISPLAY);\n    element.classList.remove(className.UNAVAILABLE);\n\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_TIME_UPDATE, this._onTimeUpdate);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_DURATION_CHANGE, this._onDurationChange);\n    video.source.addEventListener(VIDEO_TIME_CHANGE_EVENT, this._onCustomTimeChange);\n\n    this._video = video;\n    this._currentTime = video.source.currentTime;\n    this._duration = video.source.duration;\n\n    this._updateDisplay();\n  }\n\n  public destroy() {\n    const video = this._video;\n\n    if (!video) return;\n\n    this.element.className = \"\";\n    video.source.removeEventListener(BROWSER.EVENTS.VIDEO_TIME_UPDATE, this._onTimeUpdate);\n    video.source.removeEventListener(BROWSER.EVENTS.VIDEO_DURATION_CHANGE, this._onDurationChange);\n    video.source.removeEventListener(VIDEO_TIME_CHANGE_EVENT, this._onCustomTimeChange);\n\n    this._video = null;\n  }\n\n  private _onTimeUpdate = () => {\n    const video = this._video;\n    if (!video) return;\n\n    this._currentTime = video.source.currentTime;\n    this._updateDisplay();\n  };\n\n  private _onDurationChange = () => {\n    const video = this._video;\n    if (!video) return;\n\n    this._duration = video.source.duration;\n    this._updateDisplay();\n  };\n\n  private _onCustomTimeChange = (evt: CustomEvent<{ time: number }>) => {\n    this._currentTime = evt.detail.time;\n    this._updateDisplay();\n  };\n\n  private _updateDisplay() {\n    const time = this._currentTime;\n    const timeMinute = Math.floor(time / 60);\n    const timeSeconds = Math.floor(time - timeMinute * 60);\n    const timeSecondsFormatted = timeSeconds < 10 ? `0${timeSeconds}` : timeSeconds;\n\n    const duration = this._duration;\n    const durationMinute = Math.floor(duration / 60);\n    const durationSeconds = Math.floor(duration - durationMinute * 60);\n    const durationSecondsFormatted = durationSeconds < 10 ? `0${durationSeconds}` : durationSeconds;\n\n    this.element.innerText = `${timeMinute}:${timeSecondsFormatted} / ${durationMinute}:${durationSecondsFormatted}`;\n  }\n}\n\nexport default VideoTime;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport { circulate, getObjectOption } from \"../../utils\";\nimport * as BROWSER from \"../../const/browser\";\nimport { EVENTS } from \"../../const/external\";\nimport { SVG_NAMESPACE } from \"../../const/internal\";\n\n/**\n * Options for {@link PieView}\n * @ko {@link PieView}용 옵션들\n * @category Plugin\n */\nexport interface PieViewOptions extends ControlBarItemOptions {\n  /**\n   * @copy PieView#resetCamera\n   */\n  resetCamera: boolean | Partial<{\n    yaw: number;\n    pitch: number;\n    zoom: number;\n    duration: number;\n    easing: (x: number) => number;\n  }>;\n}\n\n/**\n * Show camera direction/fov indicator.\n * @ko 카메라가 향하는 방향 및 FOV를 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass PieView extends ControlBarItem {\n  public readonly element: HTMLElement;\n\n  /**\n   * Set rotation to reset camera to when PieView is clicked.\n   * `false` will disable this value, and `true` will enable with default options.\n   * @ko PieView가 클릭되었을 때 카메라를 리셋할 방향을 지정합니다.\n   * `false`일 경우 이 동작을 비활성화하며, `true`일 경우 기본값을 사용합니다.\n   * @since 4.0.0\n   */\n  public resetCamera: PieViewOptions[\"resetCamera\"];\n\n  private _viewer: View360 | null;\n  private _piePathEl: SVGPathElement;\n  private _rangeCircleEl: SVGCircleElement;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    resetCamera = true,\n    position = CONTROL_BAR_ITEM_POSITION.TOP_RIGHT,\n    order = 9999\n  }: Partial<PieViewOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.element = document.createElement(BROWSER.EL_DIV);\n    this.element.title = \"Reset view\";\n    this.resetCamera = resetCamera;\n    this._createPieElements();\n    this._viewer = null;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const element = this.element;\n\n    if (!viewer.initialized) {\n      viewer.once(EVENTS.READY, this._updatePie);\n    } else {\n      this._updatePie({ target: viewer });\n    }\n\n    const rootClass = controlBar.className.PIEVIEW_ROOT;\n    element.classList.add(rootClass);\n\n    if (this.resetCamera) {\n      element.addEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    }\n\n    viewer.on(EVENTS.VIEW_CHANGE, this._updatePie);\n\n    this._viewer = viewer;\n  }\n\n  public destroy(viewer: View360) {\n    const element = this.element;\n\n    element.removeEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    element.className = \"\";\n    viewer.off(EVENTS.READY, this._updatePie);\n    viewer.off(EVENTS.VIEW_CHANGE, this._updatePie);\n\n    this._viewer = null;\n  }\n\n  private _onClick = () => {\n    const viewer = this._viewer;\n    const resetCamera = this.resetCamera;\n\n    if (!viewer || !resetCamera) return;\n\n    const {\n      yaw = viewer.initialYaw,\n      pitch = viewer.initialPitch,\n      zoom = viewer.initialZoom,\n      duration = 500\n    } = getObjectOption(resetCamera);\n\n    viewer.camera.animateTo({\n      yaw,\n      pitch,\n      zoom,\n      duration\n    });\n  };\n\n  private _createPieElements() {\n    const root = this.element;\n    const pieSVG = document.createElementNS(SVG_NAMESPACE, \"svg\");\n    pieSVG.setAttribute(\"viewBox\", \"0 0 48 48\");\n    pieSVG.setAttribute(\"width\", \"100%\");\n    pieSVG.setAttribute(\"height\", \"100%\");\n\n    const piePath = document.createElementNS(SVG_NAMESPACE, \"circle\");\n\n    piePath.setAttribute(\"stroke\", \"currentColor\");\n    piePath.setAttribute(\"fill\", \"transparent\");\n    piePath.setAttribute(\"cx\", \"24\");\n    piePath.setAttribute(\"cy\", \"24\");\n    piePath.setAttribute(\"r\", \"12\");\n    piePath.setAttribute(\"stroke-width\", \"24\");\n    pieSVG.appendChild(piePath);\n\n    const rangeCircle = document.createElementNS(SVG_NAMESPACE, \"circle\");\n\n    rangeCircle.setAttribute(\"stroke\", \"currentColor\");\n    rangeCircle.setAttribute(\"fill\", \"transparent\");\n    rangeCircle.setAttribute(\"cx\", \"24\");\n    rangeCircle.setAttribute(\"cy\", \"24\");\n    rangeCircle.setAttribute(\"r\", \"22.5\");\n    rangeCircle.setAttribute(\"stroke-width\", \"3\");\n    pieSVG.appendChild(rangeCircle);\n\n    root.appendChild(pieSVG);\n\n    this._piePathEl = piePath;\n    this._rangeCircleEl = rangeCircle;\n  }\n\n  private _updatePie = ({ target: viewer }: { target: View360 }) => {\n    const piePath = this._piePathEl;\n    const rangeCircle = this._rangeCircleEl;\n    const camera = viewer.camera;\n    const fov = camera.getHorizontalFov();\n    const yawRange = camera.getYawRange(camera.zoom);\n    const halfFov = fov * 0.5;\n\n    const pieRadius = 24 * Math.PI;\n    const pieDeg = pieRadius * fov / 360;\n    const pieOffset = pieRadius * (camera.yaw + halfFov + 90) / 360;\n\n    piePath.setAttribute(\"stroke-dasharray\", `${pieDeg} ${pieRadius - pieDeg}`);\n    piePath.setAttribute(\"stroke-dashoffset\", `${pieOffset}`);\n\n    if (isFinite(yawRange.min) && isFinite(yawRange.max)) {\n      const radius = 45 * Math.PI; // 2 * PI * r\n      const min = (circulate(yawRange.min, -180, 180) - halfFov) / 360;\n      const max = (circulate(yawRange.max, -180, 180) + halfFov) / 360;\n\n      const rangeDiff = radius * Math.abs(max - min);\n      const offset = -radius * (min - 0.25);\n\n      rangeCircle.setAttribute(\"stroke-dasharray\", `${rangeDiff} ${radius - rangeDiff}`);\n      rangeCircle.setAttribute(\"stroke-dashoffset\", `${offset}`);\n    } else {\n      rangeCircle.setAttribute(\"stroke-dasharray\", \"\");\n      rangeCircle.setAttribute(\"stroke-dashoffset\", \"\");\n    }\n  };\n}\n\nexport default PieView;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport * as BROWSER from \"../../const/browser\";\n\n/**\n * Show VR enter button.\n * @ko VR 진입 버튼을 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass VRButton extends ControlBarItem {\n  public readonly element: HTMLElement;\n\n  private _viewer: View360 | null;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_RIGHT,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.element = document.createElement(BROWSER.EL_BUTTON);\n    this.element.title = \"Enter VR\";\n    this._viewer = null;\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const element = this.element;\n    const className = controlBar.className;\n\n    element.classList.add(className.UNAVAILABLE);\n    element.classList.add(className.VR_BUTTON);\n    element.classList.add(className.CONTROLS_BUTTON);\n\n    viewer.vr.isAvailable()\n      .then(available => {\n        if (available) {\n          element.classList.remove(className.UNAVAILABLE);\n        }\n      });\n\n    element.addEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    this._viewer = viewer;\n  }\n\n  public destroy() {\n    const element = this.element;\n\n    element.className = \"\";\n    element.removeEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n\n    this._viewer = null;\n  }\n\n  private _onClick = () => {\n    const viewer = this._viewer;\n    if (!viewer) return;\n\n    viewer.vr.enter();\n  };\n}\n\nexport default VRButton;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport { CONTROL_BAR_ITEM_POSITION } from \"./const\";\nimport View360 from \"../../View360\";\nimport * as BROWSER from \"../../const/browser\";\nimport GyroControl from \"../../control/GyroControl\";\nimport { CONTROL_EVENTS } from \"../../const/internal\";\nimport { sensorCanBeEnabledIOS } from \"../../utils\";\n\n/**\n * Show gyroscope control enable / disable button\n * @ko 자이로스코프 컨트롤 활성화 / 비활성화 버튼을 표시합니다.\n * @category Plugin\n * @group ControlBar\n * @since 4.0.0\n */\nclass GyroButton extends ControlBarItem {\n  public readonly element: HTMLElement;\n  private _viewer: View360 | null;\n  private _controlBar: ControlBar | null;\n\n  /**\n   * Create a new instance.\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    position = CONTROL_BAR_ITEM_POSITION.MAIN_RIGHT,\n    order = 9999\n  }: Partial<ControlBarItemOptions> = {}) {\n    super({\n      position,\n      order\n    });\n\n    this.element = document.createElement(BROWSER.EL_DIV);\n    this.element.title = \"Toggle gyroscope control\";\n  }\n\n  public init(viewer: View360, controlBar: ControlBar) {\n    const element = this.element;\n    const className = controlBar.className;\n\n    element.addEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    element.classList.add(className.CONTROLS_BUTTON);\n    element.classList.add(className.UNAVAILABLE);\n\n    const enableButton = () => {\n      element.classList.remove(className.UNAVAILABLE);\n      viewer.control.gyro.on(CONTROL_EVENTS.ENABLE, this._updateStyle);\n      viewer.control.gyro.on(CONTROL_EVENTS.DISABLE, this._updateStyle);\n    };\n\n    if (sensorCanBeEnabledIOS()) {\n      enableButton();\n    } else {\n      GyroControl.isAvailable().then(available => {\n        if (!available) return;\n        enableButton();\n      });\n    }\n\n    this._controlBar = controlBar;\n    this._viewer = viewer;\n    this._updateStyle();\n  }\n\n  public destroy(viewer: View360) {\n    const element = this.element;\n\n    viewer.control.gyro.off(CONTROL_EVENTS.ENABLE, this._updateStyle);\n    viewer.control.gyro.off(CONTROL_EVENTS.DISABLE, this._updateStyle);\n    element.removeEventListener(BROWSER.EVENTS.CLICK, this._onClick);\n    element.className = \"\";\n\n    this._controlBar = null;\n    this._viewer = null;\n  }\n\n  private _onClick = () => {\n    const viewer = this._viewer;\n    const controlBar = this._controlBar;\n\n    if (!viewer || !controlBar) return;\n\n    const gyroControl = viewer.control.gyro;\n    if (gyroControl.enabled) {\n      gyroControl.disable();\n    } else {\n      GyroControl.requestSensorPermission().then(available => {\n        if (available) {\n          gyroControl.enable();\n        } else {\n          this.element.classList.add(controlBar.className.UNAVAILABLE);\n        }\n      });\n    }\n  };\n\n  private _updateStyle = () => {\n    const element = this.element;\n    const viewer = this._viewer;\n    const controlBar = this._controlBar;\n\n    if (!viewer || !controlBar) return;\n\n    const gyroControl = viewer.control.gyro;\n    const className = controlBar.className;\n\n    if (gyroControl.enabled) {\n      element.classList.add(className.GYRO_ENABLED);\n      element.classList.remove(className.GYRO_DISABLED);\n    } else {\n      element.classList.add(className.GYRO_DISABLED);\n      element.classList.remove(className.GYRO_ENABLED);\n    }\n  };\n}\n\nexport default GyroButton;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBar from \"./ControlBar\";\nimport View360 from \"../../View360\";\nimport * as BROWSER from \"../../const/browser\";\nimport { FULLSCREEN_CHANGE } from \"../../const/browser\";\nimport TextureVideo from \"../../texture/TextureVideo\";\nimport { isFullscreen } from \"../../utils\";\n\n/**\n * Options for ControlBar's {@link ControlBarOptions#autoHide}\n * @ko ControlBar의 {@link ControlBarOptions#autoHide}용 옵션\n * @category Plugin\n * @since 4.0.0\n */\nexport interface AutoHideOptions {\n  /**\n   * Initial delay before the control bar hides (ms)\n   * @ko 컨트롤바가 처음으로 표시되고 사라지기까지 걸리는 시간 (ms)\n   * @default 3000\n   * @since 4.0.0\n   */\n  initialDelay: number;\n  /**\n   * Delay time before hiding the control bar after mouse leave (ms)\n   * @ko 마우스가 컨트롤바 영역을 떠난 뒤 컨트롤바가 사라지기까지 걸리는 시간 (ms)\n   * @default 0\n   * @since 4.0.0\n   */\n  delay: number;\n  /**\n   * Delay time before hiding the control bar becomes active, like touch on mobile device or mouse move in fullscreen mode (ms)\n   * @ko 모바일이나 풀스크린 환경 등에서 사용자 입력이 없을 때 컨트롤바가 사라지기까지 걸리는 시간 (ms)\n   * @default 3000\n   * @since 4.0.0\n   */\n  idleDelay: number;\n}\n\nclass AutoHide {\n  private _initialDelay: AutoHideOptions[\"initialDelay\"];\n  private _delay: AutoHideOptions[\"delay\"];\n  private _idleDelay: AutoHideOptions[\"idleDelay\"];\n\n  private _controlBar: ControlBar;\n  private _timer: number;\n  private _isGrabbing: boolean;\n  private _isCursorInside: boolean;\n  private _isFullscreen: boolean;\n  private _targetEl: HTMLElement | null;\n  private _video: TextureVideo | null;\n\n  public get enabled() { return !!this._targetEl; }\n  public get hidden() { return this._controlBar.containerEl.classList.contains(this._hiddenClass); }\n\n  private get _hiddenClass() { return this._controlBar.className.HIDDEN; }\n  private get _fixedClass() { return this._controlBar.className.FIXED; }\n\n  public constructor(controlBar: ControlBar, {\n    initialDelay = 3000,\n    delay = 0,\n    idleDelay: activationDelay = 3000\n  }: Partial<AutoHideOptions>) {\n    this._controlBar = controlBar;\n    this._initialDelay = initialDelay;\n    this._delay = delay;\n    this._idleDelay = activationDelay;\n    this._timer = -1;\n    this._isCursorInside = false;\n    this._isGrabbing = false;\n    this._isFullscreen = false;\n    this._video = null;\n    this._targetEl = null;\n  }\n\n  public enable(viewer: View360) {\n    if (this._targetEl) {\n      this.disable(viewer);\n    }\n\n    const initialDelay = this._initialDelay;\n    const root = viewer.rootEl;\n\n    this._targetEl = viewer.rootEl;\n    this._timer = window.setTimeout(() => {\n      this.hide();\n    }, initialDelay);\n\n    root.addEventListener(BROWSER.EVENTS.MOUSE_DOWN, this._onHold);\n    root.addEventListener(BROWSER.EVENTS.MOUSE_ENTER, this._onMouseEnter);\n    root.addEventListener(BROWSER.EVENTS.MOUSE_MOVE, this._onMouseMove);\n    root.addEventListener(BROWSER.EVENTS.MOUSE_LEAVE, this._onMouseLeave);\n    this._addFullscreenHandlers();\n\n    const video = viewer.projection?.getTexture();\n    if (!video || !video.isVideo()) {\n      return;\n    }\n\n    if (video.isPaused()) {\n      this._controlBar.containerEl.classList.add(this._fixedClass);\n    }\n\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_PLAY, this._onVideoPlay);\n    video.source.addEventListener(BROWSER.EVENTS.VIDEO_PAUSE, this._onVideoPause);\n\n    this._video = video;\n  }\n\n  public disable(viewer: View360) {\n    if (!this._targetEl) return;\n\n    const controlBar = this._controlBar;\n    const root = viewer.rootEl;\n    const video = this._video;\n\n    root.removeEventListener(BROWSER.EVENTS.MOUSE_DOWN, this._onHold);\n    window.removeEventListener(BROWSER.EVENTS.MOUSE_UP, this._onRelease);\n    root.removeEventListener(BROWSER.EVENTS.MOUSE_ENTER, this._onMouseEnter);\n    root.removeEventListener(BROWSER.EVENTS.MOUSE_MOVE, this._onMouseMove);\n    root.removeEventListener(BROWSER.EVENTS.MOUSE_LEAVE, this._onMouseLeave);\n    this._removeFullscreenHandlers();\n\n    window.clearTimeout(this._timer);\n    controlBar.containerEl.classList.remove(this._fixedClass);\n\n    if (video) {\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_PLAY, this._onVideoPlay);\n      video.source.removeEventListener(BROWSER.EVENTS.VIDEO_PAUSE, this._onVideoPause);\n    }\n\n    this._isCursorInside = false;\n    this._isGrabbing = false;\n    this._video = null;\n    this._targetEl = null;\n  }\n\n  public show() {\n    this._clearHideTimer();\n    this._controlBar.containerEl.classList.remove(this._hiddenClass);\n  }\n\n  public showTemporaliy() {\n    this.show();\n    this._hideAfterDelay(this._idleDelay);\n  }\n\n  public hide() {\n    this._clearHideTimer();\n    this._controlBar.containerEl.classList.add(this._hiddenClass);\n  }\n\n  private _clearHideTimer() {\n    if (this._timer) {\n      window.clearTimeout(this._timer);\n      this._timer = -1;\n    }\n  }\n\n  private _hideAfterDelay(delay = this._delay) {\n    if (this._isGrabbing || (!this._isFullscreen && this._isCursorInside)) return;\n\n    this._clearHideTimer();\n    if (delay <= 0) {\n      this.hide();\n    } else {\n      this._timer = window.setTimeout(() => {\n        this.hide();\n      }, delay);\n    }\n  }\n\n  private _onMouseEnter = () => {\n    this._isCursorInside = true;\n    this.show();\n  };\n\n  private _onMouseLeave = () => {\n    this._isCursorInside = false;\n    this._hideAfterDelay();\n  };\n\n  private _onMouseMove = () => {\n    if (!this._isFullscreen) return;\n\n    this.showTemporaliy();\n  }\n\n  private _onHold = (evt: PointerEvent) => {\n    this._isGrabbing = true;\n\n    if (evt.pointerType === \"mouse\") {\n      this._isCursorInside = true;\n    }\n\n    window.addEventListener(BROWSER.EVENTS.MOUSE_UP, this._onRelease);\n\n    this.show();\n  };\n\n  private _onRelease = () => {\n    this._isGrabbing = false;\n\n    window.removeEventListener(BROWSER.EVENTS.MOUSE_UP, this._onRelease);\n\n    this._hideAfterDelay();\n  };\n\n  private _onVideoPlay = () => {\n    const root = this._targetEl;\n    if (!root) return;\n\n    this._controlBar.containerEl.classList.remove(this._fixedClass);\n  };\n\n  private _onVideoPause = () => {\n    const root = this._targetEl;\n    if (!root) return;\n\n    this._controlBar.containerEl.classList.add(this._fixedClass);\n  };\n\n  private _addFullscreenHandlers() {\n    FULLSCREEN_CHANGE.forEach(evtName => {\n      document.addEventListener(evtName, this._onFullscreenChange);\n    });\n  }\n\n  private _removeFullscreenHandlers() {\n    FULLSCREEN_CHANGE.forEach(evtName => {\n      document.removeEventListener(evtName, this._onFullscreenChange);\n    });\n  }\n\n  private _onFullscreenChange = () => {\n    this._isFullscreen = isFullscreen();\n\n    if (this._isFullscreen) {\n      this._hideAfterDelay();\n    }\n  };\n}\n\nexport default AutoHide;\n","import TextureVideo from \"../../texture/TextureVideo\";\nimport * as BROWSER from \"../../const/browser\";\nimport { clamp } from \"../../utils\";\nimport { VIDEO_TIME_CHANGE_EVENT } from \"../../const/internal\";\n\nclass VideoControl {\n  private _video: TextureVideo | null;\n\n  public enable(root: HTMLElement, video: TextureVideo) {\n    this._video = video;\n    // capture is needed for resolving conflict with keyboard control\n    root.addEventListener(BROWSER.EVENTS.KEY_DOWN, this._onKeyDown, true);\n  }\n\n  public disable(root: HTMLElement) {\n    this._video = null;\n    root.removeEventListener(BROWSER.EVENTS.KEY_DOWN, this._onKeyDown, true);\n  }\n\n  private _onKeyDown = (event: KeyboardEvent) => {\n    const video = this._video;\n    if (!video) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    const videoEl = video.source;\n    const keyPressed = event.keyCode != null\n      ? BROWSER.DIRECTION_KEY_CODE[event.keyCode]\n      : BROWSER.DIRECTION_KEY_NAME[event.key];\n\n    switch (keyPressed) {\n      case \"LEFT\":\n      case \"RIGHT\":\n        return this._changeVideoTime(videoEl, keyPressed === \"RIGHT\");\n      case \"UP\":\n      case \"DOWN\":\n        return this._changeVideoVolume(videoEl, keyPressed === \"UP\");\n    }\n\n    const spacePressed = event.keyCode === BROWSER.SPACE_KEY_CODE || event.key === BROWSER.SPACE_KEY_NAME;\n    if (spacePressed) {\n      this._toggleVideo(video);\n    }\n  }\n\n  private _changeVideoTime(video: HTMLVideoElement, forward: boolean) {\n    const delta = forward ? 5 : -5;\n\n    video.currentTime += delta;\n    video.dispatchEvent(new CustomEvent(VIDEO_TIME_CHANGE_EVENT, { detail: { time: video.currentTime }}));\n  }\n\n  private _changeVideoVolume(video: HTMLVideoElement, increase: boolean) {\n    const delta = increase ? 0.1 : -0.1;\n\n    if (video.muted) {\n      video.volume = clamp(delta, 0, 1);\n    } else {\n      video.volume = clamp(video.volume + delta, 0, 1);\n    }\n\n    if (video.volume > 0) {\n      video.muted = false;\n    } else {\n      video.muted = true;\n    }\n  }\n\n  private _toggleVideo(video: TextureVideo) {\n    if (video.isPaused()) {\n      video.source.play();\n    } else {\n      video.source.pause();\n    }\n  }\n}\n\nexport default VideoControl;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport ControlBarItem, { ControlBarItemOptions } from \"./ControlBarItem\";\nimport ProgressBar from \"./ProgressBar\";\nimport PlayButton from \"./PlayButton\";\nimport VolumeControl from \"./VolumeControl\";\nimport FullscreenButton from \"./FullscreenButton\";\nimport VideoTime from \"./VideoTime\";\nimport PieView, { PieViewOptions } from \"./PieView\";\nimport VRButton from \"./VRButton\";\nimport GyroButton from \"./GyroButton\";\nimport AutoHide, { AutoHideOptions } from \"./AutoHide\";\nimport VideoControl from \"./VideoControl\";\nimport View360, { View360Events } from \"../../View360\";\nimport View360Plugin from \"../View360Plugin\";\nimport { EVENTS } from \"../../const/external\";\nimport { createElement, findIndex, getObjectOption } from \"../../utils\";\nimport { ValueOf } from \"../../type/utils\";\nimport { StaticClickEvent } from \"../../type/events\";\nimport { CONTROL_BAR_DEFAULT_CLASS, CONTROL_BAR_ITEM_POSITION } from \"./const\";\n\n/**\n * Options for {@link ControlBar}\n * @ko {@link ControlBar}용 옵션들\n * @category Plugin\n * @since 4.0.0\n */\nexport interface ControlBarOptions {\n  /**\n   * @copy ControlBar#autoHide\n   */\n  autoHide: boolean | Partial<AutoHideOptions>;\n  /**\n   * @copy ControlBar#showBackground\n   */\n  showBackground: boolean;\n  /**\n   * @copy ControlBar#clickToPlay\n   */\n  clickToPlay: boolean;\n  /**\n   * @copy ControlBar#keyboardControls\n   */\n  keyboardControls: boolean;\n  /**\n   * @copy ControlBar#progressBar\n   */\n  progressBar: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#playButton\n   */\n  playButton: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#volumeButton\n   */\n  volumeButton: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#fullscreenButton\n   */\n  fullscreenButton: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#videoTime\n   */\n  videoTime: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#pieView\n   */\n  pieView: boolean | Partial<PieViewOptions>;\n  /**\n   * @copy ControlBar#vrButton\n   */\n  vrButton: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#gyroButton\n   */\n  gyroButton: boolean | Partial<ControlBarItemOptions>;\n  /**\n   * @copy ControlBar#className\n   */\n  className: Partial<{ -readonly [key in keyof typeof ControlBar.DEFAULT_CLASS]: string }>;\n  /**\n   * @copy ControlBar#customItems\n   */\n  customItems: ControlBarItem[];\n}\n\n/**\n * A plugin that displays extra buttons & controls that controls {@link View360}.\n * @ko {@link View360}에 부가적인 버튼과 컨트롤을 추가해주는 플러그인.\n * @category Plugin\n * @since 4.0.0\n */\nclass ControlBar implements View360Plugin {\n  /**\n   * Default class names that ControlBar uses\n   * @ko ControlBar가 사용하는 디폴트 클래스 이름들\n   * @since 4.0.0\n   */\n  public static readonly DEFAULT_CLASS = CONTROL_BAR_DEFAULT_CLASS;\n\n  /**\n   * Constants for {@link ControlBarItemOptions#position}\n   * @ko {@link ControlBarItemOptions#position}에 사용 가능한 값들\n   */\n  public static readonly POSITION = CONTROL_BAR_ITEM_POSITION;\n\n  /**\n   * Automatically hide control bar on video plays.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 비디오 재생시 자동으로 컨트롤바를 숨깁니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly autoHide?: ControlBarOptions[\"autoHide\"];\n  /**\n   * Show background element.\n   * @ko 배경 엘리먼트를 표시합니다.\n   * @since 4.0.0\n   */\n  public readonly showBackground?: ControlBarOptions[\"showBackground\"];\n  /**\n   * Whether to play / pause video on canvas click\n   * @ko 캔버스 클릭시에 비디오를 재생 / 일시정지 토글합니다.\n   * @since 4.0.0\n   */\n  public readonly clickToPlay: ControlBarOptions[\"clickToPlay\"];\n  /**\n   * Enable keyboard controls for video.\n   * Pressing up / down arrow will control video volume, and pressing left / right arrow will control video time.\n   * @ko 비디오 키보드 컨트롤을 활성화합니다.\n   * 위 / 아래 화살표키를 누를 시 비디오 볼륨을, 왼쪽 / 오른쪽 화살표키를 누를 시 비디오 시간을 조정합니다.\n   * @since 4.0.0\n   */\n  public readonly keyboardControls: ControlBarOptions[\"keyboardControls\"];\n  /**\n   * Show video progress bar.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 비디오 프로그레스 바를 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly progressBar: ControlBarOptions[\"progressBar\"];\n  /**\n   * Show video play / pause button.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 비디오 재생 / 일시정지 버튼을 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly playButton: ControlBarOptions[\"playButton\"];\n  /**\n   * Show video volume control button.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 비디오 볼륨 조절 버튼을 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly volumeButton: ControlBarOptions[\"volumeButton\"];\n  /**\n   * Show fullscreen button.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 풀스크린 진입 / 해제 버튼을 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly fullscreenButton: ControlBarOptions[\"fullscreenButton\"];\n  /**\n   * Show video current / total time\n   * `true` to enable with default values, `false` to disable.\n   * @ko 비디오의 현재 시간 / 총 시간을 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly videoTime: ControlBarOptions[\"videoTime\"];\n  /**\n   * Show camera pie view.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 현재 카메라가 가리키는 방향을 표시하는 파이 뷰를 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly pieView: ControlBarOptions[\"pieView\"];\n  /**\n   * Show VR button.\n   * `true` to enable with default values, `false` to disable.\n   * @ko VR 진입버튼을 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly vrButton: ControlBarOptions[\"vrButton\"];\n  /**\n   * Show gyroscope control enable / disable button.\n   * `true` to enable with default values, `false` to disable.\n   * @ko 자이로스코프 컨트롤을 활성화 / 비활성화하는 버튼을 표시합니다.\n   * `true`일 경우 기본값을 적용하고, `false`일 경우 비활성화합니다.\n   * @since 4.0.0\n   */\n  public readonly gyroButton: ControlBarOptions[\"gyroButton\"];\n  /**\n   * Override default class names.\n   * @ko 디폴트 클래스 이름들을 오버라이드합니다.\n   * @since 4.0.0\n   */\n  public readonly className: Required<ControlBarOptions[\"className\"]>;\n\n  /**\n   * Root element of the control bar\n   * @ko 컨트롤바의 루트 엘리먼트\n   * @since 4.0.0\n   */\n  public get rootEl() { return this._rootEl; }\n  /**\n   * Container element of the control bar\n   * @ko 컨트롤바의 컨테이너 엘리먼트\n   * @since 4.0.0\n   */\n  public get containerEl() { return this._containerEl; }\n  /**\n   * Background element of the control bar\n   * @ko 컨트롤바의 배경 엘리먼트\n   * @since 4.0.0\n   */\n  public get backgroundEl() { return this._bgEl; }\n  /**\n   * Control bar's default items created by {@link ControlBarOptions}\n   * @ko 주어진 {@link ControlBarOptions}에 의해 생성된 디폴트 아이템들\n   * @since 4.0.0\n   */\n  public get items() { return this._items; }\n  /**\n   * Custom control bar items\n   * @ko 커스텀 컨트롤바 아이템들을 추가합니다.\n   * @since 4.0.0\n   */\n  public get customItems() { return this._customItems; }\n\n  private _rootEl: HTMLElement;\n  private _containerEl: HTMLElement;\n  private _bgEl: HTMLElement;\n  private _wrapperEl: Record<ValueOf<typeof ControlBar.POSITION>, HTMLElement>;\n  private _items: Record<ValueOf<typeof ControlBar.POSITION>, ControlBarItem[]>;\n  private _customItems: ControlBarItem[];\n  private _autoHider: AutoHide;\n  private _videoControl: VideoControl;\n\n  /**\n   * Create new instance of ControlBar.\n   * @ko ControlBar의 새 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    autoHide,\n    showBackground,\n    clickToPlay = true,\n    keyboardControls = true,\n    progressBar = true,\n    playButton = true,\n    volumeButton = true,\n    fullscreenButton = true,\n    videoTime = true,\n    pieView = true,\n    vrButton = true,\n    gyroButton = true,\n    className = {},\n    customItems = []\n  }: Partial<ControlBarOptions> = {}) {\n    this.autoHide = autoHide;\n    this.showBackground = showBackground;\n    this.clickToPlay = clickToPlay;\n    this.keyboardControls = keyboardControls;\n    this.progressBar = progressBar;\n    this.playButton = playButton;\n    this.volumeButton = volumeButton;\n    this.fullscreenButton = fullscreenButton;\n    this.videoTime = videoTime;\n    this.pieView = pieView;\n    this.vrButton = vrButton;\n    this.gyroButton = gyroButton;\n    this.className = {\n      ...ControlBar.DEFAULT_CLASS,\n      ...className\n    };\n\n    const rootClass = className.CONTROLS_ROOT ?? ControlBar.DEFAULT_CLASS.CONTROLS_ROOT;\n\n    this._rootEl = createElement(rootClass);\n    this._createPositionWrappers();\n    this._items = Object.keys(ControlBar.POSITION).reduce((items, key) => {\n      items[ControlBar.POSITION[key]] = [];\n      return items;\n    }, {}) as Record<ValueOf<typeof ControlBar.POSITION>, ControlBarItem[]>;\n    this._customItems = customItems;\n    this._autoHider = new AutoHide(this, getObjectOption(autoHide));\n    this._videoControl = new VideoControl();\n\n    customItems.forEach(item => {\n      this._items[item.position].push(item);\n    });\n  }\n\n  public init(viewer: View360) {\n    const panoRoot = viewer.rootEl;\n    const controlsRoot = this._rootEl;\n    const defaultItems = this._createDefaultItems();\n\n    this._updateBackground(viewer);\n    this._updateAutoHide(viewer);\n    this._updateKeyboardHandler(viewer);\n\n    panoRoot.appendChild(controlsRoot);\n    this._addItem(viewer, defaultItems);\n    this._addItem(viewer, this._customItems);\n\n    viewer.on(EVENTS.PROJECTION_CHANGE, this._onNewSrcLoad);\n    viewer.on(EVENTS.STATIC_CLICK, this._onStaticClick);\n  }\n\n  public destroy(viewer: View360): void {\n    // Remove controls root from pano root\n    const panoRoot = viewer.rootEl;\n    const controlsRoot = this._rootEl;\n    const items = this._items;\n\n    if (controlsRoot.parentElement === panoRoot) {\n      panoRoot.removeChild(controlsRoot);\n    }\n\n    Object.keys(items).forEach((key: ValueOf<typeof ControlBar.POSITION>) => {\n      const category = items[key];\n\n      category.forEach(item => {\n        item.destroy(viewer, this);\n      });\n\n      items[key] = [];\n    });\n\n    this._clearItemElements();\n    this._autoHider.disable(viewer);\n    this._videoControl.disable(panoRoot);\n\n    viewer.off(EVENTS.PROJECTION_CHANGE, this._onNewSrcLoad);\n    viewer.off(EVENTS.STATIC_CLICK, this._onStaticClick);\n  }\n\n  private _addItem(viewer: View360, items: ControlBarItem[]) {\n    for (const item of items) {\n      const category = this._items[item.position];\n      const wrapper = this._wrapperEl[item.position];\n\n      const nextSiblingIndex = findIndex(category, sibling => sibling.order > item.order);\n\n      if (nextSiblingIndex >= 0) {\n        const nextSibling = category[nextSiblingIndex].element;\n        category.splice(nextSiblingIndex, 0, item);\n        wrapper.insertBefore(item.element, nextSibling);\n      } else {\n        category.push(item);\n        wrapper.appendChild(item.element);\n      }\n\n      item.init(viewer, this);\n    }\n  }\n\n  private _createPositionWrappers() {\n    const className = {\n      ...ControlBar.DEFAULT_CLASS,\n      ...this.className\n    };\n    const rootEl = this._rootEl;\n\n    // BG & FLOATING CONTROLS\n    const backgroundEl = createElement(className.CONTROLS_BG);\n    const floatLeftEl = createElement(className.CONTROLS_FLOAT_LEFT);\n    const floatRightEl = createElement(className.CONTROLS_FLOAT_RIGHT);\n\n    rootEl.appendChild(floatLeftEl);\n    rootEl.appendChild(floatRightEl);\n\n    // BOTTOM CONTROLS\n    const container = createElement(className.CONTROLS_MAIN);\n    const topWrapper = createElement(className.CONTROLS_TOP);\n    const bottomWrapper = createElement(className.CONTROLS_BOTTOM);\n    const midWrapper = createElement(className.CONTROLS_MID);\n    const leftControlsWrapper = createElement(className.CONTROLS_LEFT);\n    const rightControlsWrapper = createElement(className.CONTROLS_RIGHT);\n\n    midWrapper.appendChild(leftControlsWrapper);\n    midWrapper.appendChild(rightControlsWrapper);\n    container.appendChild(backgroundEl);\n    container.appendChild(topWrapper);\n    container.appendChild(midWrapper);\n    container.appendChild(bottomWrapper);\n    rootEl.appendChild(container);\n\n    this._bgEl = backgroundEl;\n    this._containerEl = container;\n    this._wrapperEl = {\n      [ControlBar.POSITION.MAIN_TOP]: topWrapper,\n      [ControlBar.POSITION.MAIN_LEFT]: leftControlsWrapper,\n      [ControlBar.POSITION.MAIN_RIGHT]: rightControlsWrapper,\n      [ControlBar.POSITION.MAIN_BOTTOM]: bottomWrapper,\n      [ControlBar.POSITION.TOP_LEFT]: floatLeftEl,\n      [ControlBar.POSITION.TOP_RIGHT]: floatRightEl\n    };\n  }\n\n  private _clearItemElements() {\n    const wrappers = Object.keys(ControlBar.POSITION).map(key => ControlBar.POSITION[key]);\n\n    // Remove all elements inside wrappers\n    wrappers.forEach(wrapper => {\n      while (wrapper.firstChild) {\n        wrapper.removeChild(wrapper.firstChild);\n      }\n    });\n  }\n\n  private _onStaticClick = ({ target: viewer, isTouch }: StaticClickEvent) => {\n    const autoHider = this._autoHider;\n\n    if (isTouch) {\n      if (!autoHider.enabled) return;\n\n      if (autoHider.hidden) {\n        autoHider.showTemporaliy();\n      } else {\n        autoHider.hide();\n      }\n    } else {\n      if (!this.clickToPlay) return;\n\n      const video = viewer.projection?.getTexture();\n      if (!video || !video.isVideo()) return;\n\n      if (video.isPaused()) {\n        video.source.play();\n      } else {\n        video.source.pause();\n      }\n    }\n  };\n\n  private _onNewSrcLoad = ({ target: viewer }: View360Events[\"projectionChange\"]) => {\n    const items = this._items;\n\n    this._updateBackground(viewer);\n    this._updateAutoHide(viewer);\n    this._updateKeyboardHandler(viewer);\n\n    Object.keys(items).forEach((key: ValueOf<typeof ControlBar.POSITION>) => {\n      const category = items[key];\n\n      category.forEach(item => {\n        item.destroy(viewer, this);\n        item.init(viewer, this);\n      });\n    });\n  };\n\n  private _updateAutoHide(viewer: View360) {\n    const autoHide = this.autoHide;\n    const autoHider = this._autoHider;\n\n    if (autoHide != null) {\n      if (autoHide) {\n        autoHider.enable(viewer);\n      } else {\n        autoHider.disable(viewer);\n      }\n    } else {\n      // Automatically choose whether to show background by content type\n      const texture = viewer.projection?.getTexture();\n\n      if (texture && texture.isVideo()) {\n        // Enable auto hide when content type is video\n        autoHider.enable(viewer);\n      } else {\n        autoHider.disable(viewer);\n      }\n    }\n  }\n\n  private _updateBackground(viewer: View360) {\n    const background = this._bgEl;\n    const showBackground = this.showBackground;\n    const hiddenClass = this.className.HIDDEN ?? ControlBar.DEFAULT_CLASS.HIDDEN;\n\n    if (showBackground != null) {\n      if (showBackground) {\n        background.classList.remove(hiddenClass);\n      } else {\n        background.classList.add(hiddenClass);\n      }\n    } else {\n      // Automatically choose whether to show background by content type\n      const texture = viewer.projection?.getTexture();\n\n      if (texture && texture.isVideo()) {\n        // Show bg when content type is video\n        background.classList.remove(hiddenClass);\n      } else {\n        background.classList.add(hiddenClass);\n      }\n    }\n  }\n\n  private _updateKeyboardHandler(viewer: View360) {\n    const panoRoot = viewer.rootEl;\n    const videoControl = this._videoControl;\n    const texture = viewer.projection?.getTexture();\n\n    if (this.keyboardControls && texture && texture.isVideo()) {\n      videoControl.enable(panoRoot, texture);\n    } else {\n      videoControl.disable(panoRoot);\n    }\n  }\n\n  private _createDefaultItems(): ControlBarItem[] {\n    const items: ControlBarItem[] = [];\n\n    if (this.progressBar) {\n      items.push(new ProgressBar(getObjectOption(this.progressBar)));\n    }\n\n    if (this.playButton) {\n      items.push(new PlayButton(getObjectOption(this.playButton)));\n    }\n\n    if (this.volumeButton) {\n      items.push(new VolumeControl(getObjectOption(this.volumeButton)));\n    }\n\n    if (this.gyroButton) {\n      items.push(new GyroButton(getObjectOption(this.gyroButton)));\n    }\n\n    if (this.vrButton) {\n      items.push(new VRButton(getObjectOption(this.vrButton)));\n    }\n\n    if (this.fullscreenButton) {\n      items.push(new FullscreenButton(getObjectOption(this.fullscreenButton)));\n    }\n\n    if (this.videoTime) {\n      items.push(new VideoTime(getObjectOption(this.videoTime)));\n    }\n\n    if (this.pieView) {\n      items.push(new PieView(getObjectOption(this.pieView)));\n    }\n\n    return items;\n  }\n}\n\nexport default ControlBar;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Camera from \"../core/Camera\";\nimport PanoControl from \"../control/PanoControl\";\nimport TriangleMesh from \"../core/TriangleMesh\";\nimport Texture from \"../texture/Texture\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport { VideoConfig } from \"../type/external\";\nimport UniformCanvasCube from \"../uniform/UniformCanvasCube\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport UniformTextureCube from \"../uniform/UniformTextureCube\";\n\ntype CommonProjectionUniforms = {\n  uTexture: UniformTexture2D | UniformTextureCube | UniformCanvasCube;\n}\n\n/**\n * Common option for {@link Projection}s\n * @ko {@link Projection}을 위한 공통 옵션들\n * @category Projection\n * @since 4.0.0\n */\nexport interface ProjectionOptions {\n  /**\n   * @copy Projection#src\n   */\n  src: string | HTMLElement | Array<string | HTMLElement>;\n  /**\n   * @copy Projection#video\n   */\n  video?: boolean | Partial<VideoConfig>;\n}\n\n/**\n * Base class for projections.\n * @ko 프로젝션 베이스 클래스.\n * @category Projection\n * @since 4.0.0\n */\nabstract class Projection<T extends CommonProjectionUniforms = CommonProjectionUniforms> {\n  /**\n   * Source URL to panorama image/video.\n   * @ko 파노라마 이미지/비디오의 URL\n   * @since 4.0.0\n   */\n  public readonly src: ProjectionOptions[\"src\"];\n  /**\n   * Properties for the video element.\n   * Setting `false` will treat panorama source as an image, `true` will use default properties.\n   * @ko 비디오 엘리먼트에 설정할 프로퍼티를 담는 객체.\n   * @since 4.0.0\n   * @example\n   * Default properties\n   * ```ts\n   * autoplay: true\n   * muted: true\n   * loop: false\n   * volume: 1\n   * ```\n   */\n  public readonly video: ProjectionOptions[\"video\"];\n\n  protected _mesh: TriangleMesh<T> | null;\n\n  /**\n   * Create new instance\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor({\n    src,\n    video = false\n  }: ProjectionOptions) {\n    this.src = src;\n    this.video = video;\n    this._mesh = null;\n  }\n\n  /**\n   * Apply texture to current projection.\n   * @ko 주어진 텍스쳐를 현재 프로젝션에 적용합니다.\n   * @param ctx - Instance of the WebGLContext helper {@ko WebGL context 헬퍼의 인스턴스}\n   * @param texture - New texture to apply {@ko 새로 적용할 텍스쳐}\n   * @internal\n   * @since 4.0.0\n   */\n  public abstract applyTexture(ctx: WebGLContext, texture: Texture): void;\n\n  /**\n   * Release all resources projection has.\n   * This is automatically called on projection change & View360's destroy call\n   * @ko 현재 갖고 있는 모든 리소스를 반환합니다.\n   * 이 메소드는 프로젝션 변경 및 View360의 destroy 호출 시 자동으로 호출됩니다.\n   * @param ctx\n   */\n  public releaseAllResources(ctx: WebGLContext) {\n    this._mesh?.destroy(ctx);\n  }\n\n  /**\n   * Update camera to match projection's settings.\n   * @ko 현재 프로젝션의 세팅으로 카메라를 업데이트합니다.\n   * @param camera - Instance of the camera to update {@ko 업데이트할 카메라의 인스턴스}\n   * @since 4.0.0\n   */\n  public updateCamera(camera: Camera) {\n    // Use default mode & no view restriction\n    camera.resetRange();\n  }\n\n  /**\n   * Update control to match projection's settings.\n   * @ko 현재 프로젝션의 세팅으로 컨트롤을 업데이트합니다.\n   * @param control - Instance of the control to update {@ko 업데이트할 컨트롤의 인스턴스}\n   * @since 4.0.0\n   */\n  public updateControl(control: PanoControl) {\n    control.ignoreZoomScale = false;\n  }\n\n  /**\n   * Update projection.\n   * @ko 현재 프로젝션 정보를 갱신합니다.\n   * @param camera - Instance of the camera to reference {@ko 참조할 카메라의 인스턴스}\n   * @since 4.0.0\n   */\n  public update(camera: Camera) {} // eslint-disable-line @typescript-eslint/no-empty-function, @typescript-eslint/no-unused-vars\n\n  /**\n   * Return active texture.\n   * @ko 현재 활성화된 텍스쳐를 반환합니다.\n   * @internal\n   * @since 4.0.0\n   */\n  public getTexture() {\n    if (!this._mesh) return null;\n\n    return this._mesh.program.uniforms.uTexture.texture;\n  }\n\n  /**\n   * A 3D triangle mesh for projection. It's `null` until loading the `src`.\n   * @ko Projection을 표시하기 위한 Mesh, src를 로드하기 전까지는 `null`입니다.\n   * @since 4.0.0\n   */\n  public getMesh(): TriangleMesh<T> | null {\n    return this._mesh;\n  }\n}\n\nexport default Projection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nabstract class Uniform {\n  public needsUpdate: boolean;\n\n  public constructor() {\n    this.needsUpdate = true;\n  }\n\n  public abstract update(gl: WebGLRenderingContext | WebGL2RenderingContext, location: WebGLUniformLocation, isWebGL2: boolean): void;\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  public destroy(gl: WebGLRenderingContext | WebGL2RenderingContext) {\n    // DO_NOTHING\n  }\n}\n\nexport default Uniform;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport TextureCube from \"../texture/TextureCube\";\nimport { reorderCube } from \"../utils\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Uniform from \"./Uniform\";\n\nclass UniformTextureCube extends Uniform {\n  public readonly texture: TextureCube;\n  private _webglTexture: WebGLTexture;\n  private _cubemapOrder: string;\n\n  public constructor(ctx: WebGLContext, texture: TextureCube, cubemapOrder: string) {\n    super();\n\n    this.texture = texture;\n    this._webglTexture = ctx.createWebGLCubeTexture(texture, texture.width);\n    this._cubemapOrder = cubemapOrder;\n  }\n\n  public destroy(gl: WebGLRenderingContext | WebGL2RenderingContext): void {\n    this.texture.destroy();\n    gl.deleteTexture(this._webglTexture);\n  }\n\n  public update(gl: WebGLRenderingContext | WebGL2RenderingContext, location: WebGLUniformLocation, isWebGL2: boolean) {\n    const texture = this.texture;\n\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\n    gl.uniform1i(location, 0);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._webglTexture);\n\n    const sources = reorderCube(texture.sources, this._cubemapOrder);\n    sources.forEach((src, idx) => {\n      if (isWebGL2) {\n        gl.texSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + idx, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, src);\n      } else {\n        gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + idx, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, src);\n      }\n    });\n\n    if (!texture.isVideo()) {\n      this.needsUpdate = false;\n    }\n  }\n}\n\nexport default UniformTextureCube;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Texture2D from \"../texture/Texture2D\";\nimport { range, reorderCube } from \"../utils\";\n\n/** @hidden */\nclass CubeTexturePainter {\n  public readonly texture: Texture2D;\n  private _renderingOrder: number[];\n  private _canvas: HTMLCanvasElement;\n  private _ctx: CanvasRenderingContext2D;\n  private _row: number;\n  private _column: number;\n  private _size: number;\n\n  public get size() { return this._size; }\n\n  public constructor(texture: Texture2D, cubemapOrder: string) {\n    this.texture = texture;\n    this._renderingOrder = reorderCube(range(6), cubemapOrder);\n\n    const canvas = document.createElement(\"canvas\");\n\n    this._calcRenderingSize();\n\n    canvas.width = this._size;\n    canvas.height = this._size;\n\n    this._canvas = canvas;\n    this._ctx = canvas.getContext(\"2d\")!;\n  }\n\n  public destroy() {\n    const canvas = this._canvas;\n\n    // release memories\n    canvas.width = 1;\n    canvas.height = 1;\n    this._canvas = null as any;\n  }\n\n  public draw(gl: WebGLRenderingContext | WebGL2RenderingContext, isWebGL2: boolean) {\n    const size = this._size;\n    const texture = this.texture;\n    let surfaceIdx = 0;\n\n    for (let row = 0; row < this._row; row++) {\n      for (let column = 0; column < this._column; column++) {\n        const x = size * column;\n        const y = size * row;\n        const renderingFace = this._renderingOrder[surfaceIdx];\n\n        this._ctx.drawImage(texture.source as CanvasImageSource, x, y, size, size, 0, 0, size, size);\n\n        if (isWebGL2) {\n          gl.texSubImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderingFace, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, this._canvas);\n        } else {\n          gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + renderingFace, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._canvas);\n        }\n\n        surfaceIdx++;\n      }\n    }\n  }\n\n  private _calcRenderingSize() {\n    const {\n      width,\n      height\n    } = this.texture;\n    const aspect = width / height;\n\n    if (aspect === 1 / 6) {\n      this._size = width;\n      this._row = 6;\n      this._column = 1;\n    } else if (aspect === 6) {\n      this._size = height;\n      this._row = 1;\n      this._column = 6;\n    } else if (aspect === 2 / 3) {\n      this._size = width * 0.5;\n      this._row = 3;\n      this._column = 2;\n    } else {\n      this._size = width / 3;\n      this._row = 2;\n      this._column = 3;\n    }\n  }\n}\n\nexport default CubeTexturePainter;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport CubeTexturePainter from \"../core/CubeTexturePainter\";\nimport Texture2D from \"../texture/Texture2D\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Uniform from \"./Uniform\";\n\nclass UniformCanvasCube extends Uniform {\n  private _webglTexture: WebGLTexture;\n  private _painter: CubeTexturePainter;\n\n  public get texture() { return this._painter.texture; }\n\n  public constructor(ctx: WebGLContext, texture: Texture2D, cubemapOrder: string) {\n    super();\n\n    this._painter = new CubeTexturePainter(texture as Texture2D, cubemapOrder);\n    this._webglTexture = ctx.createWebGLCubeTexture(texture, this._painter.size);\n  }\n\n  public destroy(gl: WebGLRenderingContext | WebGL2RenderingContext) {\n    gl.deleteTexture(this._webglTexture);\n    this._painter.destroy();\n  }\n\n  public update(gl: WebGLRenderingContext | WebGL2RenderingContext, location: WebGLUniformLocation, isWebGL2: boolean) {\n    const texture = this.texture;\n\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n    gl.uniform1i(location, 0);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, this._webglTexture);\n\n    this._painter.draw(gl, isWebGL2);\n\n    if (!texture.isVideo()) {\n      this.needsUpdate = false;\n    }\n  }\n}\n\nexport default UniformCanvasCube;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Object3D from \"./Object3D\";\nimport ShaderProgram from \"./ShaderProgram\";\nimport VertexArrayObject from \"./VertexArrayObject\";\nimport Uniform from \"../uniform/Uniform\";\nimport WebGLContext from \"./WebGLContext\";\n\n/**\n * @hidden\n */\nclass TriangleMesh<T extends Record<string, Uniform> = Record<string, never>> extends Object3D {\n  /**\n   * @internal\n   * Geometry data for projection\n   */\n  public readonly vao: VertexArrayObject;\n  /**\n   * @internal\n   * Material(shader) data for projection\n   */\n  public readonly program: ShaderProgram<T>;\n\n  public constructor(vao: VertexArrayObject, program: ShaderProgram<T>) {\n    super();\n\n    this.vao = vao;\n    this.program = program;\n  }\n\n  public destroy(ctx: WebGLContext) {\n    ctx.releaseVAO(this.vao);\n    ctx.releaseShaderResources(this.program);\n  }\n}\n\nexport default TriangleMesh;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Uniform from \"../uniform/Uniform\";\nimport WebGLContext from \"./WebGLContext\";\nimport { UniformLocations } from \"../type/internal\";\n\nclass ShaderProgram<T extends Record<string, Uniform> = Record<string, Uniform>> {\n  public readonly program: WebGLProgram;\n  public readonly uniforms: T;\n  public readonly uniformLocations: UniformLocations<T>;\n\n  public constructor(ctx: WebGLContext, vertexShader: string, fragmentShader: string, uniforms: T) {\n    this.program = ctx.createProgram(vertexShader, fragmentShader);\n    this.uniforms = uniforms;\n    this.uniformLocations = ctx.getUniformLocations(this.program, uniforms);\n  }\n}\n\nexport default ShaderProgram;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport { TypedArray } from \"../type/utils\";\n\n/**\n * @hidden\n */\nclass VertexData<T extends TypedArray> {\n  public readonly data: T;\n  public itemSize: number;\n  public count: number;\n\n  /** */\n  public constructor(data: T, itemSize: number) {\n    this.data = data;\n    this.itemSize = itemSize;\n    this.count = data.length / itemSize;\n  }\n}\n\nexport default VertexData;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport VertexData from \"../core/VertexData\";\n\n/**\n * @hidden\n */\nabstract class Geometry {\n  public readonly vertices: VertexData<Float32Array>;\n  public readonly indicies: VertexData<Uint16Array>;\n  public readonly uvs: VertexData<Float32Array>;\n\n  /** */\n  public constructor(vertices: number[], indicies: number[], uvs: number[]) {\n    this.vertices = new VertexData(new Float32Array(vertices), 3);\n    this.indicies = new VertexData(new Uint16Array(indicies), 1);\n    this.uvs = new VertexData(new Float32Array(uvs), 2);\n  }\n}\n\nexport default Geometry;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Geometry from \"./Geometry\";\nimport { ROTATE } from \"../const/internal\";\nimport { reorderCube } from \"../utils\";\n\n/**\n * @hidden\n */\nclass CubeGeometry extends Geometry {\n  public constructor({\n    order,\n    rotateUV\n  }: {\n    order: string;\n    rotateUV?: ROTATE[]\n  }) {\n    const vertices = [\n      // back\n      1, -1, 1,\n      -1, -1, 1,\n      -1, 1, 1,\n      1, 1, 1,\n\n      // front\n      -1, -1, -1,\n      1, -1, -1,\n      1, 1, -1,\n      -1, 1, -1,\n\n      // up\n      -1, 1, -1,\n      1, 1, -1,\n      1, 1, 1,\n      -1, 1, 1,\n\n      // down\n      -1, -1, 1,\n      1, -1, 1,\n      1, -1, -1,\n      -1, -1, -1,\n\n      // right\n      1, -1, -1,\n      1, -1, 1,\n      1, 1, 1,\n      1, 1, -1,\n\n      // left\n      -1, -1, 1,\n      -1, -1, -1,\n      -1, 1, -1,\n      -1, 1, 1\n    ];\n\n    const indicies = [\n      0, 1, 2,\n      0, 2, 3,\n      4, 5, 6,\n      4, 6, 7,\n      8, 9, 10,\n      8, 10, 11,\n      12, 13, 14,\n      12, 14, 15,\n      16, 17, 18,\n      16, 18, 19,\n      20, 21, 22,\n      20, 22, 23\n    ];\n\n    const oneThird = 1 / 3;\n    const coords: number[][] = [];\n\n    for (let r = 1; r >= 0; r--) {\n      for (let c = 0; c < 3; c++) {\n        const coord = [\n          c * oneThird, r * 0.5,\n          (c + 1) * oneThird, r * 0.5,\n          (c + 1) * oneThird, (r + 1) * 0.5,\n          c * oneThird, (r + 1) * 0.5\n        ];\n\n        coords.push(coord);\n      }\n    }\n\n    if (rotateUV) {\n      rotateUV.forEach((degree, idx) => {\n        if (degree === ROTATE.ZERO) return;\n\n        const coord = coords[idx];\n        let newOrder: number[];\n\n        if (degree === ROTATE.CW_90) {\n          newOrder = [1, 2, 3, 0];\n        } else if (degree === ROTATE.CCW_90) {\n          newOrder = [3, 0, 1, 2];\n        } else {\n          newOrder = [2, 3, 0, 1];\n        }\n\n        const newCoords = Array<number>(coord.length);\n        for (let uvIdx = 0; uvIdx < coord.length / 2; uvIdx++) {\n          newCoords[uvIdx * 2 + 0] = coord[newOrder[uvIdx] * 2 + 0];\n          newCoords[uvIdx * 2 + 1] = coord[newOrder[uvIdx] * 2 + 1];\n        }\n\n        coords[idx] = newCoords;\n      });\n    }\n\n    const uvs = reorderCube(coords, order, \"BFUDRL\")\n      .reduce((acc, val) => acc.concat(val), []);\n\n    super(vertices, indicies, uvs);\n  }\n}\n\nexport default CubeGeometry;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Texture2D from \"../texture/Texture2D\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Uniform from \"./Uniform\";\n\nclass UniformTexture2D extends Uniform {\n  public readonly texture: Texture2D;\n  private _webglTexture: WebGLTexture;\n\n  public constructor(ctx: WebGLContext, texture: Texture2D) {\n    super();\n\n    this.texture = texture;\n    this._webglTexture = ctx.createWebGLTexture(texture);\n  }\n\n  public destroy(gl: WebGLRenderingContext | WebGL2RenderingContext): void {\n    this.texture.destroy();\n    gl.deleteTexture(this._webglTexture);\n  }\n\n  public update(gl: WebGLRenderingContext | WebGL2RenderingContext, location: WebGLUniformLocation, isWebGL2: boolean) {\n    const texture = this.texture;\n    const isVideo = texture.isVideo();\n\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, texture.flipY);\n    gl.uniform1i(location, 0);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this._webglTexture);\n\n    if (!isVideo && isWebGL2) {\n      gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, texture.source);\n    } else {\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, texture.source);\n    }\n\n    if (!isVideo) {\n      this.needsUpdate = false;\n    }\n  }\n}\n\nexport default UniformTexture2D;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Geometry from \"./Geometry\";\n\n/**\n * @hidden\n */\nclass CylinderGeometry extends Geometry {\n  public constructor(maxTheta: number) {\n    const vertices: number[] = [];\n    const indicies: number[] = [];\n    const uvs: number[] = [];\n\n    const height = 1;\n    const radialSegments = 60;\n    const halfHeight = height * 0.5;\n    const heightSegments = [-halfHeight, halfHeight];\n    const invRadialSegments = 1 / radialSegments;\n    const angleConst = maxTheta * invRadialSegments;\n\n    for (let yIdx = 0; yIdx < 2; yIdx++) {\n      const y = heightSegments[yIdx];\n\n      for (let lngIdx = 0; lngIdx <= radialSegments; lngIdx++) {\n        const angle = lngIdx * angleConst + Math.PI - maxTheta * 0.5;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        const u = lngIdx * invRadialSegments;\n        const v = yIdx;\n\n        uvs.push(u, v);\n        vertices.push(x, y, z);\n\n        if (yIdx === 0 && lngIdx < radialSegments) {\n          const a = lngIdx;\n          const b = a + radialSegments + 1;\n\n          indicies.push(a, b, a + 1, b, b + 1, a + 1);\n        }\n      }\n    }\n\n    super(vertices, indicies, uvs);\n  }\n}\n\nexport default CylinderGeometry;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Geometry from \"./Geometry\";\n\n/**\n * @hidden\n */\nclass SphereGeometry extends Geometry {\n  /** */\n  public constructor() {\n    // const radius = 1;\n    const widthSegments = 60;\n    const heightSegments = 60;\n    const ANGLE_CORRECTION_FOR_CENTER_ALIGN = -0.5 * Math.PI;\n\n    const uvs: number[] = [];\n    const vertices: number[] = [];\n    const indicies: number[] = [];\n    let latIdx: number;\n    let lngIdx: number;\n\n    for (latIdx = 0; latIdx <= widthSegments; latIdx++) {\n      const theta = (latIdx / widthSegments - 0.5) * Math.PI;\n      const sinTheta = Math.sin(theta);\n      const cosTheta = Math.cos(theta);\n\n      for (lngIdx = 0; lngIdx <= heightSegments; lngIdx++) {\n        const phi = (lngIdx / heightSegments - 0.5) * 2 * Math.PI + ANGLE_CORRECTION_FOR_CENTER_ALIGN;\n        const sinPhi = Math.sin(phi);\n        const cosPhi = Math.cos(phi);\n        const x = cosPhi * cosTheta;\n        const y = sinTheta;\n        const z = sinPhi * cosTheta;\n        const u = lngIdx / heightSegments;\n        const v = latIdx / widthSegments;\n\n        uvs.push(u, v);\n        vertices.push(x, y, z);\n\n        if (lngIdx !== heightSegments && latIdx !== widthSegments) {\n          const a = latIdx * (heightSegments + 1) + lngIdx;\n          const b = a + heightSegments + 1;\n\n          indicies.push(a, a + 1, b, b, a + 1, b + 1);\n        }\n      }\n    }\n\n    super(vertices, indicies, uvs);\n  }\n}\n\nexport default SphereGeometry;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Uniform from \"./Uniform\";\n\nclass UniformFloat extends Uniform {\n  public val: number;\n\n  public constructor(val: number) {\n    super();\n\n    this.val = val;\n  }\n\n  public update(gl: WebGLRenderingContext | WebGL2RenderingContext, location: WebGLUniformLocation) {\n    gl.uniform1f(location, this.val);\n\n    this.needsUpdate = false;\n  }\n}\n\nexport default UniformFloat;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Geometry from \"./Geometry\";\n\n/**\n * @hidden\n */\nclass PlaneGeometry extends Geometry {\n  /** */\n  public constructor(width: number = 2, height: number = 2, z: number = -1) {\n    const halfWidth = width * 0.5;\n    const halfHeight = height * 0.5;\n    const vertices = [\n      -halfWidth, -halfHeight, z,\n      halfWidth, -halfHeight, z,\n      -halfWidth, halfHeight, z,\n      halfWidth, halfHeight, z\n    ];\n    const indicies = [\n      0, 1, 2,\n      2, 1, 3\n    ];\n    const uvs = [\n      0, 0,\n      1, 0,\n      0, 1,\n      1, 1\n    ];\n\n    super(vertices, indicies, uvs);\n  }\n}\n\nexport default PlaneGeometry;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Uniform from \"./Uniform\";\n\nclass UniformVector4Array extends Uniform {\n  public val: number[][];\n\n  public constructor(val: number[][]) {\n    super();\n\n    this.val = val;\n  }\n\n  public update(gl: WebGLRenderingContext | WebGL2RenderingContext, location: WebGLUniformLocation) {\n    gl.uniform4fv(location, this.val.reduce((arr, vector) => [...arr, ...vector], []));\n\n    this.needsUpdate = false;\n  }\n}\n\nexport default UniformVector4Array;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Texture2D from \"../texture/Texture2D\";\nimport SphereGeometry from \"../geometry/SphereGeometry\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport TriangleMesh from \"../core/TriangleMesh\";\nimport UniformVector4Array from \"../uniform/UniformVector4Array\";\nimport UniformFloat from \"../uniform/UniformFloat\";\nimport vs from \"../shader/stereoequi.vert\";\nimport fs from \"../shader/common.frag\";\n\n/**\n * Options for {@link StereoEquiProjection}\n * @ko {@link StereoEquiProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface StereoEquiProjectionOptions extends ProjectionOptions {\n  src: string | HTMLElement;\n  /**\n   * Stereoscopic mode of the image\n   * @ko 이미지의 스테레오스코픽 모드\n   * @since 4.0.0\n   * @default \"top_bottom\"\n   */\n  mode: typeof StereoEquiProjection.MODE[keyof typeof StereoEquiProjection.MODE]\n}\n\n/**\n * Projection based on stereo equirectangular images.\n * @ko Stereo equirectangular 이미지 기반의 프로젝션\n * @since 4.0.0\n * @category Projection\n */\nclass StereoEquiProjection extends Projection<{\n  uTexture: UniformTexture2D;\n  uEye: UniformFloat;\n  uTexScaleOffset: UniformVector4Array;\n}> {\n  /**\n   * Available stereoscopic modes\n   * @ko 사용가능한 스테레오스코픽 모드들\n   * @since 4.0.0\n   */\n  public static MODE = {\n    /**\n     * @ko 이미지가 왼쪽/오른쪽으로 구성되어있을 경우\n     * @since 4.0.0\n     */\n    LEFT_RIGHT: \"left_right\",\n    /**\n     * @ko 이미지가 위/아래로 구성되어있을 경우\n     * @since 4.0.0\n     */\n    TOP_BOTTOM: \"top_bottom\",\n  } as const;\n\n  private _mode: StereoEquiProjectionOptions[\"mode\"];\n\n  /**\n   * Create new instance\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor(options: StereoEquiProjectionOptions) {\n    super(options);\n\n    this._mode = options.mode;\n  }\n\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    let leftEye: number[];\n    let rightEye: number[];\n\n    switch (this._mode) {\n      case StereoEquiProjection.MODE.LEFT_RIGHT:\n        leftEye = [0.5, 1, 0, 0];\n        rightEye = [0.5, 1, 0.5, 0];\n        break;\n      default:\n        // Default, uses \"top_bottom\"\n        leftEye = [1, 0.5, 0, 0];\n        rightEye = [1, 0.5, 0, 0.5];\n    }\n\n\n    const uniforms = {\n      uTexture: new UniformTexture2D(ctx, texture),\n      uEye: new UniformFloat(0),\n      uTexScaleOffset: new UniformVector4Array([leftEye, rightEye])\n    };\n\n    const geometry = new SphereGeometry();\n    const program = new ShaderProgram(ctx, vs, fs, uniforms);\n\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    this._mesh = mesh;\n  }\n}\n\nexport default StereoEquiProjection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport UniformTextureCube from \"../uniform/UniformTextureCube\";\nimport UniformCanvasCube from \"../uniform/UniformCanvasCube\";\nimport TriangleMesh from \"../core/TriangleMesh\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Texture2D from \"../texture/Texture2D\";\nimport TextureCube from \"../texture/TextureCube\";\nimport CubeGeometry from \"../geometry/CubeGeometry\";\nimport vs from \"../shader/cube.vert\";\nimport fs from \"../shader/cube.frag\";\n\n/**\n * Options for {@link CubemapProjection}\n * @ko {@link CubemapProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface CubemapProjectionOptions extends ProjectionOptions {\n  /**\n   * Order of the cubemap images.\n   * @ko 큐브맵 이미지의 순서.\n   * @since 4.0.0\n   * @default \"RLUDFB\" (Right - Left - Up - Down - Front - Back)\n   */\n  cubemapOrder?: string;\n  /**\n   * Whether to flip cubemap image horizontally.\n   * @ko 큐브맵 이미지를 좌우대칭할지 여부.\n   * @since 4.0.0\n   * @default false\n   */\n  cubemapFlipX?: boolean;\n}\n\n/**\n * Projection based on cubemap images, accepts both multiple or single images.\n * @ko 큐브맵 이미지 기반의 프로젝션, 단일 혹은 여러 장의 이미지를 모두 사용 가능합니다.\n * @since 4.0.0\n * @category Projection\n */\nclass CubemapProjection extends Projection<{\n  uTexture: UniformTextureCube | UniformCanvasCube;\n}> {\n  private _cubemapOrder: NonNullable<CubemapProjectionOptions[\"cubemapOrder\"]>;\n  private _cubemapFlipX: NonNullable<CubemapProjectionOptions[\"cubemapFlipX\"]>;\n\n  /**\n   * Create new instance.\n   * @ko 새 인스턴스를 생성합니다.\n   * @param options Options {@ko Options}\n   */\n  public constructor(options: CubemapProjectionOptions) {\n    super(options);\n\n    const {\n      cubemapOrder = \"RLUDFB\",\n      cubemapFlipX = false\n    } = options;\n\n    this._cubemapOrder = cubemapOrder;\n    this._cubemapFlipX = cubemapFlipX;\n  }\n\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    const cubemapOrder = this._cubemapOrder;\n    const cubemapFlipX = this._cubemapFlipX;\n    const uniforms = {\n      uTexture: texture.isCube()\n        ? new UniformTextureCube(ctx, texture as TextureCube, cubemapOrder)\n        : new UniformCanvasCube(ctx, texture as Texture2D, cubemapOrder)\n    };\n\n    const geometry = new CubeGeometry({\n      order: cubemapOrder\n    });\n    const program = new ShaderProgram(ctx, vs, fs, uniforms);\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    if (cubemapFlipX) {\n      mesh.scale[0] = -1;\n    }\n    mesh.updateMatrix();\n\n    this._mesh = mesh;\n  }\n}\n\nexport default CubemapProjection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport TriangleMesh from \"../core/TriangleMesh\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Texture2D from \"../texture/Texture2D\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport CubeGeometry from \"../geometry/CubeGeometry\";\nimport vs from \"../shader/common.vert\";\nimport fs from \"../shader/common.frag\";\n\n/**\n * Options for {@link CubestripProjection}\n * @ko {@link CubestripProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface CubestripProjectionOptions extends ProjectionOptions {\n  /**\n   * @copy CubemapProjectionOptions#cubemapOrder\n   */\n  cubemapOrder?: string;\n  /**\n   * @copy CubemapProjectionOptions#cubemapFlipX\n   */\n  cubemapFlipX?: boolean;\n}\n\n/**\n * Projection based on cubemap strip.\n * Slightly more efficient than {@link CubemapProjection} as it doesn't copy cubemap image to canvas while rendering.\n * Accepts only single image.\n * @ko 큐브맵 스트립 기반의 프로젝션.\n * {@link CubemapProjection}와 달리 렌더링하는 과정에 캔버스에 이미지를 복사하는 과정이 없기 때문에 살짝 더 효율적입니다.\n * 단일 이미지만 사용 가능합니다.\n * @since 4.0.0\n * @category Projection\n */\nclass CubestripProjection extends Projection<{\n  uTexture: UniformTexture2D;\n}> {\n  private _cubemapOrder: NonNullable<CubestripProjectionOptions[\"cubemapOrder\"]>;\n  private _cubemapFlipX: NonNullable<CubestripProjectionOptions[\"cubemapFlipX\"]>;\n\n  /**\n   * Create new instance.\n   * @ko 새 인스턴스를 생성합니다.\n   * @param options Options {@ko Options}\n   */\n  public constructor(options: CubestripProjectionOptions) {\n    super(options);\n\n    const {\n      cubemapOrder = \"RLUDFB\",\n      cubemapFlipX = false\n    } = options;\n\n    this._cubemapOrder = cubemapOrder;\n    this._cubemapFlipX = cubemapFlipX;\n  }\n\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    const cubemapOrder = this._cubemapOrder;\n    const cubemapFlipX = this._cubemapFlipX;\n    const uniforms = {\n      uTexture: new UniformTexture2D(ctx, texture)\n    };\n    const geometry = new CubeGeometry({\n      order: cubemapOrder\n    });\n    const program = new ShaderProgram(ctx, vs, fs, uniforms);\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    if (cubemapFlipX) {\n      mesh.scale[0] = -1;\n    }\n    mesh.updateMatrix();\n\n    this._mesh = mesh;\n  }\n}\n\nexport default CubestripProjection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n*/\nimport { quat } from \"gl-matrix\";\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Texture2D from \"../texture/Texture2D\";\nimport CylinderGeometry from \"../geometry/CylinderGeometry\";\nimport Camera from \"../core/Camera\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport { DEG_TO_RAD, RAD_TO_DEG } from \"../const/internal\";\nimport vs from \"../shader/common.vert\";\nimport fs from \"../shader/common.frag\";\nimport TriangleMesh from \"../core/TriangleMesh\";\n\n/**\n * Options for {@link CylindricalProjection}\n * @ko {@link CylindricalProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface CylindricalProjectionOptions extends ProjectionOptions {\n  src: string | HTMLElement;\n  /**\n   * Whether the panorama image covers full 360 degrees.\n   * @ko 파노라마 이미지가 360도를 전부 커버하는지 여부\n   * @since 4.0.0\n   * @default false\n   */\n  partial?: boolean;\n}\n\n/**\n * Projection based on cylindrical projection.\n * This can show panorama images taken from smartphones.\n * @ko 원통 투영법 기반의 프로젝션.\n * 일반적인 스마트폰 파노라마 사진을 표시하는데 사용될 수 있습니다.\n * @since 4.0.0\n * @category Projection\n */\nclass CylindricalProjection extends Projection<{\n  uTexture: UniformTexture2D;\n}> {\n  private _partial: boolean;\n\n  /**\n   * Create new instance.\n   * @ko 새 인스턴스를 생성합니다.\n   * @param options Options {@ko Options}\n   */\n  public constructor(options: CylindricalProjectionOptions) {\n    super(options);\n\n    const {\n      partial = false\n    } = options;\n\n    this._partial = partial;\n  }\n\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    const partial = this._partial;\n    const { width, height } = texture;\n    const aspect = width / height;\n    const halfVFov = 180 / aspect;\n    const cylinderHeight = partial\n      ? 1\n      : 2 * Math.tan(halfVFov * DEG_TO_RAD);\n    const cylinderTheta = partial\n      ? aspect\n      : 2 * Math.PI;\n\n    const geometry = new CylinderGeometry(cylinderTheta);\n    const program = new ShaderProgram(ctx, vs, fs, {\n      uTexture: new UniformTexture2D(ctx, texture)\n    });\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    mesh.scale[1] = cylinderHeight;\n    quat.identity(mesh.rotation);\n    quat.rotateY(mesh.rotation, mesh.rotation, -Math.PI / 2);\n    mesh.updateMatrix();\n\n    this._mesh = mesh;\n  }\n\n  public updateCamera(camera: Camera) {\n    super.updateCamera(camera);\n\n    const mesh = this._mesh;\n    if (!mesh) return;\n\n    const uTexture = mesh.program.uniforms.uTexture;\n    const texture = uTexture.texture;\n    const { width, height } = texture;\n    const aspect = width / height;\n    const halfHeight = mesh.scale[1] * 0.5;\n\n    if (this._partial) {\n      const restrictedYaw = 0.5 * aspect * RAD_TO_DEG;\n      camera.restrictYawRange(-restrictedYaw, restrictedYaw);\n    }\n\n    const restrictedPitch = Math.atan2(halfHeight, 1) * RAD_TO_DEG;\n    const minZoom = Math.tan(camera.fov * DEG_TO_RAD * 0.5) / (halfHeight * camera.aspect);\n\n    camera.restrictPitchRange(-restrictedPitch, restrictedPitch);\n    camera.restrictZoomRange(minZoom, Infinity);\n    camera.restrictRenderHeight(halfHeight * 2);\n  }\n}\n\nexport default CylindricalProjection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport TriangleMesh from \"../core/TriangleMesh\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport Texture2D from \"../texture/Texture2D\";\nimport CubeGeometry from \"../geometry/CubeGeometry\";\nimport vs from \"../shader/common.vert\";\nimport fs from \"../shader/eac.frag\";\nimport { ROTATE } from \"../const/internal\";\n\n/**\n * Options for {@link EquiangularProjection}\n * @ko {@link EquiangularProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface EquiangularProjectionOptions extends ProjectionOptions {}\n\n/**\n * Equi-Angular Cubemap Projection.\n * This format is used by Youtube's 360 videos.\n * @ko Equi-Angular Cubemap 프로젝션.\n * 이 포맷은 주로 Youtube의 360 비디오에 사용됩니다.\n * @since 4.0.0\n * @category Projection\n */\nclass EquiangularProjection extends Projection<{\n  uTexture: UniformTexture2D;\n}> {\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    const uniforms = {\n      uTexture: new UniformTexture2D(ctx, texture)\n    };\n    const geometry = new CubeGeometry({\n      order: \"LFRDBU\",\n      rotateUV: [\n        ROTATE.ZERO, ROTATE.ZERO, ROTATE.ZERO,\n        ROTATE.CW_90, ROTATE.CCW_90, ROTATE.CW_90\n      ]\n    });\n    const program = new ShaderProgram(ctx, vs, fs, uniforms);\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    this._mesh = mesh;\n  }\n}\n\nexport default EquiangularProjection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport Texture2D from \"../texture/Texture2D\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport SphereGeometry from \"../geometry/SphereGeometry\";\nimport TriangleMesh from \"../core/TriangleMesh\";\nimport vs from \"../shader/common.vert\";\nimport fs from \"../shader/common.frag\";\n\n/**\n * Options for {@link EquirectProjection}\n * @ko {@link EquirectProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface EquirectProjectionOptions extends ProjectionOptions {\n  src: string | HTMLElement;\n}\n\n/**\n * Projection based on equirectangular projection.\n * @ko 등 장방형 도법(Equirectangular projection) 기반의 프로젝션\n * @since 4.0.0\n * @category Projection\n */\nclass EquirectProjection extends Projection<{\n  uTexture: UniformTexture2D\n}> {\n  /**\n   * Create new instance\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor(options: EquirectProjectionOptions) {\n    super(options);\n  }\n\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    const uniforms = {\n      uTexture: new UniformTexture2D(ctx, texture)\n    };\n\n    const geometry = new SphereGeometry();\n    const program = new ShaderProgram(ctx, vs, fs, uniforms);\n\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    this._mesh = mesh;\n  }\n}\n\nexport default EquirectProjection;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport Projection, { ProjectionOptions } from \"./Projection\";\nimport WebGLContext from \"../core/WebGLContext\";\nimport UniformTexture2D from \"../uniform/UniformTexture2D\";\nimport UniformFloat from \"../uniform/UniformFloat\";\nimport Camera from \"../core/Camera\";\nimport PanoControl from \"../control/PanoControl\";\nimport ShaderProgram from \"../core/ShaderProgram\";\nimport Texture2D from \"../texture/Texture2D\";\nimport PlaneGeometry from \"../geometry/PlaneGeometry\";\nimport vs from \"../shader/little-planet.vert\";\nimport fs from \"../shader/little-planet.frag\";\nimport TriangleMesh from \"../core/TriangleMesh\";\n\n/**\n * Options for {@link LittlePlanetProjection}\n * @ko {@link LittlePlanetProjection}의 옵션들\n * @since 4.0.0\n * @category Projection\n */\nexport interface LittlePlanetProjectionOptions extends ProjectionOptions {\n  src: string | HTMLElement;\n}\n\n/**\n * Projection based on so-called \"Little planet\" or \"Tiny planet\" effect.\n * @ko \"Little planet\" 혹은 \"Tiny planet\"로 불리는 이펙트 기반의 프로젝션\n * @since 4.0.0\n * @category Projection\n */\nclass LittlePlanetProjection extends Projection<{\n  uTexture: UniformTexture2D;\n  uYaw: UniformFloat;\n  uPitch: UniformFloat;\n  uZoom: UniformFloat;\n}> {\n  /**\n   * Create new instance\n   * @ko 새로운 인스턴스를 생성합니다.\n   * @param options - Options {@ko 옵션들}\n   */\n  public constructor(options: LittlePlanetProjectionOptions) {\n    super(options);\n  }\n\n  public applyTexture(ctx: WebGLContext, texture: Texture2D) {\n    texture.wrapS = WebGLRenderingContext.REPEAT;\n    texture.wrapT = WebGLRenderingContext.REPEAT;\n\n    const uniforms = {\n      uTexture: new UniformTexture2D(ctx, texture),\n      uYaw: new UniformFloat(0),\n      uPitch: new UniformFloat(0.5),\n      uZoom: new UniformFloat(1)\n    };\n\n    const geometry = new PlaneGeometry();\n    const program = new ShaderProgram(ctx, vs, fs, uniforms);\n\n    const vao = ctx.createVAO(geometry, program);\n    const mesh = new TriangleMesh(vao, program);\n\n    this._mesh = mesh;\n  }\n\n  public updateControl(control: PanoControl) {\n    control.ignoreZoomScale = true;\n  }\n\n  public update(camera: Camera) {\n    const mesh = this._mesh;\n    if (!mesh) return;\n\n    const uniforms = mesh.program.uniforms;\n\n    uniforms.uYaw.val = camera.yaw / 360;\n    // Range from 0 ~ 1\n    uniforms.uPitch.val = (camera.pitch / 180) + 0.5;\n    uniforms.uZoom.val = camera.zoom;\n\n    uniforms.uYaw.needsUpdate = true;\n    uniforms.uPitch.needsUpdate = true;\n    uniforms.uZoom.needsUpdate = true;\n  }\n}\n\nexport default LittlePlanetProjection;\n","/**\n * @hidden\n */\nexport const getValidProps = (propsObj: any) => {\n  return Object.keys(propsObj).reduce((props, propName) => {\n    if (propsObj[propName] != null) {\n      props[propName] = propsObj[propName];\n    }\n\n    return props;\n  }, {});\n};\n","export const VIEW360_METHODS = [\n  \"destroy\",\n  \"init\",\n  \"load\",\n  \"resize\",\n  \"addPlugins\",\n  \"removePlugins\",\n  \"renderFrame\",\n  // @egjs/component methods\n  \"on\",\n  \"hasOn\",\n  \"once\",\n  \"off\",\n  \"trigger\"\n] as const;\n","import Component from \"@egjs/component\";\nimport View360 from \"../View360\";\n\n/**\n * @hidden\n */\nconst withMethods = (prototype: any, attr: string) => {\n  [Component.prototype, View360.prototype].forEach(proto => {\n    Object.getOwnPropertyNames(proto)\n      .filter(name => name.charAt(0) !== \"_\" && name !== \"constructor\")\n      .forEach((name: string) => {\n        const descriptor = Object.getOwnPropertyDescriptor(proto, name)!;\n\n        if (descriptor.value) {\n          // Public Function\n          Object.defineProperty(prototype, name, {\n            value: function(...args) {\n              return descriptor.value.call(this[attr], ...args);\n            }\n          });\n        } else {\n          const getterDescriptor: { get?: () => any; set?: (val: any) => void } = {};\n          if (descriptor.get) {\n            getterDescriptor.get = function() {\n              return this[attr] && descriptor.get?.call(this[attr]);\n            };\n          }\n          if (descriptor.set) {\n            getterDescriptor.set = function(...args) {\n              return descriptor.set?.call(this[attr], ...args);\n            };\n          }\n\n          Object.defineProperty(prototype, name, getterDescriptor);\n        }\n      });\n  });\n};\n\nexport default withMethods;\n","/*\n * Copyright (c) 2023-present NAVER Corp.\n * egjs projects are licensed under the MIT license\n */\nimport View360, * as modules from \"./index\";\nimport { merge } from \"./utils\";\n\nmerge(View360, modules);\n\nexport default View360;\n"],"names":["View360Error","Error","constructor","message","code","super","Object","setPrototypeOf","this","prototype","name","ERROR_CODES","WRONG_TYPE","WRONG_OPTION","ELEMENT_NOT_FOUND","CANVAS_NOT_FOUND","WEBGL_NOT_SUPPORTED","FAILED_CREATE_CONTEXT_2D","PROVIDE_PROJECTION_FIRST","FAILED_LINKING_PROGRAM","INSUFFICIENT_ARGS","ERROR","val","types","map","type","join","optionName","query","msg","shaderLog","EVENTS","EL_DIV","EL_BUTTON","MOUSE_BUTTON","CURSOR","KEY_DIRECTION","DIRECTION_KEY_CODE","DIRECTION_KEY_NAME","LEFT","UP","RIGHT","DOWN","FULLSCREEN_REQUEST","FULLSCREEN_ELEMENT","FULLSCREEN_EXIT","FULLSCREEN_CHANGE","DEFAULT_CLASS","CONTAINER","CANVAS","CTX_LOST","IN_VR","HOTSPOT_CONTAINER","HOTSPOT","HOTSPOT_VISIBLE","HOTSPOT_FLIP_X","HOTSPOT_FLIP_Y","READY","LOAD_START","LOAD","PROJECTION_CHANGE","RESIZE","BEFORE_RENDER","RENDER","INPUT_START","INPUT_END","VIEW_CHANGE","STATIC_CLICK","VR_START","VR_END","EASING","LINEAR","x","SINE_WAVE","Math","sin","PI","EASE_OUT_CUBIC","pow","EASE_OUT_BOUNCE","n1","d1","CAMERA_EVENTS","CONTROL_EVENTS","DEG_TO_RAD","RAD_TO_DEG","DEFAULT_EASING","DEFAULT_ANIMATION_DURATION","INFINITE_RANGE","min","Infinity","max","DEFAULT_PITCH_RANGE","DEFAULT_ZOOM_RANGE","ROTATE","VIDEO_TIME_CHANGE_EVENT","SVG_NAMESPACE","SESSION_VR","XR_REFERENCE_SPACE","EPSILON","_a","Number","isString","createElement","className","tag","BROWSER","el","document","classList","add","getNullableElement","parent","targetEl","queryResult","querySelector","nodeType","Node","ELEMENT_NODE","clamp","lerp","a","b","t","circulate","size","abs","findIndex","array","checker","idx","length","getObjectOption","toVerticalFov","fovRadian","aspect","atan","tan","reorderCube","arr","order","defaultOrder","split","face","indexOf","index","isFullscreen","key","sensorCanBeEnabledIOS","DeviceMotionEvent","window","isSecureContext","eulerToQuat","out","yaw","pitch","roll","quat","identity","pitchClamped","rotateY","rotateX","rotateZ","quatToEuler","quaternion","y","z","w","unit","test","atan2","view","vec3","fromValues","up","transformQuat","viewXZ","sqrt","Motion","_val","start","_start","end","_end","progress","_progress","activated","_activated","duration","_duration","loop","_loop","range","_range","easing","_easing","reset","update","deltaTime","prev","nextProgress","easedProgress","defaultVal","delta","setNewEndByDelta","setRange","CameraAnimation","_motion","camera","from","to","_camera","_from","_to","_finishPromise","Promise","resolve","_finish","getFinishPromise","motion","rotation","create","zoom","slerp","rotate","Camera","Component","_aspect","changed","_changed","yawRange","_initialYawRange","pitchRange","_initialPitchRange","zoomRange","_initialZoomRange","initialYaw","initialPitch","initialZoom","fov","rollOffset","position","animation","_up","_yawRange","_pitchRange","_zoomRange","_updateQuaternion","viewMatrix","mat4","projectionMatrix","_maxRenderHeight","destroy","off","resize","width","height","prevAspect","updateMatrix","lookAt","prevQuaternion","clone","prevZoom","zoomDiff","equals","normalized","normalize","isSameRotation","copy","animateTo","finishPromise","then","trigger","restrictYawRange","restrictPitchRange","restrictZoomRange","restrictRenderHeight","resetRange","getYawRange","yawLimit","maxRenderHeight","halfHFov","getHorizontalFov","minYaw","maxYaw","halfVFovRad","h","d","theta","getPitchRange","pitchLimit","minPitch","maxPitch","halfVFov","getVerticalFov","getZoomRange","limit","minFov","maxFov","currentFov","current","_getZoomedHorizontalFov","hFov","fovToZoom","baseFov","projMatrix","upDir","viewDir","vFov","perspective","onFrameRender","MouseInput","_onMouseDown","evt","_el","button","preventDefault","focus","_prevPos","clientX","clientY","addEventListener","_onMouseMove","_onMouseUp","srcEvent","isTouch","isKeyboard","prevPos","deltaX","deltaY","removeEventListener","scrolling","enable","element","disable","TouchInput","scrollable","_scrollable","_onTouchStart","touches","_scrolling","touch","_isFirstTouch","_onTouchMove","cancelable","_onTouchEnd","passive","KeyboardInput","active","pressed","_pressed","_onKeyDown","location","KeyboardEvent","DOM_KEY_LOCATION_STANDARD","_updateKeyPress","pressedCount","_getPressedKeyCount","repeat","_onKeyUp","_clearPressedKeys","_getDeltaByPressedKeys","reduce","obj","keyName","assign","event","isEnable","keyToUpdate","keyCode","filter","RotateControl","enabled","_enabled","enableBlocked","_enableBlocked","animating","_keyboardInput","_xMotion","_yMotion","_touchInput","pointerScale","_pointerScale","keyboardScale","_keyboardScale","disablePitch","_disablePitch","disableYaw","_disableYaw","disableKeyboard","_disableKeyboard","controlEl","_onInputStart","_changedWhileDragging","inputType","_onChange","invZoomScale","_zoomScale","screenScale","_screenScale","scale","scaledX","scaledY","_onInputEnd","_controlEl","_mouseInput","_bindInputs","xMotion","yMotion","keyboardInput","updateRange","setZoomScale","hfov","vfov","control","updateCursor","sync","mouseInput","touchInput","on","WheelInput","_onWheel","stopPropagation","_inputTimer","_clearTimer","_baseScale","setTimeout","capture","clearTimeout","PinchInput","prevDistance","_prevDistance","diff","pageX","pageY","distance","ZoomControl","_wheelInput","_scale","scaledDelta","_pinchInput","wheelInput","pinchInput","ROTATE_CONSTANT","PITCH_DELTA","YAW_DELTA_BY_ROLL","YAW_DELTA_BY_YAW","targetAxis","meshPoint","GyroInput","orientationUpdated","_orientationUpdated","ignoreRoll","_ignoreRoll","_onDeviceOrientation","prevOrientation","_orientation","alpha","beta","gamma","_needsCalibrate","_calibrateSensor","_updateScreenOrientation","screen","orientation","undefined","angle","_screenOrientation","_yawOrigin","_yawOffset","_updateRotation","collectDelta","prevRotation","_toEulerDelta","setInitialRotation","yawOrigin","sensorYaw","screenAngle","world","set","cos","multiply","prevQuat","currentQuat","_getDeltaYaw","_getDeltaPitch","prvQ","curQ","yawDeltaByYaw","_getRotationDelta","_extractPitchFromQuat","prevQ","rotateKind","curQuaternion","prevPoint","curPoint","rotateDirection","dot","cross","meshPoint2","meshPoint3","vecU","vecV","vecN","coefficientA","coefficientB","coefficientC","projectedPrevPoint","subtract","trigonometricRatio","acos","crossVec","thetaDirection","baseV","GyroControl","_input","static","onDeviceMotionChange","race","res","rotationRate","available","requestPermission","permissionState","catch","_updateYawPitch","input","yawDelta","pitchDelta","PanoControl","useGrabCursor","_useGrabCursor","_setCursor","disableContextMenu","_disableContextMenu","_blockContextMenu","_restoreContextMenu","_rotateControl","wheelScrollable","_zoomControl","ignoreZoomScale","_ignoreZoomScale","gyro","_gyroControl","_preventContextMenu","_onEnable","_onDisable","_onCameraAnimationEnd","_bindEvents","isAvailable","rotateControl","zoomControl","gyroControl","zoomScale","newCursor","style","cursor","Texture","flipY","wrapS","WebGLRenderingContext","CLAMP_TO_EDGE","wrapT","isVideo","isCube","Texture2D","source","TextureVideo","video","pause","removeAttribute","load","isPaused","paused","ended","readyState","hasAudio","audioTracks","webkitAudioDecodedByteCount","mozHasAudio","TextureCube","sources","TextureLoader","_loadChecker","ImReady","src","loadVideo","Array","isArray","loadCubeImage","imgSrc","loadImage","images","_toImageArray","_load","image","naturalWidth","naturalHeight","videoConfig","config","autoplay","muted","volume","_toVideoElement","currentTime","play","videoWidth","videoHeight","content","onLoad","loader","reject","once","errorCount","check","imgEl","Image","crossOrigin","HTMLVideoElement","playsInline","setAttribute","forEach","_appendSourceElement","querySelectorAll","HTMLSourceElement","sourceEl","appendChild","FrameAnimator","maxDeltaTime","context","_context","_rafId","_rafTimer","_lastUpdateTime","callback","_time","frame","time","Date","now","requestAnimationFrame","stop","cancelAnimationFrame","changeContext","AutoResizer","useResizeObserver","_useResizeObserver","onResize","_skipFirstResize","isFirstResize","_onResize","_resizeObserver","ResizeObserver","bbox","getBoundingClientRect","resizeImmediate","resizeObserver","observe","disconnect","Autoplay","playing","_interrupted","delay","_delay","delayOnMouseLeave","_delayOnMouseLeave","speed","_speed","pauseOnHover","_pauseOnHover","canInterrupt","_canInterrupt","disableOnInterrupt","_disableOnInterrupt","viewer","options","_clearTimeout","_setUninterruptedAfterDelay","_onGyroEnable","_onMouseEnter","_hovering","_onMouseLeave","_control","_element","_interruptionTimer","enableAfterDelay","XRManager","ctx","exit","_onSessionEnd","_xrSession","_xrRefSpace","_ctx","_options","xr","navigator","isSessionSupported","enter","requestSensorPermission","requiredFeatures","makeXRCompatible","session","requestSession","bindXRLayer","refSpace","requestReferenceSpace","_setSession","xrSession","canRender","getViewerPose","getEyeParams","pose","glLayer","renderState","baseLayer","views","viewport","getViewport","vMatrix","transform","inverse","matrix","pMatrix","Hotspot","HotspotRenderer","rootEl","renderer","_containerEl","_renderer","_hotspots","_zoom","refresh","container","hotspotEls","slice","apply","_parseHotspot","render","hotspots","halfWidth","halfHeight","centerTransform","zoomTransform","hotspot","relPos","transformMat4","remove","screenPos","vec2","yawStr","dataset","pitchStr","positionStr","parseFloat","_yawPitchToVec3","pos","defaultPos","yawRad","pitchRad","VertexArrayObject","count","geometry","indicies","buffers","WebGLContext","canvas","_canvas","maxTextureSize","_maxTextureSize","isWebGL2","_isWebGL2","supportVAO","_extensions","vao","lost","_contextLost","debug","_debug","_onContextLost","_onContextRestore","loseContext","init","gl","_getContext","_gl","getParameter","MAX_TEXTURE_SIZE","getExtension","bindBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","forceLoseContext","extension","forceRestoreContext","restoreContext","clear","COLOR_BUFFER_BIT","drawingBufferWidth","drawingBufferHeight","createVAO","shaderProgram","nativeVAO","_createNativeVAO","_createBuffer","uv","_bindNativeVAO","_supplyGeometryData","_unbindBuffers","draw","drawElements","TRIANGLES","UNSIGNED_SHORT","releaseVAO","_deleteNativeVAO","_deleteBuffer","getUniformLocations","program","uniforms","uniformLocations","keys","locations","getUniformLocation","_getCommonUniformLocations","updateCommonUniforms","entity","mvMatrix","uniformMatrix4fv","uMVMatrix","uPMatrix","updateVRUniforms","eyeIndex","uEye","uniform1f","updateUniforms","uniform","needsUpdate","releaseShaderResources","deleteProgram","useProgram","createProgram","vertexShader","fragmentShader","vs","_compileShader","VERTEX_SHADER","fs","FRAGMENT_SHADER","attachShader","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","getProgramInfoLog","deleteShader","createWebGLTexture","texData","texture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","gl2","texStorage2D","RGBA8","createWebGLCubeTexture","TEXTURE_CUBE_MAP","attributes","getContextAttributes","xrCompatible","xrLayer","XRWebGLLayer","updateRenderState","bindXRFrame","bindFramebuffer","FRAMEBUFFER","framebuffer","useDefaultFrameBuffer","createBuffer","buffer","deleteBuffer","createVertexArray","ext","createVertexArrayOES","bindVertexArray","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","_supplyIndiciesData","_supplyAttributeData","vertices","uvs","bufferData","data","STATIC_DRAW","attribute","attribLocation","getAttribLocation","vertexAttribPointer","itemSize","FLOAT","enableVertexAttribArray","shader","createShader","shaderSource","compileShader","webglIdentifiers","contextAttributes","preserveDrawingBuffer","antialias","onWebglContextCreationError","e","statusMessage","identifier","getContext","WebGLRenderer","_elementSize","pixelRatio","_pixelRatio","canvasSize","devicePixelRatio","clientWidth","clientHeight","projection","mesh","getMesh","renderVR","vr","eyeParams","eye","View360","_rootEl","_vr","_hotspot","plugins","_plugins","_projection","_initialized","initialized","_autoplay","autoInit","_autoInit","autoResize","_autoResize","canvasSelector","_canvasSelector","tabIndex","_tabIndex","_animator","updateCamera","root","renderFrame","autoPlayer","_emit","_renderFrameOnDemand","getTexture","_renderVRFrame","_delta","getElement","selector","findCanvas","_autoResizer","_addEventHandlers","releaseAllResources","plugin","animator","_bindComponentEvents","_resizeComponents","_loadTexture","_applyProjection","hasAttribute","addPlugins","push","removePlugins","pluginIdx","splice","eventName","params","evtParams","target","prevProjection","applyTexture","updateControl","contentLoader","events","evtName","VERSION","Object3D","fromRotationTranslationScale","LoadingSpinner","_startLoading","_container","_detachElements","parentElement","removeChild","_createElements","ring","RING","ControlBarItem","CONTROL_BAR_DEFAULT_CLASS","CONTROLS_ROOT","CONTROLS_BG","CONTROLS_MAIN","CONTROLS_TOP","CONTROLS_BOTTOM","CONTROLS_MID","CONTROLS_LEFT","CONTROLS_RIGHT","CONTROLS_FLOAT_LEFT","CONTROLS_FLOAT_RIGHT","CONTROLS_BUTTON","PROGRESS_ROOT","VOLUME_ROOT","RANGE_ROOT","RANGE_TRACK","RANGE_THUMB","RANGE_FILLER","PLAY_BUTTON","PAUSE_BUTTON","UNMUTED_BUTTON","MUTED_BUTTON","FULLSCREEN_BUTTON","FULLSCREEN_EXIT_BUTTON","VR_BUTTON","GYRO_ENABLED","GYRO_DISABLED","VIDEO_TIME_DISPLAY","PIEVIEW_ROOT","FIXED","UNAVAILABLE","HIDDEN","CONTROL_BAR_ITEM_POSITION","TOP_LEFT","TOP_RIGHT","MAIN_TOP","MAIN_BOTTOM","MAIN_LEFT","MAIN_RIGHT","RangeControl","_onHold","_bbox","elX","scrollX","pageXOffset","clamepdX","thumbEl","_fixedClass","_onRelease","track","thumb","filler","draggable","trackEl","fillerEl","left","right","bottom","top","updateStyle","clampedProgress","ProgressBar","_rangeControl","_onTimeUpdate","_video","_currentTime","_onDurationChange","controlBar","_controlBar","dispatchEvent","CustomEvent","detail","_wasPaused","_playPromise","_onControl","rangeControl","unavailableClass","PlayButton","_onClick","_paused","_onPlay","title","_onPause","VolumeControl","_updateDisplay","disabled","_onVolumeChange","_buttonEl","containerEl","buttonEl","FullscreenButton","_targetEl","_exitFullscreen","_requestFullscreen","_onFullscreenChange","_fullscreenAvailable","_addFullscreenHandlers","_removeFullscreenHandlers","some","request","call","VideoTime","_onCustomTimeChange","timeMinute","floor","timeSeconds","timeSecondsFormatted","durationMinute","durationSeconds","durationSecondsFormatted","innerText","PieView","resetCamera","_viewer","_updatePie","piePath","_piePathEl","rangeCircle","_rangeCircleEl","halfFov","pieRadius","pieDeg","pieOffset","isFinite","radius","rangeDiff","offset","_createPieElements","rootClass","pieSVG","createElementNS","VRButton","GyroButton","_updateStyle","enableButton","AutoHide","hidden","contains","_hiddenClass","initialDelay","idleDelay","activationDelay","_isCursorInside","show","_hideAfterDelay","_isFullscreen","showTemporaliy","_isGrabbing","pointerType","_onVideoPlay","_onVideoPause","_initialDelay","_idleDelay","_timer","hide","_clearHideTimer","VideoControl","videoEl","keyPressed","_changeVideoTime","_changeVideoVolume","_toggleVideo","forward","increase","ControlBar","backgroundEl","_bgEl","items","_items","customItems","_customItems","autoHide","showBackground","clickToPlay","keyboardControls","progressBar","playButton","volumeButton","fullscreenButton","videoTime","pieView","vrButton","gyroButton","_onStaticClick","autoHider","_autoHider","_onNewSrcLoad","_updateBackground","_updateAutoHide","_updateKeyboardHandler","item","_createPositionWrappers","POSITION","_videoControl","panoRoot","controlsRoot","defaultItems","_createDefaultItems","_addItem","_clearItemElements","category","wrapper","_wrapperEl","nextSiblingIndex","sibling","nextSibling","insertBefore","floatLeftEl","floatRightEl","topWrapper","bottomWrapper","midWrapper","leftControlsWrapper","rightControlsWrapper","firstChild","background","hiddenClass","_b","videoControl","Projection","_mesh","uTexture","Uniform","UniformTextureCube","cubemapOrder","_webglTexture","_cubemapOrder","deleteTexture","pixelStorei","UNPACK_FLIP_Y_WEBGL","uniform1i","activeTexture","TEXTURE0","texSubImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","RGBA","UNSIGNED_BYTE","texImage2D","CubeTexturePainter","_size","_renderingOrder","undef","_calcRenderingSize","surfaceIdx","row","_row","column","_column","renderingFace","drawImage","UniformCanvasCube","_painter","TriangleMesh","ShaderProgram","VertexData","Geometry","Float32Array","Uint16Array","CubeGeometry","rotateUV","oneThird","coords","r","c","coord","degree","ZERO","newOrder","CW_90","CCW_90","newCoords","uvIdx","acc","concat","UniformTexture2D","CylinderGeometry","maxTheta","heightSegments","invRadialSegments","angleConst","yIdx","lngIdx","u","v","SphereGeometry","ANGLE_CORRECTION_FOR_CENTER_ALIGN","latIdx","sinTheta","cosTheta","phi","sinPhi","UniformFloat","PlaneGeometry","UniformVector4Array","uniform4fv","vector","StereoEquiProjection","_mode","mode","leftEye","rightEye","MODE","LEFT_RIGHT","uTexScaleOffset","TOP_BOTTOM","cubemapFlipX","_cubemapFlipX","partial","_partial","cylinderHeight","cylinderTheta","restrictedYaw","restrictedPitch","minZoom","REPEAT","uYaw","uPitch","uZoom","propsObj","props","propName","attr","proto","getOwnPropertyNames","charAt","descriptor","getOwnPropertyDescriptor","value","defineProperty","args","getterDescriptor","get","srcs","merge","modules"],"mappings":"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"}